/*
 Leaflet 1.0.3+ed36a04, a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2016 Vladimir Agafonkin, (c) 2010-2011 CloudMade
*//* esri-leaflet - v2.0.8 - Tue Mar 21 2017 16:10:14 GMT-0700 (PDT)
 * Copyright (c) 2017 Environmental Systems Research Institute, Inc.
 * Apache-2.0 *//* globals L.Terraformer *//*
	Leaflet.contextmenu, a context menu for Leaflet.
	(c) 2015, Adam Ratcliffe, GeoSmart Maps Limited

	@preserve
*//*
 Leaflet.markercluster, Provides Beautiful Animated Marker Clustering functionality for Leaflet, a JS library for interactive maps.
 https://github.com/Leaflet/Leaflet.markercluster
 (c) 2012-2013, Dave Leaver, smartrak
*//*
 Leaflet.draw 0.4.9, a plugin that adds drawing and editing tools to Leaflet powered maps.
 (c) 2012-2017, Jacob Toye, Jon West, Smartrak, Leaflet

 https://github.com/Leaflet/Leaflet.draw
 http://leafletjs.com
 *//* global L *//**
 * [initialize description]
 * @param  {[type]} url                     [description]
 * @param  {[type]} options)                {                    this._url [description]
 * @param  {[type]} this.defaultWmtsParams) [description]
 * @return {[type]}                         [description]
 *//*
 (c) 2014, Vladimir Agafonkin
 simpleheat, a tiny JavaScript library for drawing heatmaps with Canvas
 https://github.com/mourner/simpleheat
*/(function(e,k){"object"===typeof exports&&"undefined"!==typeof module?module.exports=k():"function"===typeof define&&define.amd?define(k):e.proj4=k()})(this,function(){function e(a,b){if(a[b])return a[b];for(var d=Object.keys(a),c=b.toLowerCase().replace(Q,""),g=-1,p,f;++g<d.length;)if(p=d[g],f=p.toLowerCase().replace(Q,""),f===c)return a[p]}function k(a){if("string"!==typeof a)throw Error("not a string");this.text=a.trim();this.place=this.level=0;this.root=null;this.stack=[];this.currentObject=null;this.state=1}function l(a,b,d){Array.isArray(b)&&(d.unshift(b),b=null);d=d.reduce(function(a,b){c(b,a);return a},b?{}:a);b&&(a[b]=d)}function c(a,b){if(Array.isArray(a)){var d=a.shift();"PARAMETER"===d&&(d=a.shift());if(1===a.length)Array.isArray(a[0])?(b[d]={},c(a[0],b[d])):b[d]=a[0];else if(a.length)if("TOWGS84"===d)b[d]=a;else{Array.isArray(d)||(b[d]={});var g;switch(d){case "UNIT":case "PRIMEM":case "VERT_DATUM":b[d]={name:a[0].toLowerCase(),convert:a[1]};3===a.length&&c(a[2],b[d]);break;case "SPHEROID":case "ELLIPSOID":b[d]={name:a[0],a:a[1],rf:a[2]};4===a.length&&c(a[3],b[d]);break;case "PROJECTEDCRS":case "PROJCRS":case "GEOGCS":case "GEOCCS":case "PROJCS":case "LOCAL_CS":case "GEODCRS":case "GEODETICCRS":case "GEODETICDATUM":case "EDATUM":case "ENGINEERINGDATUM":case "VERT_CS":case "VERTCRS":case "VERTICALCRS":case "COMPD_CS":case "COMPOUNDCRS":case "ENGINEERINGCRS":case "ENGCRS":case "FITTED_CS":case "LOCAL_DATUM":case "DATUM":a[0]=["name",a[0]];l(b,d,a);break;default:for(g=-1;++g<a.length;)if(!Array.isArray(a[g]))return c(a,b[d]);return l(b,d,a)}}else b[d]=!0}else b[a]=!0}function b(a){return.017453292519943295*a}function h(a){function d(b){return b*(a.to_meter||1)}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):a.projName="object"===typeof a.PROJECTION?Object.keys(a.PROJECTION)[0]:a.PROJECTION;a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&("GEOGCS"===a.type?a.DATUM&&a.DATUM.SPHEROID&&(a.to_meter=a.UNIT.convert*a.DATUM.SPHEROID.a):(a.to_meter=a.UNIT.convert,10)));var c=a.GEOGCS;"GEOGCS"===a.type&&(c=a);if(c){a.datumCode=c.DATUM?c.DATUM.name.toLowerCase():c.name.toLowerCase();"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2));if("new_zealand_geodetic_datum_1949"===a.datumCode||"new_zealand_1949"===a.datumCode)a.datumCode="nzgd49";"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84");"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6));"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8));~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72");c.DATUM&&c.DATUM.SPHEROID&&(a.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=c.DATUM.SPHEROID.a,a.rf=parseFloat(c.DATUM.SPHEROID.rf,10));~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36")}a.b&&!isFinite(a.b)&&(a.b=a.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",b],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",b],["x0","false_easting",d],["y0","false_northing",d],["long0","central_meridian",b],["lat0","latitude_of_origin",b],["lat0","standard_parallel_1",b],["lat1","standard_parallel_1",b],["lat2","standard_parallel_2",b],["alpha","azimuth",b],["srsCode","name"]].forEach(function(b){var d=b[0],c=b[1];!(d in a)&&c in a&&(a[d]=a[c],3===b.length&&(a[d]=b[2](a[d])))});a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.projName&&"Lambert_Azimuthal_Equal_Area"!==a.projName||(a.long0=a.longc);a.lat_ts||!a.lat1||"Stereographic_South_Pole"!==a.projName&&"Polar Stereographic (variant B)"!==a.projName||(a.lat0=.017453292519943295*(0<a.lat1?90:-90),a.lat_ts=a.lat1)}function a(b){var d=this;if(2===arguments.length){var c=arguments[1];"string"===typeof c?"+"===c.charAt(0)?a[b]=I(arguments[1]):a[b]=W(arguments[1]):a[b]=c}else if(1===arguments.length){if(Array.isArray(b))return b.map(function(b){Array.isArray(b)?a.apply(d,b):a(b)});if("string"===typeof b){if(b in a)return a[b]}else"EPSG"in b?a["EPSG:"+b.EPSG]=b:"ESRI"in b?a["ESRI:"+b.ESRI]=b:"IAU2000"in b?a["IAU2000:"+b.IAU2000]=b:console.log(b)}}function d(a){return la.some(function(b){return-1<a.indexOf(b)})}function g(b){if("string"===typeof b){if(b in a)return a[b];if(d(b))return W(b);if("+"===b[0])return I(b)}else return b}function f(a){return a}function m(a,b){var d=ca.length;if(!a.names)return console.log(b),!0;ca[d]=a;a.names.forEach(function(a){ia[a.toLowerCase()]=d});return this}function x(a,b,d,c){d=a*a;b*=b;var g=(d-b)/d,f=0;c?(a*=1-g*(.16666666666666666+g*(.04722222222222222+.022156084656084655*g)),d=a*a,g=0):f=Math.sqrt(g);return{es:g,e:f,ep2:(d-b)/b}}function C(a,b,d,c,g){a||((d=e(ma,c))||(d=va),a=d.a,b=d.b,d=d.rf);d&&!b&&(b=(1-1/d)*a);if(0===d||Math.abs(a-b)<r)g=!0,b=a;return{a:a,b:b,rf:d,sphere:g}}function v(a,b,d,c,g,f){var p={};p.datum_type=void 0===a||"none"===a?5:4;if(b){p.datum_params=b.map(parseFloat);if(0!==p.datum_params[0]||0!==p.datum_params[1]||0!==p.datum_params[2])p.datum_type=1;3<p.datum_params.length&&(0!==p.datum_params[3]||0!==p.datum_params[4]||0!==p.datum_params[5]||0!==p.datum_params[6])&&(p.datum_type=2,p.datum_params[3]*=4.84813681109536E-6,p.datum_params[4]*=4.84813681109536E-6,p.datum_params[5]*=4.84813681109536E-6,p.datum_params[6]=p.datum_params[6]/1E6+1)}p.a=d;p.b=c;p.es=g;p.ep2=f;return p}function q(a,b){if(!(this instanceof q))return new q(a);b=b||function(a){if(a)throw a;};var d=g(a);if("object"!==typeof d)b(a);else{var c=q.projections.get(d.projName);if(c){if(d.datumCode&&"none"!==d.datumCode){var f=e(O,d.datumCode);f&&(d.datum_params=f.towgs84?f.towgs84.split(","):null,d.ellps=f.ellipse,d.datumName=f.datumName?f.datumName:d.datumCode)}d.k0=d.k0||1;d.axis=d.axis||"enu";d.ellps=d.ellps||"wgs84";var f=C(d.a,d.b,d.rf,d.ellps,d.sphere),p=x(f.a,f.b,f.rf,d.R_A),n=d.datum||v(d.datumCode,d.datum_params,f.a,f.b,p.es,p.ep2);wa(this,d);wa(this,c);this.a=f.a;this.b=f.b;this.rf=f.rf;this.sphere=f.sphere;this.es=p.es;this.e=p.e;this.ep2=p.ep2;this.datum=n;this.init();b(null,this)}else b(a)}}function u(a){return 1===a||2===a}function y(a,b,d){var c;Array.isArray(d)&&(d=na(d));a.datum&&b.datum&&((1===a.datum.datum_type||2===a.datum.datum_type)&&"WGS84"!==b.datumCode||(1===b.datum.datum_type||2===b.datum.datum_type)&&"WGS84"!==a.datumCode)&&(c=new q("WGS84"),d=y(a,c,d),a=c);"enu"!==a.axis&&(d=ja(a,!1,d));"longlat"===a.projName?d={x:.017453292519943295*d.x,y:.017453292519943295*d.y}:(a.to_meter&&(d={x:d.x*a.to_meter,y:d.y*a.to_meter}),d=a.inverse(d));a.from_greenwich&&(d.x+=a.from_greenwich);c=a.datum;a=b.datum;if(!((c.datum_type!==a.datum_type?0:c.a!==a.a||5E-11<Math.abs(c.es-a.es)?0:1===c.datum_type?c.datum_params[0]===a.datum_params[0]&&c.datum_params[1]===a.datum_params[1]&&c.datum_params[2]===a.datum_params[2]:2===c.datum_type?c.datum_params[0]===a.datum_params[0]&&c.datum_params[1]===a.datum_params[1]&&c.datum_params[2]===a.datum_params[2]&&c.datum_params[3]===a.datum_params[3]&&c.datum_params[4]===a.datum_params[4]&&c.datum_params[5]===a.datum_params[5]&&c.datum_params[6]===a.datum_params[6]:1)||5===c.datum_type||5===a.datum_type||c.es===a.es&&c.a===a.a&&!u(c.datum_type)&&!u(a.datum_type))){b:{var g=c.es,f=d.x,p=d.y;d=d.z?d.z:0;var n,E;if(p<-t&&p>-1.001*t)p=-t;else if(p>t&&p<1.001*t)p=t;else if(p<-t||p>t){d=null;break b}f>Math.PI&&(f-=2*Math.PI);n=Math.sin(p);E=Math.cos(p);p=c.a/Math.sqrt(1-g*n*n);d={x:(p+d)*E*Math.cos(f),y:(p+d)*E*Math.sin(f),z:(p*(1-g)+d)*n}}u(c.datum_type)&&(g=c.datum_type,c=c.datum_params,1===g?d={x:d.x+c[0],y:d.y+c[1],z:d.z+c[2]}:2===g?(g=c[3],f=c[4],n=c[5],p=c[6],d={x:p*(d.x-n*d.y+f*d.z)+c[0],y:p*(n*d.x+d.y-g*d.z)+c[1],z:p*(-f*d.x+g*d.y+d.z)+c[2]}):d=void 0);if(u(a.datum_type))if(g=a.datum_type,c=a.datum_params,1===g)d={x:d.x-c[0],y:d.y-c[1],z:d.z-c[2]};else if(2===g){g=c[3];f=c[4];n=c[5];var m=c[6],p=(d.x-c[0])/m;E=(d.y-c[1])/m;d=(d.z-c[2])/m;d={x:p+n*E-f*d,y:-n*p+E+g*d,z:f*p-g*E+d}}else d=void 0;b:{c=a.es;a=a.a;var h,e,Ea,x;n=d.x;E=d.y;var f=d.z?d.z:0,k,g=Math.sqrt(n*n+E*E),p=Math.sqrt(n*n+E*E+f*f);if(1E-12>g/a){if(n=0,1E-12>p/a){d={x:d.x,y:d.y,z:d.z};break b}}else n=Math.atan2(E,n);d=f/p;p=g/p;h=1/Math.sqrt(1-c*(2-c)*p*p);E=p*(1-c)*h;m=d*h;x=0;do x++,e=a/Math.sqrt(1-c*m*m),k=g*E+f*m-e*(1-c*m*m),e=c*e/(e+k),h=1/Math.sqrt(1-e*(2-e)*p*p),e=p*(1-e)*h,h*=d,Ea=h*E-e*m,E=e,m=h;while(1E-24<Ea*Ea&&30>x);d={x:n,y:Math.atan(h/Math.abs(e)),z:k}}}b.from_greenwich&&(d={x:d.x-b.from_greenwich,y:d.y});"longlat"===b.projName?d={x:57.29577951308232*d.x,y:57.29577951308232*d.y}:(d=b.forward(d),b.to_meter&&(d={x:d.x/b.to_meter,y:d.y/b.to_meter}));return"enu"!==b.axis?ja(b,!0,d):d}function z(a,b,d){return Array.isArray(d)?(a=y(a,b,d),3===d.length?[a.x,a.y,a.z]:[a.x,a.y]):y(a,b,d)}function F(a){return a instanceof q?a:a.oProj?a.oProj:q(a)}function D(a,b,d){a=F(a);var c=!1;if("undefined"===typeof b)b=a,a=xa,c=!0;else if("undefined"!==typeof b.x||Array.isArray(b))d=b,b=a,a=xa,c=!0;b=F(b);if(d)return z(a,b,d);d={forward:function(d){return z(a,b,d)},inverse:function(d){return z(b,a,d)}};c&&(d.oProj=b);return d}function N(a,b){var d,c,g,f=a[1],p=a[0],n;d=Math.PI/180*f;g=Math.PI/180*p;var E,m;m=Math.floor((p+180)/6)+1;180===p&&(m=60);56<=f&&64>f&&3<=p&&12>p&&(m=32);72<=f&&84>f&&(0<=p&&9>p?m=31:9<=p&&21>p?m=33:21<=p&&33>p?m=35:33<=p&&42>p&&(m=37));E=Math.PI/180*(6*(m-1)-180+3);p=6378137/Math.sqrt(1-.00669438*Math.sin(d)*Math.sin(d));n=Math.tan(d)*Math.tan(d);c=.006739496752268451*Math.cos(d)*Math.cos(d);g=Math.cos(d)*(g-E);d=.9996*(6378137*(.9983242984503243*d-.002514607064228144*Math.sin(2*d)+2.639046602129982E-6*Math.sin(4*d)-3.4180461016968582E-9*Math.sin(6*d))+p*Math.tan(d)*(g*g/2+(5-n+9*c+4*c*c)*g*g*g*g/24+(61-58*n+n*n+600*c-2.2240339282485886)*g*g*g*g*g*g/720));0>f&&(d+=1E7);d=Math.round(d);c=Math.round(.9996*p*(g+(1-n+c)*g*g*g/6+(5-18*n+n*n+72*c-.39089081163157013)*g*g*g*g*g/120)+5E5);g=m;n="Z";84>=f&&72<=f?n="X":72>f&&64<=f?n="W":64>f&&56<=f?n="V":56>f&&48<=f?n="U":48>f&&40<=f?n="T":40>f&&32<=f?n="S":32>f&&24<=f?n="R":24>f&&16<=f?n="Q":16>f&&8<=f?n="P":8>f&&0<=f?n="N":0>f&&-8<=f?n="M":-8>f&&-16<=f?n="L":-16>f&&-24<=f?n="K":-24>f&&-32<=f?n="J":-32>f&&-40<=f?n="H":-40>f&&-48<=f?n="G":-48>f&&-56<=f?n="F":-56>f&&-64<=f?n="E":-64>f&&-72<=f?n="D":-72>f&&-80<=f&&(n="C");f=b||5;m="00000"+c;p="00000"+d;n=g+n;E=A(g);c=Math.floor(c/1E5);g=Math.floor(d/1E5)%20;--E;d="AJSAJS".charCodeAt(E);E="AFAFAF".charCodeAt(E);c=d+c-1;g=E+g;var h=!1;90<c&&(c=c-90+65-1,h=!0);(73===c||73>d&&73<c||(73<c||73>d)&&h)&&c++;if(79===c||79>d&&79<c||(79<c||79>d)&&h)c++,73===c&&c++;90<c&&(c=c-90+65-1);86<g?(g=g-86+65-1,h=!0):h=!1;(73===g||73>E&&73<g||(73<g||73>E)&&h)&&g++;if(79===g||79>E&&79<g||(79<g||79>E)&&h)g++,73===g&&g++;86<g&&(g=g-86+65-1);d=String.fromCharCode(c)+String.fromCharCode(g);return n+d+m.substr(m.length-5,f)+p.substr(p.length-5,f)}function M(a){a=U(G(a.toUpperCase()));return a.lat&&a.lon?[a.lon,a.lat]:[(a.left+a.right)/2,(a.top+a.bottom)/2]}function U(a){var b=a.easting,d=a.zoneNumber;if(0>d||60<d)return null;var c=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),g,f,p,n;f=a.northing;"N">a.zoneLetter&&(f-=1E7);f=f/.9996/6367449.145945056;n=f+(3*c/2-27*c*c*c/32)*Math.sin(2*f)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*f)+151*c*c*c/96*Math.sin(6*f);g=6378137/Math.sqrt(1-.00669438*Math.sin(n)*Math.sin(n));c=Math.tan(n)*Math.tan(n);f=.006739496752268451*Math.cos(n)*Math.cos(n);p=6335439.32722994/Math.pow(1-.00669438*Math.sin(n)*Math.sin(n),1.5);b=(b-5E5)/(.9996*g);g=n-g*Math.tan(n)/p*(b*b/2-(5+3*c+10*f-4*f*f-.06065547077041606)*b*b*b*b/24+(61+90*c+298*f+45*c*c-1.6983531815716497-3*f*f)*b*b*b*b*b*b/720);g=g/Math.PI*180;b=(b-(1+2*c+f)*b*b*b/6+(5-2*f+28*c-3*f*f+.05391597401814761+24*c*c)*b*b*b*b*b/120)/Math.cos(n);b=6*(d-1)-180+3+b/Math.PI*180;a.accuracy?(a=U({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber}),a={top:a.lat,right:a.lon,bottom:g,left:b}):a={lat:g,lon:b};return a}function A(a){a%=6;0===a&&(a=6);return a}function G(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b=a.length,d,c="",g,f=0;!/[A-Z]/.test(g=a.charAt(f));){if(2<=f)throw"MGRSPoint bad conversion from: "+a;c+=g;f++}c=parseInt(c,10);if(0===f||f+3>b)throw"MGRSPoint bad conversion from: "+a;g=a.charAt(f++);if("A">=g||"B"===g||"Y"===g||"Z"<=g||"I"===g||"O"===g)throw"MGRSPoint zone letter "+g+" not handled: "+a;d=a.substring(f,f+=2);var p=A(c),n;n=d.charAt(0);for(var m="AJSAJS".charCodeAt(p-1),h=1E5,e=!1;m!==n.charCodeAt(0);){m++;73===m&&m++;79===m&&m++;if(90<m){if(e)throw"Bad character: "+n;m=65;e=!0}h+=1E5}n=h;d=d.charAt(1);if("V"<d)throw"MGRSPoint given invalid Northing "+d;p="AFAFAF".charCodeAt(p-1);m=0;for(h=!1;p!==d.charCodeAt(0);){p++;73===p&&p++;79===p&&p++;if(86<p){if(h)throw"Bad character: "+d;p=65;h=!0}m+=1E5}for(p=m;p<J(g);)p+=2E6;b-=f;if(0!==b%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var b=b/2,m=d=0,x;0<b&&(x=1E5/Math.pow(10,b),d=a.substring(f,f+b),d=parseFloat(d)*x,a=a.substring(f+b),m=parseFloat(a)*x);return{easting:d+n,northing:m+p,zoneLetter:g,zoneNumber:c,accuracy:x}}function J(a){var b;switch(a){case "C":b=11E5;break;case "D":b=2E6;break;case "E":b=28E5;break;case "F":b=37E5;break;case "G":b=46E5;break;case "H":b=55E5;break;case "J":b=64E5;break;case "K":b=73E5;break;case "L":b=82E5;break;case "M":b=91E5;break;case "N":b=0;break;case "P":b=8E5;break;case "Q":b=17E5;break;case "R":b=26E5;break;case "S":b=35E5;break;case "T":b=44E5;break;case "U":b=53E5;break;case "V":b=62E5;break;case "W":b=7E6;break;case "X":b=79E5;break;default:b=-1}if(0<=b)return b;throw"Invalid zone letter: "+a;}function H(a,b,d){if(!(this instanceof H))return new H(a,b,d);Array.isArray(a)?(this.x=a[0],this.y=a[1],this.z=a[2]||0):"object"===typeof a?(this.x=a.x,this.y=a.y,this.z=a.z||0):"string"===typeof a&&"undefined"===typeof b?(a=a.split(","),this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0):(this.x=a,this.y=b,this.z=d||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var t=Math.PI/2,r="undefined"===typeof Number.EPSILON?1E-10:Number.EPSILON,P=Math.PI/4,X=2*Math.PI,Z={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},aa={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},Q=/[\s_\-\/\(\)]/g,I=function(a){var b={};a=a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,b){var d=b.split("\x3d");d.push(!0);a[d[0].toLowerCase()]=d[1];return a},{});var d,c,g,f={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a)},lat_0:function(a){b.lat0=.017453292519943295*a},lat_1:function(a){b.lat1=.017453292519943295*a},lat_2:function(a){b.lat2=.017453292519943295*a},lat_ts:function(a){b.lat_ts=.017453292519943295*a},lon_0:function(a){b.long0=.017453292519943295*a},lon_1:function(a){b.long1=.017453292519943295*a},lon_2:function(a){b.long2=.017453292519943295*a},alpha:function(a){b.alpha=.017453292519943295*parseFloat(a)},lonc:function(a){b.longc=.017453292519943295*a},x_0:function(a){b.x0=parseFloat(a)},y_0:function(a){b.y0=parseFloat(a)},k_0:function(a){b.k0=parseFloat(a)},k:function(a){b.k0=parseFloat(a)},a:function(a){b.a=parseFloat(a)},b:function(a){b.b=parseFloat(a)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){b.to_meter=parseFloat(a)},units:function(a){b.units=a;if(a=e(aa,a))b.to_meter=a.to_meter},from_greenwich:function(a){b.from_greenwich=.017453292519943295*a},pm:function(a){var d=e(Z,a);b.from_greenwich=.017453292519943295*(d?d:parseFloat(a))},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){3===a.length&&-1!=="ewnsud".indexOf(a.substr(0,1))&&-1!=="ewnsud".indexOf(a.substr(1,1))&&-1!=="ewnsud".indexOf(a.substr(2,1))&&(b.axis=a)}};for(d in a)c=a[d],d in f?(g=f[d],"function"===typeof g?g(c):b[g]=c):b[d]=c;"string"===typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase());return b},B=/\s/,Y=/[A-Za-z]/,ba=/[A-Za-z84]/,S=/[,\]]/,fa=/[\d\.E\-\+]/;k.prototype.readCharicter=function(){var a=this.text[this.place++];if(4!==this.state)for(;B.test(a);){if(this.place>=this.text.length)return;a=this.text[this.place++]}switch(this.state){case 1:return this.neutral(a);case 2:return this.keyword(a);case 4:return this.quoted(a);case 5:return this.afterquote(a);case 3:return this.number(a)}};k.prototype.afterquote=function(a){if('"'===a)this.word+='"',this.state=4;else if(S.test(a))this.word=this.word.trim(),this.afterItem(a);else throw Error("havn't handled \""+a+'" in afterquote yet, index '+this.place);};k.prototype.afterItem=function(a){","===a?(null!==this.word&&this.currentObject.push(this.word),this.word=null,this.state=1):"]"===a&&(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),this.currentObject||(this.state=-1))};k.prototype.number=function(a){if(fa.test(a))this.word+=a;else if(S.test(a))this.word=parseFloat(this.word),this.afterItem(a);else throw Error("havn't handled \""+a+'" in number yet, index '+this.place);};k.prototype.quoted=function(a){'"'===a?this.state=5:this.word+=a};k.prototype.keyword=function(a){if(ba.test(a))this.word+=a;else if("["===a)a=[],a.push(this.word),this.level++,null===this.root?this.root=a:this.currentObject.push(a),this.stack.push(this.currentObject),this.currentObject=a,this.state=1;else if(S.test(a))this.afterItem(a);else throw Error("havn't handled \""+a+'" in keyword yet, index '+this.place);};k.prototype.neutral=function(a){if(Y.test(a))this.word=a,this.state=2;else if('"'===a)this.word="",this.state=4;else if(fa.test(a))this.word=a,this.state=3;else if(S.test(a))this.afterItem(a);else throw Error("havn't handled \""+a+'" in neutral yet, index '+this.place);};k.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw Error('unable to parse string "'+this.text+'". State is '+this.state);};var W=function(a){a=(new k(a)).output();var b=a.shift(),d=a.shift();a.unshift(["name",d]);a.unshift(["type",b]);b={};c(a,b);h(b);return b};(function(a){a("EPSG:4326","+title\x3dWGS 84 (long/lat) +proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +units\x3ddegrees");a("EPSG:4269","+title\x3dNAD83 (long/lat) +proj\x3dlonglat +a\x3d6378137.0 +b\x3d6356752.31414036 +ellps\x3dGRS80 +datum\x3dNAD83 +units\x3ddegrees");a("EPSG:3857","+title\x3dWGS 84 / Pseudo-Mercator +proj\x3dmerc +a\x3d6378137 +b\x3d6378137 +lat_ts\x3d0.0 +lon_0\x3d0.0 +x_0\x3d0.0 +y_0\x3d0 +k\x3d1.0 +units\x3dm +nadgrids\x3d@null +no_defs");a.WGS84=a["EPSG:4326"];a["EPSG:3785"]=a["EPSG:3857"];a.GOOGLE=a["EPSG:3857"];a["EPSG:900913"]=a["EPSG:3857"];a["EPSG:102113"]=a["EPSG:3857"]})(a);var la="PROJECTEDCRS PROJCRS GEOGCS GEOCCS PROJCS LOCAL_CS GEODCRS GEODETICCRS GEODETICDATUM ENGCRS ENGINEERINGCRS".split(" "),wa=function(a,b){a=a||{};var d,c;if(!b)return a;for(c in b)d=b[c],void 0!==d&&(a[c]=d);return a},R=function(a,b,d){a*=b;return d/Math.sqrt(1-a*a)},w=function(a){return 3.14159265359>=Math.abs(a)?a:a-(0>a?-1:1)*X},V=function(a,b,d){d*=a;d=Math.pow((1-d)/(1+d),.5*a);return Math.tan(.5*(t-b))/d},da=function(a,b){for(var d=.5*a,c,g=t-2*Math.atan(b),f=0;15>=f;f++)if(c=a*Math.sin(g),c=t-2*Math.atan(b*Math.pow((1-c)/(1+c),d))-g,g+=c,1E-10>=Math.abs(c))return g;return-9999},ya=[{init:function(){var a=this.b/this.a;this.es=1-a*a;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):R(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(a){var b=a.x,d=a.y;if(90<57.29577951308232*d&&-90>57.29577951308232*d&&180<57.29577951308232*b&&-180>57.29577951308232*b||Math.abs(Math.abs(d)-t)<=r)return null;this.sphere?(b=this.x0+this.a*this.k0*w(b-this.long0),d=this.y0+this.a*this.k0*Math.log(Math.tan(P+.5*d))):(d=V(this.e,d,Math.sin(d)),b=this.x0+this.a*this.k0*w(b-this.long0),d=this.y0-this.a*this.k0*Math.log(d));a.x=b;a.y=d;return a},inverse:function(a){var b=a.x-this.x0,d=a.y-this.y0;if(this.sphere)d=t-2*Math.atan(Math.exp(-d/(this.a*this.k0)));else if(d=da(this.e,Math.exp(-d/(this.a*this.k0))),-9999===d)return null;b=w(this.long0+b/(this.a*this.k0));a.x=b;a.y=d;return a},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:f,inverse:f,names:["longlat","identity"]}],ia={},ca=[],za={start:function(){ya.forEach(m)},add:m,get:function(a){if(!a)return!1;a=a.toLowerCase();if("undefined"!==typeof ia[a]&&ca[ia[a]])return ca[ia[a]]}},ma={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl \x26 S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah \x26 Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},va=ma.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};ma.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r\x3d6370997)"};var O={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};q.projections=za;q.projections.start();var ja=function(a,b,d){var c=d.x,g=d.y,f=d.z||0,p,n,m,h={};for(m=0;3>m;m++)if(!b||2!==m||void 0!==d.z)switch(0===m?(p=c,n="x"):1===m?(p=g,n="y"):(p=f,n="z"),a.axis[m]){case "e":h[n]=p;break;case "w":h[n]=-p;break;case "n":h[n]=p;break;case "s":h[n]=-p;break;case "u":void 0!==d[n]&&(h.z=p);break;case "d":void 0!==d[n]&&(h.z=-p);break;default:return null}return h},na=function(a){var b={x:a[0],y:a[1]};2<a.length&&(b.z=a[2]);3<a.length&&(b.m=a[3]);return b},xa=q("WGS84"),Aa={forward:N,inverse:function(a){a=U(G(a.toUpperCase()));return a.lat&&a.lon?[a.lon,a.lat,a.lon,a.lat]:[a.left,a.bottom,a.right,a.top]},toPoint:M};H.fromMGRS=function(a){return new H(M(a))};H.prototype.toMGRS=function(a){return N([this.x,this.y],a)};var qa=function(a){var b=[];b[0]=1-a*(.25+a*(.046875+a*(.01953125+.01068115234375*a)));b[1]=a*(.75-a*(.046875+a*(.01953125+.01068115234375*a)));var d=a*a;b[2]=d*(.46875-a*(.013020833333333334+.007120768229166667*a));d*=a;b[3]=d*(.3645833333333333-.005696614583333333*a);b[4]=d*a*.3076171875;return b},ea=function(a,b,d,c){d*=b;b*=b;return c[0]*a-d*(c[1]+b*(c[2]+b*(c[3]+b*c[4])))},ka=function(a,b,d){for(var c=1/(1-b),g=a,f=20;f;--f){var n=Math.sin(g),p=1-b*n*n,p=(ea(g,n,Math.cos(g),d)-a)*p*Math.sqrt(p)*c,g=g-p;if(Math.abs(p)<r)break}return g},Ba={init:function(){this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.es&&(this.en=qa(this.es),this.ml0=ea(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(a){var b=a.y,d=w(a.x-this.long0),c,g=Math.sin(b),f=Math.cos(b);if(this.es){var n=f*d,p=Math.pow(n,2),m=this.ep2*Math.pow(f,2),h=Math.pow(m,2),e=Math.pow(Math.abs(f)>r?Math.tan(b):0,2),x=Math.pow(e,2);c=1-this.es*Math.pow(g,2);n/=Math.sqrt(c);b=ea(b,g,f,this.en);c=this.a*this.k0*n*(1+p/6*(1-e+m+p/20*(5-18*e+x+14*m-58*e*m+p/42*(61+179*x-x*e-479*e))))+this.x0;d=this.a*this.k0*(b-this.ml0+g*d*n/2*(1+p/12*(5-e+9*m+4*h+p/30*(61+x-58*e+270*m-330*e*m+p/56*(1385+543*x-x*e-3111*e)))))+this.y0}else{g=f*Math.sin(d);if(Math.abs(Math.abs(g)-1)<r)return 93;c=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0;d=f*Math.cos(d)/Math.sqrt(1-Math.pow(g,2));g=Math.abs(d);if(1<=g){if(g-1>r)return 93;d=0}else d=Math.acos(d);0>b&&(d=-d);d=this.a*this.k0*(d-this.lat0)+this.y0}a.x=c;a.y=d;return a},inverse:function(a){var b,d,c=1/this.a*(a.x-this.x0),g=1/this.a*(a.y-this.y0);if(this.es)if(b=this.ml0+g/this.k0,d=ka(b,this.es,this.en),Math.abs(d)<t){var g=Math.cos(d),f=Math.abs(g)>r?Math.tan(d):0,n=this.ep2*Math.pow(g,2),p=Math.pow(n,2),m=Math.pow(f,2),h=Math.pow(m,2);b=1-this.es*Math.pow(Math.sin(d),2);var c=c*Math.sqrt(b)/this.k0,e=Math.pow(c,2);b=d-b*f*e/(1-this.es)*.5*(1-e/12*(5+3*m-9*n*m+n-4*p-e/30*(61+90*m-252*n*m+45*h+46*n-e/56*(1385+3633*m+4095*h+1574*h*m))));d=w(this.long0+c*(1-e/6*(1+2*m+n-e/20*(5+28*m+24*h+8*n*m+6*n-e/42*(61+662*m+1320*h+720*h*m))))/g)}else b=t*(0>g?-1:1),d=0;else b=Math.exp(c/this.k0),d=.5*(b-1/b),n=Math.cos(this.lat0+g/this.k0),b=Math.sqrt((1-Math.pow(n,2))/(1+Math.pow(d,2))),b=Math.asin(b),0>g&&(b=-b),d=0===d&&0===n?0:w(Math.atan2(d,n)+this.long0);a.x=d;a.y=b;return a},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},n=function(a){a=Math.exp(a);return(a-1/a)/2},K=function(a,b){a=Math.abs(a);b=Math.abs(b);var d=Math.max(a,b);return d*Math.sqrt(1+Math.pow(Math.min(a,b)/(d?d:1),2))},Fa=function(a,b){for(var d=2*Math.cos(2*b),c=a.length-1,g=a[c],f=0,n;0<=--c;)n=-f+d*g+a[c],f=g,g=n;return b+n*Math.sin(2*b)},Ha=function(a,b,d){var c=Math.sin(b);b=Math.cos(b);var g=n(d);d=Math.exp(d);d=(d+1/d)/2;for(var f=2*b*d,p=-2*c*g,m=a.length-1,h=a[m],e=0,x=0,E=0,k,l;0<=--m;)k=x,l=e,x=h,e=E,h=-k+f*x-p*e+a[m],E=-l+p*x+f*e;f=c*d;p=b*g;return[f*h-p*E,f*E+p*h]},Ca={init:function(){if(void 0===this.es||0>=this.es)throw Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.cgb=[];this.cbg=[];this.utg=[];this.gtu=[];var a=this.es/(1+Math.sqrt(1-this.es)),a=a/(2-a),b;this.cgb[0]=a*(2+a*(-2/3+a*(-2+a*(116/45+a*(26/45+-2854/675*a)))));this.cbg[0]=a*(-2+a*(2/3+a*(4/3+a*(-82/45+a*(32/45+4642/4725*a)))));b=a*a;this.cgb[1]=b*(7/3+a*(-1.6+a*(-227/45+a*(2704/315+2323/945*a))));this.cbg[1]=b*(5/3+a*(-16/15+a*(-13/9+a*(904/315+-1522/945*a))));b*=a;this.cgb[2]=b*(56/15+a*(-136/35+a*(-1262/105+73814/2835*a)));this.cbg[2]=b*(-26/15+a*(34/21+a*(1.6+-12686/2835*a)));b*=a;this.cgb[3]=b*(4279/630+a*(-332/35+-399572/14175*a));this.cbg[3]=b*(1237/630+a*(-2.4+-24832/14175*a));b*=a;this.cgb[4]=b*(4174/315+-144838/6237*a);this.cbg[4]=b*(-734/315+109598/31185*a);b*=a;this.cgb[5]=601676/22275*b;this.cbg[5]=444337/155925*b;b=Math.pow(a,2);this.Qn=this.k0/(1+a)*(1+b*(.25+b*(.015625+b/256)));this.utg[0]=a*(-.5+a*(2/3+a*(-37/96+a*(1/360+a*(81/512+-96199/604800*a)))));this.gtu[0]=a*(.5+a*(-2/3+a*(.3125+a*(41/180+a*(-127/288+7891/37800*a)))));this.utg[1]=b*(-1/48+a*(-1/15+a*(437/1440+a*(-46/105+.2890188388723545*a))));this.gtu[1]=b*(13/48+a*(-.6+a*(557/1440+a*(281/630+-1.0248393063822752*a))));b*=a;this.utg[2]=b*(-17/480+a*(37/840+a*(209/4480+-5569/90720*a)));this.gtu[2]=b*(61/240+a*(-103/140+a*(15061/26880+167603/181440*a)));b*=a;this.utg[3]=b*(-4397/161280+a*(11/504+830251/7257600*a));this.gtu[3]=b*(49561/161280+a*(-179/168+.9096203979276896*a));b*=a;this.utg[4]=b*(-4583/161280+108847/3991680*a);this.gtu[4]=b*(34729/80640+-1.713007555715889*a);b*=a;this.utg[5]=-.03233083094085698*b;this.gtu[5]=.6650675310896665*b;a=Fa(this.cbg,this.lat0);b=-this.Qn;for(var d=this.gtu,c=2*a,g=2*Math.cos(c),f=d.length-1,n=d[f],m=0,h;0<=--f;)h=-m+g*n+d[f],m=n,n=h;this.Zb=b*(a+Math.sin(c)*h)},forward:function(a){var b=w(a.x-this.long0),d=a.y,d=Fa(this.cbg,d),c=Math.sin(d),g=Math.cos(d),f=Math.sin(b),b=Math.cos(b),d=Math.atan2(c,b*g),b=Math.atan2(f*g,K(c,g*b)),b=Math.tan(b),c=Math.abs(b),c=c*(1+c/(K(1,c)+1)),g=1+c,f=g-1,c=0===f?c:c*Math.log(g)/f,b=0>b?-c:c,c=Ha(this.gtu,2*d,2*b),d=d+c[0],b=b+c[1];2.623395162778>=Math.abs(b)?(b=this.a*this.Qn*b+this.x0,d=this.a*(this.Qn*d+this.Zb)+this.y0):d=b=Infinity;a.x=b;a.y=d;return a},inverse:function(a){var b=1/this.a*(a.x-this.x0),d=1/this.a*(a.y-this.y0),d=(d-this.Zb)/this.Qn,b=b/this.Qn;if(2.623395162778>=Math.abs(b))var c=Ha(this.utg,2*d,2*b),d=d+c[0],b=b+c[1],b=Math.atan(n(b)),c=Math.cos(d),g=Math.sin(b),b=Math.cos(b),d=Math.atan2(Math.sin(d)*b,K(g,b*c)),b=Math.atan2(g,b*c),b=w(b+this.long0),d=Fa(this.cgb,d);else d=b=Infinity;a.x=b;a.y=d;return a},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},Ia={init:function(){var a;a=this.zone;void 0===a&&(a=Math.floor(30*(w(this.long0)+Math.PI)/Math.PI)+1,0>a?a=0:60<a&&(a=60));if(void 0===a)throw Error("unknown utm zone");this.lat0=0;this.long0=.017453292519943295*(6*Math.abs(a)-183);this.x0=5E5;this.y0=this.utmSouth?1E7:0;this.k0=.9996;Ca.init.apply(this);this.forward=Ca.forward;this.inverse=Ca.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},Ga=function(a,b){return Math.pow((1-a)/(1+a),b)},Ja=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0),b=b*b;this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a);this.C=Math.sqrt(1+this.es*b*b/(1-this.es));this.phic0=Math.asin(a/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+P)/(Math.pow(Math.tan(.5*this.lat0+P),this.C)*Ga(this.e*a,this.ratexp))},Ka=function(a){var b=a.x,d=a.y;a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*d+P),this.C)*Ga(this.e*Math.sin(d),this.ratexp))-t;a.x=this.C*b;return a},La=function(a){for(var b=a.x/this.C,d=a.y,c=Math.pow(Math.tan(.5*d+P)/this.K,1/this.C),g=20;0<g;--g){d=2*Math.atan(c*Ga(this.e*Math.sin(a.y),-.5*this.e))-t;if(1E-14>Math.abs(d-a.y))break;a.y=d}if(!g)return null;a.x=b;a.y=d;return a},Ma={init:function(){Ja.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(a){var b,d,c,g;a.x=w(a.x-this.long0);Ka.apply(this,[a]);b=Math.sin(a.y);d=Math.cos(a.y);c=Math.cos(a.x);g=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*d*c);a.x=g*d*Math.sin(a.x);a.y=g*(this.cosc0*b-this.sinc0*d*c);a.x=this.a*a.x+this.x0;a.y=this.a*a.y+this.y0;return a},inverse:function(a){var b,d,c,g;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(g=Math.sqrt(a.x*a.x+a.y*a.y))?(c=2*Math.atan2(g,this.R2),b=Math.sin(c),d=Math.cos(c),c=Math.asin(d*this.sinc0+a.y*b*this.cosc0/g),b=Math.atan2(a.x*b,g*this.cosc0*d-a.y*this.sinc0*b)):(c=this.phic0,b=0);a.x=b;a.y=c;La.apply(this,[a]);a.x=w(a.x+this.long0);return a},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},Na={init:function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=r&&(this.k0=.5*(1+(0>this.lat0?-1:1)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=r&&(this.con=0<this.lat0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=r&&(this.k0=.5*this.cons*R(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/V(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=R(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-t,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(a){var b=a.x,d=a.y,c=Math.sin(d),g=Math.cos(d),f,n=w(b-this.long0);if(Math.abs(Math.abs(b-this.long0)-Math.PI)<=r&&Math.abs(d+this.lat0)<=r)return a.x=NaN,a.y=NaN,a;if(this.sphere)b=2*this.k0/(1+this.sinlat0*c+this.coslat0*g*Math.cos(n)),a.x=this.a*b*g*Math.sin(n)+this.x0,a.y=this.a*b*(this.coslat0*c-this.sinlat0*g*Math.cos(n))+this.y0;else{f=2*Math.atan(this.ssfn_(d,c,this.e))-t;g=Math.cos(f);f=Math.sin(f);if(Math.abs(this.coslat0)<=r)return c=V(this.e,d*this.con,this.con*c),c=2*this.a*this.k0*c/this.cons,a.x=this.x0+c*Math.sin(b-this.long0),a.y=this.y0-this.con*c*Math.cos(b-this.long0),a;Math.abs(this.sinlat0)<r?(b=2*this.a*this.k0/(1+g*Math.cos(n)),a.y=b*f):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*f+this.cosX0*g*Math.cos(n))),a.y=b*(this.cosX0*f-this.sinX0*g*Math.cos(n))+this.y0);a.x=b*g*Math.sin(n)+this.x0}return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,d,c,g=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){c=2*Math.atan(g/(.5*this.a*this.k0));b=this.long0;d=this.lat0;if(g<=r)return a.x=b,a.y=d,a;d=Math.asin(Math.cos(c)*this.sinlat0+a.y*Math.sin(c)*this.coslat0/g);b=Math.abs(this.coslat0)<r?0<this.lat0?w(this.long0+Math.atan2(a.x,-1*a.y)):w(this.long0+Math.atan2(a.x,a.y)):w(this.long0+Math.atan2(a.x*Math.sin(c),g*this.coslat0*Math.cos(c)-a.y*this.sinlat0*Math.sin(c)));a.x=b;a.y=d;return a}if(Math.abs(this.coslat0)<=r){if(g<=r)return d=this.lat0,b=this.long0,a.x=b,a.y=d,a;a.x*=this.con;a.y*=this.con;b=g*this.cons/(2*this.a*this.k0);d=this.con*da(this.e,b);b=this.con*w(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else d=2*Math.atan(g*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,g<=r?c=this.X0:(c=Math.asin(Math.cos(d)*this.sinX0+a.y*Math.sin(d)*this.cosX0/g),b=w(this.long0+Math.atan2(a.x*Math.sin(d),g*this.cosX0*Math.cos(d)-a.y*this.sinX0*Math.sin(d)))),d=-1*da(this.e,Math.tan(.5*(t+c)));a.x=b;a.y=d;return a},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(a,b,d){b*=d;return Math.tan(.5*(t+a))*Math.pow((1-b)/(1+b),.5*d)}},Oa={init:function(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),d=this.a,c=1/this.rf,c=2*c-Math.pow(c,2),g=this.e=Math.sqrt(c);this.R=this.k0*d*Math.sqrt(1-c)/(1-c*Math.pow(b,2));this.alpha=Math.sqrt(1+c/(1-c)*Math.pow(Math.cos(a),4));this.b0=Math.asin(b/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+a/2))+this.alpha*g/2*Math.log((1+g*b)/(1-g*b))},forward:function(a){var b=2*(Math.atan(Math.exp(-this.alpha*(Math.log(Math.tan(Math.PI/4-a.y/2))+this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))))+this.K))-Math.PI/4),d=this.alpha*(a.x-this.lambda0),c=Math.atan(Math.sin(d)/(Math.sin(this.b0)*Math.tan(b)+Math.cos(this.b0)*Math.cos(d))),b=Math.asin(Math.cos(this.b0)*Math.sin(b)-Math.sin(this.b0)*Math.cos(b)*Math.cos(d));a.y=this.R/2*Math.log((1+Math.sin(b))/(1-Math.sin(b)))+this.y0;a.x=this.R*c+this.x0;return a},inverse:function(a){for(var b=(a.x-this.x0)/this.R,d=2*(Math.atan(Math.exp((a.y-this.y0)/this.R))-Math.PI/4),c=Math.asin(Math.cos(this.b0)*Math.sin(d)+Math.sin(this.b0)*Math.cos(d)*Math.cos(b)),b=this.lambda0+Math.atan(Math.sin(b)/(Math.cos(this.b0)*Math.cos(b)-Math.sin(this.b0)*Math.tan(d)))/this.alpha,g=c,f=-1E3,n=0;1E-7<Math.abs(g-f);){if(20<++n)return;d=1/this.alpha*(Math.log(Math.tan(Math.PI/4+c/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(g))/2));f=g;g=2*Math.atan(Math.exp(d))-Math.PI/2}a.x=b;a.y=g;return a},names:["somerc"]},Pa={init:function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),d=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-d*d);a=V(this.e,this.lat0,a);b=this.bl/b*Math.sqrt((1-this.es)/(1-d*d));1>b*b&&(b=1);var c;if(isNaN(this.longc)){d=V(this.e,this.lat1,Math.sin(this.lat1));c=V(this.e,this.lat2,Math.sin(this.lat2));this.el=0<=this.lat0?(b+Math.sqrt(b*b-1))*Math.pow(a,this.bl):(b-Math.sqrt(b*b-1))*Math.pow(a,this.bl);var d=Math.pow(d,this.bl),g=Math.pow(c,this.bl);c=this.el/d;a=.5*(c-1/c);c=(this.el*this.el-g*d)/(this.el*this.el+g*d);d=(g-d)/(g+d);g=w(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(c*Math.tan(.5*this.bl*g)/d)/this.bl;this.long0=w(this.long0);d=w(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*d)/a);this.alpha=Math.asin(b*Math.sin(this.gamma0))}else c=0<=this.lat0?b+Math.sqrt(b*b-1):b-Math.sqrt(b*b-1),this.el=c*Math.pow(a,this.bl),this.gamma0=Math.asin(Math.sin(this.alpha)/b),this.long0=this.longc-Math.asin(.5*(c-1/c)*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:0<=this.lat0?this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha))},forward:function(a){var b=a.y,d=w(a.x-this.long0);if(Math.abs(Math.abs(b)-t)<=r)d=0<b?-1:1,b=this.al/this.bl*Math.log(Math.tan(P+d*this.gamma0*.5)),d=-1*d*t*this.al/this.bl;else var b=V(this.e,b,Math.sin(b)),b=this.el/Math.pow(b,this.bl),c=.5*(b-1/b),g=Math.sin(this.bl*d),b=(c*Math.sin(this.gamma0)-g*Math.cos(this.gamma0))/(.5*(b+1/b)),b=Math.abs(Math.abs(b)-1)<=r?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-b)/(1+b))/this.bl,d=Math.abs(Math.cos(this.bl*d))<=r?this.al*this.bl*d:this.al*Math.atan2(c*Math.cos(this.gamma0)+g*Math.sin(this.gamma0),Math.cos(this.bl*d))/this.bl;this.no_rot?(a.x=this.x0+d,a.y=this.y0+b):(d-=this.uc,a.x=this.x0+b*Math.cos(this.alpha)+d*Math.sin(this.alpha),a.y=this.y0+d*Math.cos(this.alpha)-b*Math.sin(this.alpha));return a},inverse:function(a){var b,d;this.no_rot?(d=a.y-this.y0,b=a.x-this.x0):(d=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var c=Math.exp(-1*this.bl*d/this.al);d=.5*(c-1/c);var g=Math.sin(this.bl*b/this.al),c=(g*Math.cos(this.gamma0)+d*Math.sin(this.gamma0))/(.5*(c+1/c)),f=Math.pow(this.el/Math.sqrt((1+c)/(1-c)),1/this.bl);Math.abs(c-1)<r?(a.x=this.long0,a.y=t):Math.abs(c+1)<r?(a.x=this.long0,a.y=-1*t):(a.y=da(this.e,f),a.x=w(this.long0-Math.atan2(d*Math.cos(this.gamma0)-g*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl));return a},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},Qa={init:function(){this.lat2||(this.lat2=this.lat1);this.k0||(this.k0=1);this.x0=this.x0||0;this.y0=this.y0||0;if(!(Math.abs(this.lat1+this.lat2)<r)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var a=Math.sin(this.lat1),b=R(this.e,a,Math.cos(this.lat1)),d=V(this.e,this.lat1,a),c=Math.sin(this.lat2),g=R(this.e,c,Math.cos(this.lat2)),c=V(this.e,this.lat2,c),f=V(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>r?Math.log(b/g)/Math.log(d/c):a;isNaN(this.ns)&&(this.ns=a);this.f0=b/(this.ns*Math.pow(d,this.ns));this.rh=this.a*this.f0*Math.pow(f,this.ns);this.title||(this.title="Lambert Conformal Conic")}},forward:function(a){var b=a.x,d=a.y;Math.abs(2*Math.abs(d)-Math.PI)<=r&&(d=(0>d?-1:1)*(t-2*r));var c=Math.abs(Math.abs(d)-t);if(c>r)d=V(this.e,d,Math.sin(d)),d=this.a*this.f0*Math.pow(d,this.ns);else{c=d*this.ns;if(0>=c)return null;d=0}b=this.ns*w(b-this.long0);a.x=this.k0*d*Math.sin(b)+this.x0;a.y=this.k0*(this.rh-d*Math.cos(b))+this.y0;return a},inverse:function(a){var b,d,c,g=(a.x-this.x0)/this.k0,f=this.rh-(a.y-this.y0)/this.k0;0<this.ns?(b=Math.sqrt(g*g+f*f),d=1):(b=-Math.sqrt(g*g+f*f),d=-1);c=0;0!==b&&(c=Math.atan2(d*g,d*f));if(0!==b||0<this.ns){if(d=1/this.ns,b=Math.pow(b/(this.a*this.f0),d),b=da(this.e,b),-9999===b)return null}else b=-t;c=w(c/this.ns+this.long0);a.x=c;a.y=b;return a},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},Ra={init:function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq},forward:function(a){var b,d,c;b=a.y;c=w(a.x-this.long0);b=2*(Math.atan(this.k*Math.pow(Math.tan(b/2+this.s45),this.alfa)/Math.pow((1+this.e*Math.sin(b))/(1-this.e*Math.sin(b)),this.alfa*this.e/2))-this.s45);d=-c*this.alfa;c=Math.asin(Math.cos(this.ad)*Math.sin(b)+Math.sin(this.ad)*Math.cos(b)*Math.cos(d));b=this.n*Math.asin(Math.cos(b)*Math.sin(d)/Math.cos(c));c=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(c/2+this.s45),this.n);a.y=c*Math.cos(b)/1;a.x=c*Math.sin(b)/1;this.czech||(a.y*=-1,a.x*=-1);return a},inverse:function(a){var b,d,c;b=a.x;a.x=a.y;a.y=b;this.czech||(a.y*=-1,a.x*=-1);b=Math.sqrt(a.x*a.x+a.y*a.y);c=Math.atan2(a.y,a.x)/Math.sin(this.s0);d=2*(Math.atan(Math.pow(this.ro0/b,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);b=Math.asin(Math.cos(this.ad)*Math.sin(d)-Math.sin(this.ad)*Math.cos(d)*Math.cos(c));a.x=this.long0-Math.asin(Math.cos(d)*Math.sin(c)/Math.cos(b))/this.alfa;c=b;var g=d=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.e/2))-this.s45),1E-10>Math.abs(c-a.y)&&(d=1),c=a.y,g+=1;while(0===d&&15>g);return 15<=g?null:a},names:["Krovak","krovak"]},T=function(a,b,d,c,g){return a*g-b*Math.sin(2*g)+d*Math.sin(4*g)-c*Math.sin(6*g)},ra=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))},sa=function(a){return.375*a*(1+.25*a*(1+.46875*a))},ta=function(a){return.05859375*a*a*(1+.75*a)},ua=function(a){return 35/3072*a*a*a},oa=function(a,b,d){b*=d;return a/Math.sqrt(1-b*b)},pa=function(a){return Math.abs(a)<t?a:a-(0>a?-1:1)*Math.PI},Da=function(a,b,d,c,g){var f,n;f=a/b;for(var m=0;15>m;m++)if(n=(a-(b*f-d*Math.sin(2*f)+c*Math.sin(4*f)-g*Math.sin(6*f)))/(b-2*d*Math.cos(2*f)+4*c*Math.cos(4*f)-6*g*Math.cos(6*f)),f+=n,1E-10>=Math.abs(n))return f;return NaN},Sa={init:function(){this.sphere||(this.e0=ra(this.es),this.e1=sa(this.es),this.e2=ta(this.es),this.e3=ua(this.es),this.ml0=this.a*T(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(a){var b,d,c=a.x,g=a.y,c=w(c-this.long0);if(this.sphere)b=this.a*Math.asin(Math.cos(g)*Math.sin(c)),d=this.a*(Math.atan2(Math.tan(g),Math.cos(c))-this.lat0);else{d=Math.sin(g);var f=Math.cos(g),n=oa(this.a,this.e,d),m=Math.tan(g)*Math.tan(g);b=c*Math.cos(g);var c=b*b,h=this.es*f*f/(1-this.es),g=this.a*T(this.e0,this.e1,this.e2,this.e3,g);b=n*b*(1-c*m*(1/6-(8-m+8*h)*c/120));d=g-this.ml0+n*d/f*c*(.5+(5-m+6*h)*c/24)}a.x=b+this.x0;a.y=d+this.y0;return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,d=a.y/this.a,c;if(this.sphere)c=d+this.lat0,d=Math.asin(Math.sin(c)*Math.cos(b)),c=Math.atan2(Math.tan(b),Math.cos(c));else{c=Da(this.ml0/this.a+d,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(c)-t)<=r)return a.x=this.long0,a.y=t,0>d&&(a.y*=-1),a;var d=oa(this.a,this.e,Math.sin(c)),g=Math.pow(Math.tan(c),2),b=b*this.a/d,f=b*b,d=c-d*Math.tan(c)/(d*d*d/this.a/this.a*(1-this.es))*b*b*(.5-(1+3*g)*b*b/24);c=b*(1-f*(g/3+(1+3*g)*g*f/15))/Math.cos(c)}a.x=w(c+this.long0);a.y=pa(d);return a},names:["Cassini","Cassini_Soldner","cass"]},ga=function(a,b){var d;return 1E-7<a?(d=a*b,(1-a*a)*(b/(1-d*d)-.5/a*Math.log((1-d)/(1+d)))):2*b},Ta={init:function(){var a=Math.abs(this.lat0);this.mode=Math.abs(a-t)<r?0>this.lat0?this.S_POLE:this.N_POLE:Math.abs(a)<r?this.EQUIT:this.OBLIQ;if(0<this.es){this.qp=ga(this.e,1);this.mmf=.5/(1-this.es);var a=this.es,b,d=[];d[0]=.3333333333333333*a;b=a*a;d[0]+=.17222222222222222*b;d[1]=.06388888888888888*b;b*=a;d[0]+=.10257936507936508*b;d[1]+=.0664021164021164*b;d[2]=.016415012942191543*b;this.apa=d;switch(this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),a=Math.sin(this.lat0),this.sinb1=ga(this.e,a)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*a*a)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(a){var b,d,c,g,f,n,m,h;g=a.x;var e=a.y;g=w(g-this.long0);if(this.sphere)if(f=Math.sin(e),n=Math.cos(e),c=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){d=this.mode===this.EQUIT?1+n*c:1+this.sinph0*f+this.cosph0*n*c;if(d<=r)return null;d=Math.sqrt(2/d);b=d*n*Math.sin(g);d*=this.mode===this.EQUIT?f:this.cosph0*f-this.sinph0*n*c}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(c=-c);if(Math.abs(e+this.phi0)<r)return null;d=P-.5*e;d=2*(this.mode===this.S_POLE?Math.cos(d):Math.sin(d));b=d*Math.sin(g);d*=c}}else{h=m=n=0;c=Math.cos(g);g=Math.sin(g);f=Math.sin(e);f=ga(this.e,f);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)n=f/this.qp,m=Math.sqrt(1-n*n);switch(this.mode){case this.OBLIQ:h=1+this.sinb1*n+this.cosb1*m*c;break;case this.EQUIT:h=1+m*c;break;case this.N_POLE:h=t+e;f=this.qp-f;break;case this.S_POLE:h=e-t,f=this.qp+f}if(Math.abs(h)<r)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h);d=this.mode===this.OBLIQ?this.ymf*h*(this.cosb1*n-this.sinb1*m*c):(h=Math.sqrt(2/(1+m*c)))*n*this.ymf;b=this.xmf*h*m*g;break;case this.N_POLE:case this.S_POLE:0<=f?(b=(h=Math.sqrt(f))*g,d=c*(this.mode===this.S_POLE?h:-h)):b=d=0}}a.x=this.a*b+this.x0;a.y=this.a*d+this.y0;return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,d=a.y/this.a,c,g,f,n;if(this.sphere){n=g=0;f=Math.sqrt(b*b+d*d);c=.5*f;if(1<c)return null;c=2*Math.asin(c);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)n=Math.sin(c),g=Math.cos(c);switch(this.mode){case this.EQUIT:c=Math.abs(f)<=r?0:Math.asin(d*n/f);b*=n;d=g*f;break;case this.OBLIQ:c=Math.abs(f)<=r?this.phi0:Math.asin(g*this.sinph0+d*n*this.cosph0/f);b*=n*this.cosph0;d=(g-Math.sin(c)*this.sinph0)*f;break;case this.N_POLE:d=-d;c=t-c;break;case this.S_POLE:c-=t}b=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(b,d):0}else{c=0;if(this.mode===this.OBLIQ||this.mode===this.EQUIT){b/=this.dd;d*=this.dd;n=Math.sqrt(b*b+d*d);if(n<r)return a.x=0,a.y=this.phi0,a;f=2*Math.asin(.5*n/this.rq);g=Math.cos(f);b*=f=Math.sin(f);this.mode===this.OBLIQ?(c=g*this.sinb1+d*f*this.cosb1/n,d=n*this.cosb1*g-d*this.sinb1*f):(c=d*f/n,d=n*g)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(d=-d);c=b*b+d*d;if(!c)return a.x=0,a.y=this.phi0,a;c=1-c/this.qp;this.mode===this.S_POLE&&(c=-c)}b=Math.atan2(b,d);d=Math.asin(c);c=this.apa;g=d+d;c=d+c[0]*Math.sin(g)+c[1]*Math.sin(g+g)+c[2]*Math.sin(g+g+g)}a.x=w(this.long0+b);a.y=c;return a},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},ha=function(a){1<Math.abs(a)&&(a=1<a?1:-1);return Math.asin(a)},Ua={init:function(){Math.abs(this.lat1+this.lat2)<r||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.con=this.t1=this.sin_po,this.ms1=R(this.e3,this.sin_po,this.cos_po),this.qs1=ga(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=R(this.e3,this.sin_po,this.cos_po),this.qs2=ga(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ga(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>r?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(a){var b=a.x,d=a.y;this.sin_phi=Math.sin(d);this.cos_phi=Math.cos(d);var d=ga(this.e3,this.sin_phi,this.cos_phi),d=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,b=this.ns0*w(b-this.long0),c=this.rh-d*Math.cos(b)+this.y0;a.x=d*Math.sin(b)+this.x0;a.y=c;return a},inverse:function(a){var b,d,c;a.x-=this.x0;a.y=this.rh-a.y+this.y0;0<=this.ns0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1);c=0;0!==b&&(c=Math.atan2(d*a.x,d*a.y));d=b*this.ns0/this.a;this.sphere?b=Math.asin((this.c-d*d)/(2*this.ns0)):(b=(this.c-d*d)/this.ns0,b=this.phi1z(this.e3,b));c=w(c/this.ns0+this.long0);a.x=c;a.y=b;return a},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(a,b){var d,c,g,f,n=ha(.5*b);if(a<r)return n;for(var m=a*a,h=1;25>=h;h++)if(d=Math.sin(n),c=Math.cos(n),g=a*d,f=1-g*g,d=.5*f*f/c*(b/(1-m)-d/f+.5/a*Math.log((1-g)/(1+g))),n+=d,1E-7>=Math.abs(d))return n;return null}},Va={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1},forward:function(a){var b,d,c,g,f;d=a.y;c=w(a.x-this.long0);b=Math.sin(d);d=Math.cos(d);g=Math.cos(c);f=this.sin_p14*b+this.cos_p14*d*g;0<f||Math.abs(f)<=r?(c=this.x0+1*this.a*d*Math.sin(c)/f,b=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*d*g)/f):(c=this.x0+this.infinity_dist*d*Math.sin(c),b=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*d*g));a.x=c;a.y=b;return a},inverse:function(a){var b,d,c,g;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(b=Math.sqrt(a.x*a.x+a.y*a.y))?(g=Math.atan2(b,this.rc),d=Math.sin(g),c=Math.cos(g),g=ha(c*this.sin_p14+a.y*d*this.cos_p14/b),b=Math.atan2(a.x*d,b*this.cos_p14*c-a.y*this.sin_p14*d),b=w(this.long0+b)):(g=this.phic0,b=0);a.x=b;a.y=g;return a},names:["gnom"]},Wa={init:function(){this.sphere||(this.k0=R(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(a){var b=a.y,d;d=w(a.x-this.long0);this.sphere?(d=this.x0+this.a*d*Math.cos(this.lat_ts),b=this.y0+this.a*Math.sin(b)/Math.cos(this.lat_ts)):(b=ga(this.e,Math.sin(b)),d=this.x0+this.a*this.k0*d,b=this.y0+this.a*b*.5/this.k0);a.x=d;a.y=b;return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,d;if(this.sphere)b=w(this.long0+a.x/this.a/Math.cos(this.lat_ts)),d=Math.asin(a.y/this.a*Math.cos(this.lat_ts));else{a:if(b=this.e,d=2*a.y*this.k0/this.a,1E-6>Math.abs(Math.abs(d)-(1-(1-b*b)/(2*b)*Math.log((1-b)/(1+b)))))d=0>d?-1*t:t;else{for(var c=Math.asin(.5*d),g,f,n,m=0;30>m;m++)if(g=Math.sin(c),f=Math.cos(c),n=b*g,g=Math.pow(1-n*n,2)/(2*f)*(d/(1-b*b)-g/(1-n*n)+.5/b*Math.log((1-n)/(1+n))),c+=g,1E-10>=Math.abs(g)){d=c;break a}d=NaN}b=w(this.long0+a.x/(this.a*this.k0))}a.x=b;a.y=d;return a},names:["cea"]},Xa={init:function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)},forward:function(a){var b=a.y,d=w(a.x-this.long0),b=pa(b-this.lat0);a.x=this.x0+this.a*d*this.rc;a.y=this.y0+this.a*b;return a},inverse:function(a){var b=a.y;a.x=w(this.long0+(a.x-this.x0)/(this.a*this.rc));a.y=pa(this.lat0+(b-this.y0)/this.a);return a},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Ya={init:function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=ra(this.es);this.e1=sa(this.es);this.e2=ta(this.es);this.e3=ua(this.es);this.ml0=this.a*T(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(a){var b=a.y,d,c;d=w(a.x-this.long0);c=d*Math.sin(b);if(this.sphere)Math.abs(b)<=r?(d*=this.a,b=-1*this.a*this.lat0):(d=this.a*Math.sin(c)/Math.tan(b),b=this.a*(pa(b-this.lat0)+(1-Math.cos(c))/Math.tan(b)));else if(Math.abs(b)<=r)d*=this.a,b=-1*this.ml0;else{var g=oa(this.a,this.e,Math.sin(b))/Math.tan(b);d=g*Math.sin(c);b=this.a*T(this.e0,this.e1,this.e2,this.e3,b)-this.ml0+g*(1-Math.cos(c))}a.x=d+this.x0;a.y=b+this.y0;return a},inverse:function(a){var b,d,c,g,f,n,m;b=a.x-this.x0;c=a.y-this.y0;if(this.sphere)if(Math.abs(c+this.a*this.lat0)<=r)b=w(b/this.a+this.long0),d=0;else{g=this.lat0+c/this.a;f=b*b/this.a/this.a+g*g;n=g;for(c=20;c;--c)if(m=Math.tan(n),m=-1*(g*(n*m+1)-n-.5*(n*n+f)*m)/((n-g)/m-1),n+=m,Math.abs(m)<=r){d=n;break}b=w(this.long0+Math.asin(b*Math.tan(n)/this.a)/Math.sin(d))}else if(Math.abs(c+this.ml0)<=r)d=0,b=w(this.long0+b/this.a);else{g=(this.ml0+c)/this.a;f=b*b/this.a/this.a+g*g;n=g;var h,e;for(c=20;c;--c)if(m=this.e*Math.sin(n),m=Math.sqrt(1-m*m)*Math.tan(n),h=this.a*T(this.e0,this.e1,this.e2,this.e3,n),e=this.e0-2*this.e1*Math.cos(2*n)+4*this.e2*Math.cos(4*n)-6*this.e3*Math.cos(6*n),h/=this.a,m=(g*(m*h+1)-h-.5*m*(h*h+f))/(this.es*Math.sin(2*n)*(h*h+f-2*g*h)/(4*m)+(g-h)*(m*e-2/Math.sin(2*n))-e),n-=m,Math.abs(m)<=r){d=n;break}m=Math.sqrt(1-this.es*Math.pow(Math.sin(d),2))*Math.tan(d);b=w(this.long0+Math.asin(b*m/this.a)/Math.sin(d))}a.x=b;a.y=d;return a},names:["Polyconic","poly"]},Za={init:function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013},forward:function(a){var b,d=a.x-this.long0,c=(a.y-this.lat0)/4.84813681109536E-6*1E-5,g=1,f=0;for(b=1;10>=b;b++)g*=c,f+=this.A[b]*g;var c=f,g=1,n=0,m=0,h=0;for(b=1;6>=b;b++)f=g*c-n*d,n=n*c+g*d,g=f,m=m+this.B_re[b]*g-this.B_im[b]*n,h=h+this.B_im[b]*g+this.B_re[b]*n;a.x=h*this.a+this.x0;a.y=m*this.a+this.y0;return a},inverse:function(a){var b,d=(a.y-this.y0)/this.a,c=(a.x-this.x0)/this.a,g=1,f=0,n,m=0,h=0;for(b=1;6>=b;b++)n=g*d-f*c,f=f*d+g*c,g=n,m=m+this.C_re[b]*g-this.C_im[b]*f,h=h+this.C_im[b]*g+this.C_re[b]*f;for(g=0;g<this.iterations;g++){var e=m,x=h,k;n=d;f=c;for(b=2;6>=b;b++)k=e*m-x*h,x=x*m+e*h,e=k,n+=(b-1)*(this.B_re[b]*e-this.B_im[b]*x),f+=(b-1)*(this.B_im[b]*e+this.B_re[b]*x);var e=1,x=0,l=this.B_re[1],K=this.B_im[1];for(b=2;6>=b;b++)k=e*m-x*h,x=x*m+e*h,e=k,l+=b*(this.B_re[b]*e-this.B_im[b]*x),K+=b*(this.B_im[b]*e+this.B_re[b]*x);h=l*l+K*K;m=(n*l+f*K)/h;h=(f*l-n*K)/h}d=m;c=1;m=0;for(b=1;9>=b;b++)c*=d,m+=this.D[b]*c;b=this.lat0+.484813681109536*m;a.x=this.long0+h;a.y=b;return a},names:["New_Zealand_Map_Grid","nzmg"]},$a={init:function(){},forward:function(a){var b=a.y,d=w(a.x-this.long0),b=this.y0+this.a*Math.log(Math.tan(Math.PI/4+b/2.5))*1.25;a.x=this.x0+this.a*d;a.y=b;return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b=w(this.long0+a.x/this.a),d=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);a.x=b;a.y=d;return a},names:["Miller_Cylindrical","mill"]},ab={init:function(){this.sphere?(this.n=1,this.es=this.m=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=qa(this.es)},forward:function(a){var b,d;b=a.x;d=a.y;b=w(b-this.long0);if(this.sphere){if(this.m)for(var c=this.n*Math.sin(d),g=20;g;--g){var f=(this.m*d+Math.sin(d)-c)/(this.m+Math.cos(d));d-=f;if(Math.abs(f)<r)break}else d=1!==this.n?Math.asin(this.n*Math.sin(d)):d;b=this.a*this.C_x*b*(this.m+Math.cos(d));d*=this.a*this.C_y}else c=Math.sin(d),g=Math.cos(d),d=this.a*ea(d,c,g,this.en),b=this.a*b*g/Math.sqrt(1-this.es*c*c);a.x=b;a.y=d;return a},inverse:function(a){var b,d,c;a.x-=this.x0;d=a.x/this.a;a.y-=this.y0;b=a.y/this.a;this.sphere?(b/=this.C_y,d/=this.C_x*(this.m+Math.cos(b)),this.m?b=ha((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=ha(Math.sin(b)/this.n)),d=w(d+this.long0),b=pa(b)):(b=ka(a.y/this.a,this.es,this.en),c=Math.abs(b),c<t?(c=Math.sin(b),d=this.long0+a.x*Math.sqrt(1-this.es*c*c)/(this.a*Math.cos(b)),d=w(d)):c-r<t&&(d=this.long0));a.x=d;a.y=b;return a},names:["Sinusoidal","sinu"]},bb={init:function(){},forward:function(a){for(var b=a.y,d=w(a.x-this.long0),c=b,g=Math.PI*Math.sin(b),f=0;;f++){var n=-(c+Math.sin(c)-g)/(1+Math.cos(c)),c=c+n;if(Math.abs(n)<r)break}c/=2;Math.PI/2-Math.abs(b)<r&&(d=0);b=1.4142135623731*this.a*Math.sin(c)+this.y0;a.x=.900316316158*this.a*d*Math.cos(c)+this.x0;a.y=b;return a},inverse:function(a){var b;a.x-=this.x0;a.y-=this.y0;b=a.y/(1.4142135623731*this.a);.999999999999<Math.abs(b)&&(b=.999999999999);b=Math.asin(b);var d=w(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));d<-Math.PI&&(d=-Math.PI);d>Math.PI&&(d=Math.PI);b=(2*b+Math.sin(2*b))/Math.PI;1<Math.abs(b)&&(b=1);b=Math.asin(b);a.x=d;a.y=b;return a},names:["Mollweide","moll"]},cb={init:function(){Math.abs(this.lat1+this.lat2)<r||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ra(this.es),this.e1=sa(this.es),this.e2=ta(this.es),this.e3=ua(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=R(this.e,this.sinphi,this.cosphi),this.ml1=T(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<r?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=R(this.e,this.sinphi,this.cosphi),this.ml2=T(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=T(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(a){var b=a.x,d=a.y;this.sphere||(d=T(this.e0,this.e1,this.e2,this.e3,d));var d=this.a*(this.g-d),b=this.ns*w(b-this.long0),c=this.y0+this.rh-d*Math.cos(b);a.x=this.x0+d*Math.sin(b);a.y=c;return a},inverse:function(a){a.x-=this.x0;a.y=this.rh-a.y+this.y0;var b,d,c;0<=this.ns?(d=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(d=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);c=0;0!==d&&(c=Math.atan2(b*a.x,b*a.y));this.sphere?(c=w(this.long0+c/this.ns),d=pa(this.g-d/this.a)):(d=Da(this.g-d/this.a,this.e0,this.e1,this.e2,this.e3),c=w(this.long0+c/this.ns));a.x=c;a.y=d;return a},names:["Equidistant_Conic","eqdc"]},db={init:function(){this.R=this.a},forward:function(a){var b=a.y,d=w(a.x-this.long0),c=ha(2*Math.abs(b/Math.PI)),g=.5*Math.abs(Math.PI/d-d/Math.PI),f=g*g,n=Math.sin(c),c=Math.cos(c),c=c/(n+c-1),n=c*(2/n-1),m=n*n,h=Math.PI*this.R*(g*(c-m)+Math.sqrt(f*(c-m)*(c-m)-(m+f)*(c*c-m)))/(m+f);0>d&&(h=-h);d=this.x0+h;c=f+c;h=Math.PI*this.R*(n*c-g*Math.sqrt((m+f)*(f+1)-c*c))/(m+f);b=0<=b?this.y0+h:this.y0-h;a.x=d;a.y=b;return a},inverse:function(a){var b,d,c,g,f,n,m,h;a.x-=this.x0;a.y-=this.y0;f=Math.PI*this.R;b=a.x/f;c=a.y/f;g=b*b+c*c;f=-Math.abs(c)*(1+g);d=f-2*c*c+b*b;n=-2*f+1+2*c*c+g*g;m=(f-d*d/3/n)/n;h=2*Math.sqrt(-m/3);f=3*(c*c/n+(2*d*d*d/n/n/n-9*f*d/n/n)/27)/m/h;1<Math.abs(f)&&(f=0<=f?1:-1);f=Math.acos(f)/3;d=0<=a.y?(-h*Math.cos(f+Math.PI/3)-d/3/n)*Math.PI:-(-h*Math.cos(f+Math.PI/3)-d/3/n)*Math.PI;b=Math.abs(b)<r?this.long0:w(this.long0+Math.PI*(g-1+Math.sqrt(1+2*(b*b-c*c)+g*g))/2/b);a.x=b;a.y=d;return a},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},eb={init:function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)},forward:function(a){var b=a.y,d=Math.sin(a.y),c=Math.cos(a.y),g=w(a.x-this.long0),f,n,m,h,e;this.sphere?Math.abs(this.sin_p12-1)<=r?(a.x=this.x0+this.a*(t-b)*Math.sin(g),a.y=this.y0-this.a*(t-b)*Math.cos(g)):Math.abs(this.sin_p12+1)<=r?(a.x=this.x0+this.a*(t+b)*Math.sin(g),a.y=this.y0+this.a*(t+b)*Math.cos(g)):(b=this.sin_p12*d+this.cos_p12*c*Math.cos(g),b=Math.acos(b),b/=Math.sin(b),a.x=this.x0+this.a*b*c*Math.sin(g),a.y=this.y0+this.a*b*(this.cos_p12*d-this.sin_p12*c*Math.cos(g))):(f=ra(this.es),n=sa(this.es),m=ta(this.es),h=ua(this.es),Math.abs(this.sin_p12-1)<=r?(c=this.a*T(f,n,m,h,t),b=this.a*T(f,n,m,h,b),a.x=this.x0+(c-b)*Math.sin(g),a.y=this.y0-(c-b)*Math.cos(g)):Math.abs(this.sin_p12+1)<=r?(c=this.a*T(f,n,m,h,t),b=this.a*T(f,n,m,h,b),a.x=this.x0+(c+b)*Math.sin(g),a.y=this.y0+(c+b)*Math.cos(g)):(f=d/c,b=oa(this.a,this.e,this.sin_p12),d=oa(this.a,this.e,d),d=Math.atan((1-this.es)*f+this.es*b*this.sin_p12/(d*c)),c=Math.atan2(Math.sin(g),this.cos_p12*Math.tan(d)-this.sin_p12*Math.cos(g)),f=0===c?Math.asin(this.cos_p12*Math.sin(d)-this.sin_p12*Math.cos(d)):Math.abs(Math.abs(c)-Math.PI)<=r?-Math.asin(this.cos_p12*Math.sin(d)-this.sin_p12*Math.cos(d)):Math.asin(Math.sin(g)*Math.cos(d)/Math.sin(c)),g=this.e*this.sin_p12/Math.sqrt(1-this.es),n=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es),d=g*n,n*=n,m=f*f,h=m*f,e=h*f,b=b*f*(1-m*n*(1-n)/6+h/8*d*(1-2*n)+e/120*(n*(4-7*n)-3*g*g*(1-7*n))-e*f/48*d),a.x=this.x0+b*Math.sin(c),a.y=this.y0+b*Math.cos(c)));return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,d,c,g,f,n;if(this.sphere){b=Math.sqrt(a.x*a.x+a.y*a.y);if(b>2*t*this.a)return;d=b/this.a;c=Math.sin(d);g=Math.cos(d);d=this.long0;Math.abs(b)<=r?f=this.lat0:(f=ha(g*this.sin_p12+a.y*c*this.cos_p12/b),d=Math.abs(this.lat0)-t,d=Math.abs(d)<=r?0<=this.lat0?w(this.long0+Math.atan2(a.x,-a.y)):w(this.long0-Math.atan2(-a.x,a.y)):w(this.long0+Math.atan2(a.x*c,b*this.cos_p12*g-a.y*this.sin_p12*c)))}else c=ra(this.es),d=sa(this.es),g=ta(this.es),f=ua(this.es),Math.abs(this.sin_p12-1)<=r?(n=this.a*T(c,d,g,f,t),b=Math.sqrt(a.x*a.x+a.y*a.y),f=Da((n-b)/this.a,c,d,g,f),d=w(this.long0+Math.atan2(a.x,-1*a.y))):Math.abs(this.sin_p12+1)<=r?(n=this.a*T(c,d,g,f,t),b=Math.sqrt(a.x*a.x+a.y*a.y),f=Da((b-n)/this.a,c,d,g,f),d=w(this.long0+Math.atan2(a.x,a.y))):(b=Math.sqrt(a.x*a.x+a.y*a.y),c=Math.atan2(a.x,a.y),f=oa(this.a,this.e,this.sin_p12),d=Math.cos(c),g=this.e*this.cos_p12*d,g=-g*g/(1-this.es),n=3*this.es*(1-g)*this.sin_p12*this.cos_p12*d/(1-this.es),f=b/f,b=f-g*(1+g)*Math.pow(f,3)/6-n*(1+3*g)*Math.pow(f,4)/24,g=1-g*b*b/2-f*b*b*b/6,f=Math.asin(this.sin_p12*Math.cos(b)+this.cos_p12*Math.sin(b)*d),d=w(this.long0+Math.asin(Math.sin(c)*Math.sin(b)/Math.cos(f))),f=Math.atan((1-this.es*g*this.sin_p12/Math.sin(f))*Math.tan(f)/(1-this.es)));a.x=d;a.y=f;return a},names:["Azimuthal_Equidistant","aeqd"]},fb={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)},forward:function(a){var b,d,c,g,f,n,m;d=a.y;c=w(a.x-this.long0);b=Math.sin(d);d=Math.cos(d);g=Math.cos(c);f=this.sin_p14*b+this.cos_p14*d*g;if(0<f||Math.abs(f)<=r)n=1*this.a*d*Math.sin(c),m=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*d*g);a.x=n;a.y=m;return a},inverse:function(a){var b,d,c,g,f;a.x-=this.x0;a.y-=this.y0;b=Math.sqrt(a.x*a.x+a.y*a.y);d=ha(b/this.a);c=Math.sin(d);d=Math.cos(d);g=this.long0;if(Math.abs(b)<=r)return f=this.lat0,a.x=g,a.y=f,a;f=ha(d*this.sin_p14+a.y*c*this.cos_p14/b);if(Math.abs(Math.abs(this.lat0)-t)<=r)return g=0<=this.lat0?w(this.long0+Math.atan2(a.x,-a.y)):w(this.long0-Math.atan2(-a.x,a.y)),a.x=g,a.y=f,a;g=w(this.long0+Math.atan2(a.x*c,b*this.cos_p14*d-a.y*this.sin_p14*c));a.x=g;a.y=f;return a},names:["ortho"]};D.defaultDatum="WGS84";D.Proj=q;D.WGS84=new D.Proj("WGS84");D.Point=H;D.toPoint=na;D.defs=a;D.transform=y;D.mgrs=Aa;D.version="2.4.3";(function(a){a.Proj.projections.add(Ba);a.Proj.projections.add(Ca);a.Proj.projections.add(Ia);a.Proj.projections.add(Ma);a.Proj.projections.add(Na);a.Proj.projections.add(Oa);a.Proj.projections.add(Pa);a.Proj.projections.add(Qa);a.Proj.projections.add(Ra);a.Proj.projections.add(Sa);a.Proj.projections.add(Ta);a.Proj.projections.add(Ua);a.Proj.projections.add(Va);a.Proj.projections.add(Wa);a.Proj.projections.add(Xa);a.Proj.projections.add(Ya);a.Proj.projections.add(Za);a.Proj.projections.add($a);a.Proj.projections.add(ab);a.Proj.projections.add(bb);a.Proj.projections.add(cb);a.Proj.projections.add(db);a.Proj.projections.add(eb);a.Proj.projections.add(fb)})(D);return D});(function(e,k,l){function c(){var a=e.L;b.noConflict=function(){e.L=a;return this};e.L=b}var b={version:"1.0.3+ed36a04"};"object"===typeof module&&"object"===typeof module.exports?module.exports=b:"function"===typeof define&&define.amd&&define(b);"undefined"!==typeof e&&c();b.Util={extend:function(a){var b,c,f,m;c=1;for(f=arguments.length;c<f;c++)for(b in m=arguments[c],m)a[b]=m[b];return a},create:Object.create||function(){function a(){}return function(b){a.prototype=b;return new a}}(),bind:function(a,b){var d=Array.prototype.slice;if(a.bind)return a.bind.apply(a,d.call(arguments,1));var c=d.call(arguments,2);return function(){return a.apply(b,c.length?c.concat(d.call(arguments)):arguments)}},stamp:function(a){a._leaflet_id=a._leaflet_id||++b.Util.lastId;return a._leaflet_id},lastId:0,throttle:function(a,b,c){var d,g,h,e;e=function(){d=!1;g&&(h.apply(c,g),g=!1)};return h=function(){d?g=arguments:(a.apply(c,arguments),setTimeout(e,b),d=!0)}},wrapNum:function(a,b,c){var d=b[1];b=b[0];var g=d-b;return a===d&&c?a:((a-b)%g+g)%g+b},falseFn:function(){return!1},formatNum:function(a,b){var d=Math.pow(10,b||5);return Math.round(a*d)/d},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return b.Util.trim(a).split(/\s+/)},setOptions:function(a,d){a.hasOwnProperty("options")||(a.options=a.options?b.Util.create(a.options):{});for(var c in d)a.options[c]=d[c];return a.options},getParamString:function(a,b,c){var d=[],g;for(g in a)d.push(encodeURIComponent(c?g.toUpperCase():g)+"\x3d"+encodeURIComponent(a[g]));return(b&&-1!==b.indexOf("?")?"\x26":"?")+d.join("\x26")},template:function(a,d){return a.replace(b.Util.templateRe,function(a,b){var c=d[b];if(c===l)throw Error("No value provided for variable "+a);"function"===typeof c&&(c=c(d));return c})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},indexOf:function(a,b){for(var d=0;d<a.length;d++)if(a[d]===b)return d;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"};(function(){function a(a){return e["webkit"+a]||e["moz"+a]||e["ms"+a]}function d(a){var b=+new Date,d=Math.max(0,16-(b-c));c=b+d;return e.setTimeout(a,d)}var c=0,f=e.requestAnimationFrame||a("RequestAnimationFrame")||d,m=e.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(a){e.clearTimeout(a)};b.Util.requestAnimFrame=function(a,c,g){if(g&&f===d)a.call(c);else return f.call(e,b.bind(a,c))};b.Util.cancelAnimFrame=function(a){a&&m.call(e,a)}})();b.extend=b.Util.extend;b.bind=b.Util.bind;b.stamp=b.Util.stamp;b.setOptions=b.Util.setOptions;b.Class=function(){};b.Class.extend=function(a){var d=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},c=d.__super__=this.prototype,f=b.Util.create(c);f.constructor=d;d.prototype=f;for(var m in this)this.hasOwnProperty(m)&&"prototype"!==m&&(d[m]=this[m]);a.statics&&(b.extend(d,a.statics),delete a.statics);a.includes&&(b.Util.extend.apply(null,[f].concat(a.includes)),delete a.includes);f.options&&(a.options=b.Util.extend(b.Util.create(f.options),a.options));b.extend(f,a);f._initHooks=[];f.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this);this._initHooksCalled=!0;for(var a=0,b=f._initHooks.length;a<b;a++)f._initHooks[a].call(this)}};return d};b.Class.include=function(a){b.extend(this.prototype,a);return this};b.Class.mergeOptions=function(a){b.extend(this.prototype.options,a);return this};b.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"===typeof a?a:function(){this[a].apply(this,b)});return this};b.Evented=b.Class.extend({on:function(a,d,c){if("object"===typeof a)for(var g in a)this._on(g,a[g],d);else{a=b.Util.splitWords(a);g=0;for(var m=a.length;g<m;g++)this._on(a[g],d,c)}return this},off:function(a,d,c){if(a)if("object"===typeof a)for(var g in a)this._off(g,a[g],d);else{a=b.Util.splitWords(a);g=0;for(var m=a.length;g<m;g++)this._off(a[g],d,c)}else delete this._events;return this},_on:function(a,b,c){this._events=this._events||{};var d=this._events[a];d||(d=[],this._events[a]=d);c===this&&(c=l);a={fn:b,ctx:c};for(var g=0,h=d.length;g<h;g++)if(d[g].fn===b&&d[g].ctx===c)return;d.push(a)},_off:function(a,d,c){var g,m,h;if(this._events&&(g=this._events[a]))if(d){if(c===this&&(c=l),g)for(m=0,h=g.length;m<h;m++){var e=g[m];if(e.ctx===c&&e.fn===d){e.fn=b.Util.falseFn;this._firingCount&&(this._events[a]=g=g.slice());g.splice(m,1);break}}}else{m=0;for(h=g.length;m<h;m++)g[m].fn=b.Util.falseFn;delete this._events[a]}},fire:function(a,d,c){if(!this.listens(a,c))return this;d=b.Util.extend({},d,{type:a,target:this});if(this._events&&(a=this._events[a])){this._firingCount=this._firingCount+1||1;for(var g=0,m=a.length;g<m;g++){var h=a[g];h.fn.call(h.ctx||this,d)}this._firingCount--}c&&this._propagateEvent(d);return this},listens:function(a,b){var d=this._events&&this._events[a];if(d&&d.length)return!0;if(b)for(var c in this._eventParents)if(this._eventParents[c].listens(a,b))return!0;return!1},once:function(a,d,c){if("object"===typeof a){for(var g in a)this.once(g,a[g],d);return this}var m=b.bind(function(){this.off(a,d,c).off(a,m,c)},this);return this.on(a,d,c).on(a,m,c)},addEventParent:function(a){this._eventParents=this._eventParents||{};this._eventParents[b.stamp(a)]=a;return this},removeEventParent:function(a){this._eventParents&&delete this._eventParents[b.stamp(a)];return this},_propagateEvent:function(a){for(var d in this._eventParents)this._eventParents[d].fire(a.type,b.extend({layer:a.target},a),!0)}});var h=b.Evented.prototype;h.addEventListener=h.on;h.removeEventListener=h.clearAllEventListeners=h.off;h.addOneTimeEventListener=h.once;h.fireEvent=h.fire;h.hasEventListeners=h.listens;b.Mixin={Events:h};(function(){var a=navigator.userAgent.toLowerCase(),d=k.documentElement,c="ActiveXObject"in e,f=-1!==a.indexOf("webkit"),m=-1!==a.indexOf("phantom"),h=-1!==a.search("android [23]"),l=-1!==a.indexOf("chrome"),v=-1!==a.indexOf("gecko")&&!f&&!e.opera&&!c,q=0===navigator.platform.indexOf("Win"),u="undefined"!==typeof orientation||-1!==a.indexOf("mobile"),y=!e.PointerEvent&&e.MSPointerEvent,z=e.PointerEvent||y,F=c&&"transition"in d.style,D="WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix&&!h,N="MozPerspective"in d.style,d="OTransition"in d.style,M=!e.L_NO_TOUCH&&(z||"ontouchstart"in e||e.DocumentTouch&&k instanceof e.DocumentTouch);b.Browser={ie:c,ielt9:c&&!k.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in k),webkit:f,gecko:v,android:-1!==a.indexOf("android"),android23:h,chrome:l,safari:!l&&-1!==a.indexOf("safari"),win:q,ie3d:F,webkit3d:D,gecko3d:N,opera12:d,any3d:!e.L_DISABLE_3D&&(F||D||N)&&!d&&!m,mobile:u,mobileWebkit:u&&f,mobileWebkit3d:u&&D,mobileOpera:u&&e.opera,mobileGecko:u&&v,touch:!!M,msPointer:!!y,pointer:!!z,retina:1<(e.devicePixelRatio||e.screen.deviceXDPI/e.screen.logicalXDPI)}})();b.Point=function(a,b,c){this.x=c?Math.round(a):a;this.y=c?Math.round(b):b};b.Point.prototype={clone:function(){return new b.Point(this.x,this.y)},add:function(a){return this.clone()._add(b.point(a))},_add:function(a){this.x+=a.x;this.y+=a.y;return this},subtract:function(a){return this.clone()._subtract(b.point(a))},_subtract:function(a){this.x-=a.x;this.y-=a.y;return this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){this.x/=a;this.y/=a;return this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){this.x*=a;this.y*=a;return this},scaleBy:function(a){return new b.Point(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new b.Point(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){return this.clone()._ceil()},_ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},distanceTo:function(a){a=b.point(a);var d=a.x-this.x;a=a.y-this.y;return Math.sqrt(d*d+a*a)},equals:function(a){a=b.point(a);return a.x===this.x&&a.y===this.y},contains:function(a){a=b.point(a);return Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+b.Util.formatNum(this.x)+", "+b.Util.formatNum(this.y)+")"}};b.point=function(a,d,c){return a instanceof b.Point?a:b.Util.isArray(a)?new b.Point(a[0],a[1]):a===l||null===a?a:"object"===typeof a&&"x"in a&&"y"in a?new b.Point(a.x,a.y):new b.Point(a,d,c)};b.Bounds=function(a,b){if(a)for(var d=b?[a,b]:a,c=0,m=d.length;c<m;c++)this.extend(d[c])};b.Bounds.prototype={extend:function(a){a=b.point(a);this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone());return this},getCenter:function(a){return new b.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new b.Point(this.min.x,this.max.y)},getTopRight:function(){return new b.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var d;a="number"===typeof a[0]||a instanceof b.Point?b.point(a):b.bounds(a);a instanceof b.Bounds?(d=a.min,a=a.max):d=a;return d.x>=this.min.x&&a.x<=this.max.x&&d.y>=this.min.y&&a.y<=this.max.y},intersects:function(a){a=b.bounds(a);var d=this.min,c=this.max,f=a.min;a=a.max;var m=a.y>=d.y&&f.y<=c.y;return a.x>=d.x&&f.x<=c.x&&m},overlaps:function(a){a=b.bounds(a);var d=this.min,c=this.max,f=a.min;a=a.max;var m=a.y>d.y&&f.y<c.y;return a.x>d.x&&f.x<c.x&&m},isValid:function(){return!(!this.min||!this.max)}};b.bounds=function(a,d){return!a||a instanceof b.Bounds?a:new b.Bounds(a,d)};b.Transformation=function(a,b,c,f){this._a=a;this._b=b;this._c=c;this._d=f};b.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){b=b||1;a.x=b*(this._a*a.x+this._b);a.y=b*(this._c*a.y+this._d);return a},untransform:function(a,d){d=d||1;return new b.Point((a.x/d-this._b)/this._a,(a.y/d-this._d)/this._c)}};b.DomUtil={get:function(a){return"string"===typeof a?k.getElementById(a):a},getStyle:function(a,b){var d=a.style[b]||a.currentStyle&&a.currentStyle[b];d&&"auto"!==d||!k.defaultView||(d=(d=k.defaultView.getComputedStyle(a,null))?d[b]:null);return"auto"===d?null:d},create:function(a,b,c){a=k.createElement(a);a.className=b||"";c&&c.appendChild(a);return a},remove:function(a){var b=a.parentNode;b&&b.removeChild(a)},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},toFront:function(a){a.parentNode.appendChild(a)},toBack:function(a){var b=a.parentNode;b.insertBefore(a,b.firstChild)},hasClass:function(a,d){if(a.classList!==l)return a.classList.contains(d);var c=b.DomUtil.getClass(a);return 0<c.length&&(new RegExp("(^|\\s)"+d+"(\\s|$)")).test(c)},addClass:function(a,d){if(a.classList!==l)for(var c=b.Util.splitWords(d),f=0,m=c.length;f<m;f++)a.classList.add(c[f]);else b.DomUtil.hasClass(a,d)||(c=b.DomUtil.getClass(a),b.DomUtil.setClass(a,(c?c+" ":"")+d))},removeClass:function(a,d){a.classList!==l?a.classList.remove(d):b.DomUtil.setClass(a,b.Util.trim((" "+b.DomUtil.getClass(a)+" ").replace(" "+d+" "," ")))},setClass:function(a,b){a.className.baseVal===l?a.className=b:a.className.baseVal=b},getClass:function(a){return a.className.baseVal===l?a.className:a.className.baseVal},setOpacity:function(a,d){"opacity"in a.style?a.style.opacity=d:"filter"in a.style&&b.DomUtil._setOpacityIE(a,d)},_setOpacityIE:function(a,b){var d=!1;try{d=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(f){if(1===b)return}b=Math.round(100*b);d?(d.Enabled=100!==b,d.Opacity=b):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+b+")"},testProp:function(a){for(var b=k.documentElement.style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1},setTransform:function(a,d,c){d=d||new b.Point(0,0);a.style[b.DomUtil.TRANSFORM]=(b.Browser.ie3d?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(c?" scale("+c+")":"")},setPosition:function(a,d){a._leaflet_pos=d;b.Browser.any3d?b.DomUtil.setTransform(a,d):(a.style.left=d.x+"px",a.style.top=d.y+"px")},getPosition:function(a){return a._leaflet_pos||new b.Point(0,0)}};(function(){b.DomUtil.TRANSFORM=b.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var a=b.DomUtil.TRANSITION=b.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);b.DomUtil.TRANSITION_END="webkitTransition"===a||"OTransition"===a?a+"End":"transitionend";if("onselectstart"in k)b.DomUtil.disableTextSelection=function(){b.DomEvent.on(e,"selectstart",b.DomEvent.preventDefault)},b.DomUtil.enableTextSelection=function(){b.DomEvent.off(e,"selectstart",b.DomEvent.preventDefault)};else{var d=b.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);b.DomUtil.disableTextSelection=function(){if(d){var a=k.documentElement.style;this._userSelect=a[d];a[d]="none"}};b.DomUtil.enableTextSelection=function(){d&&(k.documentElement.style[d]=this._userSelect,delete this._userSelect)}}b.DomUtil.disableImageDrag=function(){b.DomEvent.on(e,"dragstart",b.DomEvent.preventDefault)};b.DomUtil.enableImageDrag=function(){b.DomEvent.off(e,"dragstart",b.DomEvent.preventDefault)};b.DomUtil.preventOutline=function(a){for(;-1===a.tabIndex;)a=a.parentNode;a&&a.style&&(b.DomUtil.restoreOutline(),this._outlineElement=a,this._outlineStyle=a.style.outline,a.style.outline="none",b.DomEvent.on(e,"keydown",b.DomUtil.restoreOutline,this))};b.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,b.DomEvent.off(e,"keydown",b.DomUtil.restoreOutline,this))}})();b.LatLng=function(a,b,c){if(isNaN(a)||isNaN(b))throw Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=+a;this.lng=+b;c!==l&&(this.alt=+c)};b.LatLng.prototype={equals:function(a,d){if(!a)return!1;a=b.latLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=(d===l?1E-9:d)},toString:function(a){return"LatLng("+b.Util.formatNum(this.lat,a)+", "+b.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){return b.CRS.Earth.distance(this,b.latLng(a))},wrap:function(){return b.CRS.Earth.wrapLatLng(this)},toBounds:function(a){a=180*a/40075017;var d=a/Math.cos(Math.PI/180*this.lat);return b.latLngBounds([this.lat-a,this.lng-d],[this.lat+a,this.lng+d])},clone:function(){return new b.LatLng(this.lat,this.lng,this.alt)}};b.latLng=function(a,d,c){return a instanceof b.LatLng?a:b.Util.isArray(a)&&"object"!==typeof a[0]?3===a.length?new b.LatLng(a[0],a[1],a[2]):2===a.length?new b.LatLng(a[0],a[1]):null:a===l||null===a?a:"object"===typeof a&&"lat"in a?new b.LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):d===l?null:new b.LatLng(a,d,c)};b.LatLngBounds=function(a,b){if(a)for(var d=b?[a,b]:a,c=0,m=d.length;c<m;c++)this.extend(d[c])};b.LatLngBounds.prototype={extend:function(a){var d=this._southWest,c=this._northEast,f;if(a instanceof b.LatLng)f=a;else if(a instanceof b.LatLngBounds){if(f=a._southWest,a=a._northEast,!f||!a)return this}else return a?this.extend(b.latLng(a)||b.latLngBounds(a)):this;d||c?(d.lat=Math.min(f.lat,d.lat),d.lng=Math.min(f.lng,d.lng),c.lat=Math.max(a.lat,c.lat),c.lng=Math.max(a.lng,c.lng)):(this._southWest=new b.LatLng(f.lat,f.lng),this._northEast=new b.LatLng(a.lat,a.lng));return this},pad:function(a){var d=this._southWest,c=this._northEast,f=Math.abs(d.lat-c.lat)*a;a*=Math.abs(d.lng-c.lng);return new b.LatLngBounds(new b.LatLng(d.lat-f,d.lng-a),new b.LatLng(c.lat+f,c.lng+a))},getCenter:function(){return new b.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new b.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new b.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"===typeof a[0]||a instanceof b.LatLng||"lat"in a?b.latLng(a):b.latLngBounds(a);var d=this._southWest,c=this._northEast,f;a instanceof b.LatLngBounds?(f=a.getSouthWest(),a=a.getNorthEast()):f=a;return f.lat>=d.lat&&a.lat<=c.lat&&f.lng>=d.lng&&a.lng<=c.lng},intersects:function(a){a=b.latLngBounds(a);var d=this._southWest,c=this._northEast,f=a.getSouthWest();a=a.getNorthEast();var m=a.lng>=d.lng&&f.lng<=c.lng;return a.lat>=d.lat&&f.lat<=c.lat&&m},overlaps:function(a){a=b.latLngBounds(a);var d=this._southWest,c=this._northEast,f=a.getSouthWest();a=a.getNorthEast();var m=a.lng>d.lng&&f.lng<c.lng;return a.lat>d.lat&&f.lat<c.lat&&m},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){if(!a)return!1;a=b.latLngBounds(a);return this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast())},isValid:function(){return!(!this._southWest||!this._northEast)}};b.latLngBounds=function(a,d){return a instanceof b.LatLngBounds?a:new b.LatLngBounds(a,d)};b.Projection={};b.Projection.LonLat={project:function(a){return new b.Point(a.lng,a.lat)},unproject:function(a){return new b.LatLng(a.y,a.x)},bounds:b.bounds([-180,-90],[180,90])};b.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var d=Math.PI/180,c=this.MAX_LATITUDE,c=Math.sin(Math.max(Math.min(c,a.lat),-c)*d);return new b.Point(this.R*a.lng*d,this.R*Math.log((1+c)/(1-c))/2)},unproject:function(a){var d=180/Math.PI;return new b.LatLng((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*d,a.x*d/this.R)},bounds:function(){var a=6378137*Math.PI;return b.bounds([-a,-a],[a,a])}()};b.CRS={latLngToPoint:function(a,b){var d=this.projection.project(a),c=this.scale(b);return this.transformation._transform(d,c)},pointToLatLng:function(a,b){var d=this.scale(b),d=this.transformation.untransform(a,d);return this.projection.unproject(d)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var d=this.projection.bounds,c=this.scale(a);a=this.transformation.transform(d.min,c);d=this.transformation.transform(d.max,c);return b.bounds(a,d)},infinite:!1,wrapLatLng:function(a){var d=this.wrapLng?b.Util.wrapNum(a.lng,this.wrapLng,!0):a.lng,c=this.wrapLat?b.Util.wrapNum(a.lat,this.wrapLat,!0):a.lat;return b.latLng(c,d,a.alt)},wrapLatLngBounds:function(a){var d=a.getCenter(),c=this.wrapLatLng(d),f=d.lat-c.lat,d=d.lng-c.lng;if(0===f&&0===d)return a;c=a.getSouthWest();a=a.getNorthEast();c=b.latLng({lat:c.lat-f,lng:c.lng-d});f=b.latLng({lat:a.lat-f,lng:a.lng-d});return new b.LatLngBounds(c,f)}};b.CRS.Simple=b.extend({},b.CRS,{projection:b.Projection.LonLat,transformation:new b.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,b){var d=b.lng-a.lng,c=b.lat-a.lat;return Math.sqrt(d*d+c*c)},infinite:!0});b.CRS.Earth=b.extend({},b.CRS,{wrapLng:[-180,180],R:6371E3,distance:function(a,b){var d=Math.PI/180,c=a.lat*d,m=b.lat*d;return this.R*Math.acos(Math.min(Math.sin(c)*Math.sin(m)+Math.cos(c)*Math.cos(m)*Math.cos((b.lng-a.lng)*d),1))}});b.CRS.EPSG3857=b.extend({},b.CRS.Earth,{code:"EPSG:3857",projection:b.Projection.SphericalMercator,transformation:function(){var a=.5/(Math.PI*b.Projection.SphericalMercator.R);return new b.Transformation(a,.5,-a,.5)}()});b.CRS.EPSG900913=b.extend({},b.CRS.EPSG3857,{code:"EPSG:900913"});b.CRS.EPSG4326=b.extend({},b.CRS.Earth,{code:"EPSG:4326",projection:b.Projection.LonLat,transformation:new b.Transformation(1/180,1,-1/180,.5)});b.Map=b.Evented.extend({options:{crs:b.CRS.EPSG3857,center:l,zoom:l,minZoom:l,maxZoom:l,layers:[],maxBounds:l,renderer:l,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,d){d=b.setOptions(this,d);this._initContainer(a);this._initLayout();this._onResize=b.bind(this._onResize,this);this._initEvents();d.maxBounds&&this.setMaxBounds(d.maxBounds);d.zoom!==l&&(this._zoom=this._limitZoom(d.zoom));d.center&&d.zoom!==l&&this.setView(b.latLng(d.center),d.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();if(this._zoomAnimated=b.DomUtil.TRANSITION&&b.Browser.any3d&&!b.Browser.mobileOpera&&this.options.zoomAnimation)this._createAnimProxy(),b.DomEvent.on(this._proxy,b.DomUtil.TRANSITION_END,this._catchTransitionEnd,this);this._addLayers(this.options.layers)},setView:function(a,d,c){d=d===l?this._zoom:this._limitZoom(d);a=this._limitCenter(b.latLng(a),d,this.options.maxBounds);c=c||{};this._stop();if(this._loaded&&!c.reset&&!0!==c&&(c.animate!==l&&(c.zoom=b.extend({animate:c.animate},c.zoom),c.pan=b.extend({animate:c.animate,duration:c.duration},c.pan)),this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,c.zoom):this._tryAnimatedPan(a,c.pan)))return clearTimeout(this._sizeTimer),this;this._resetView(a,d);return this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=a,this)},zoomIn:function(a,d){a=a||(b.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom+a,d)},zoomOut:function(a,d){a=a||(b.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom-a,d)},setZoomAround:function(a,d,c){var g=this.getZoomScale(d),m=this.getSize().divideBy(2);a=(a instanceof b.Point?a:this.latLngToContainerPoint(a)).subtract(m).multiplyBy(1-1/g);m=this.containerPointToLatLng(m.add(a));return this.setView(m,d,{zoom:c})},_getBoundsCenterZoom:function(a,d){d=d||{};a=a.getBounds?a.getBounds():b.latLngBounds(a);var c=b.point(d.paddingTopLeft||d.padding||[0,0]),f=b.point(d.paddingBottomRight||d.padding||[0,0]),m=this.getBoundsZoom(a,!1,c.add(f)),m="number"===typeof d.maxZoom?Math.min(d.maxZoom,m):m,c=f.subtract(c).divideBy(2),f=this.project(a.getSouthWest(),m),h=this.project(a.getNorthEast(),m);return{center:this.unproject(f.add(h).divideBy(2).add(c),m),zoom:m}},fitBounds:function(a,d){a=b.latLngBounds(a);if(!a.isValid())throw Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(a,d);return this.setView(c.center,c.zoom,d)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a,d){a=b.point(a).round();d=d||{};if(!a.x&&!a.y)return this.fire("moveend");if(!0!==d.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;this._panAnim||(this._panAnim=new b.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this));d.noMoveStart||this.fire("movestart");if(!1!==d.animate){b.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,c,d.duration||.25,d.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,d,c){function g(a){a=(D*D-F*F+2.0164*(a?-1:1)*2.0164*N*N)/(4.0328*(a?D:F)*N);a=Math.sqrt(a*a+1)-a;return 1E-9>a?-18:Math.log(a)}function m(a){return(Math.exp(a)+Math.exp(-a))/2}function h(a){return F*(m(M)/m(M+1.42*a))}function e(a){var b=m(M);a=M+1.42*a;a=(Math.exp(a)-Math.exp(-a))/2/m(a);return F*(b*a-(Math.exp(M)-Math.exp(-M))/2)/2.0164}function k(){var c=(Date.now()-U)/G,g=(1-Math.pow(1-c,1.5))*A;1>=c?(this._flyToFrame=b.Util.requestAnimFrame(k,this),this._move(this.unproject(q.add(u.subtract(q).multiplyBy(e(g)/N)),z),this.getScaleZoom(F/h(g),z),{flyTo:!0})):this._move(a,d)._moveEnd(!0)}c=c||{};if(!1===c.animate||!b.Browser.any3d)return this.setView(a,d,c);this._stop();var q=this.project(this.getCenter()),u=this.project(a),y=this.getSize(),z=this._zoom;a=b.latLng(a);d=d===l?z:d;var F=Math.max(y.x,y.y),D=F*this.getZoomScale(z,d),N=u.distanceTo(q)||1,M=g(0),U=Date.now(),A=(g(1)-M)/1.42,G=c.duration?1E3*c.duration:800*A;this._moveStart(!0);k.call(this);return this},flyToBounds:function(a,b){var d=this._getBoundsCenterZoom(a,b);return this.flyTo(d.center,d.zoom,b)},setMaxBounds:function(a){a=b.latLngBounds(a);if(a.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);this.options.maxBounds=a;this._loaded&&this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(a){this.options.minZoom=a;return this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){this.options.maxZoom=a;return this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,d){this._enforcingBounds=!0;var c=this.getCenter(),f=this._limitCenter(c,this._zoom,b.latLngBounds(a));c.equals(f)||this.panTo(f,d);this._enforcingBounds=!1;return this},invalidateSize:function(a){if(!this._loaded)return this;a=b.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var c=this.getSize(),f=d.divideBy(2).round(),m=c.divideBy(2).round(),f=f.subtract(m);if(!f.x&&!f.y)return this;a.animate&&a.pan?this.panBy(f):(a.pan&&this._rawPanBy(f),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(b.bind(this.fire,this,"moveend"),200)):this.fire("moveend"));return this.fire("resize",{oldSize:d,newSize:c})},stop:function(){this.setZoom(this._limitZoom(this._zoom));this.options.zoomSnap||this.fire("viewreset");return this._stop()},locate:function(a){a=this._locateOptions=b.extend({timeout:1E4,watch:!1},a);if(!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=b.bind(this._handleGeolocationResponse,this),c=b.bind(this._handleGeolocationError,this);a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,c,a):navigator.geolocation.getCurrentPosition(d,c,a);return this},stopLocate:function(){navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId);this._locateOptions&&(this._locateOptions.setView=!1);return this},_handleGeolocationError:function(a){var b=a.code;a=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:b,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var d=new b.LatLng(a.coords.latitude,a.coords.longitude),c=d.toBounds(a.coords.accuracy),f=this._locateOptions;if(f.setView){var m=this.getBoundsZoom(c);this.setView(d,f.maxZoom?Math.min(m,f.maxZoom):m)}var d={latlng:d,bounds:c,timestamp:a.timestamp},h;for(h in a.coords)"number"===typeof a.coords[h]&&(d[h]=a.coords[h]);this.fire("locationfound",d)},addHandler:function(a,b){if(!b)return this;var d=this[a]=new b(this);this._handlers.push(d);this.options[a]&&d.enable();return this},remove:function(){this._initEvents(!0);if(this._containerId!==this._container._leaflet_id)throw Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(d){this._containerId=this._container._leaflet_id=l}b.DomUtil.remove(this._mapPane);this._clearControlPos&&this._clearControlPos();this._clearHandlers();this._loaded&&this.fire("unload");for(var a in this._layers)this._layers[a].remove();return this},createPane:function(a,d){var c="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),c=b.DomUtil.create("div",c,d||this._mapPane);a&&(this._panes[a]=c);return c},getCenter:function(){this._checkIfLoaded();return this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),d=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new b.LatLngBounds(d,a)},getMinZoom:function(){return this.options.minZoom===l?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===l?this._layersMaxZoom===l?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,d,c){a=b.latLngBounds(a);c=b.point(c||[0,0]);var g=this.getZoom()||0,m=this.getMinZoom(),h=this.getMaxZoom(),e=a.getNorthWest();a=a.getSouthEast();c=this.getSize().subtract(c);e=b.bounds(this.project(a,g),this.project(e,g)).getSize();a=b.Browser.any3d?this.options.zoomSnap:1;g=this.getScaleZoom(Math.min(c.x/e.x,c.y/e.y),g);a&&(g=a/100*Math.round(g/(a/100)),g=d?Math.ceil(g/a)*a:Math.floor(g/a)*a);return Math.max(m,Math.min(h,g))},getSize:function(){if(!this._size||this._sizeChanged)this._size=new b.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(a,d){var c=this._getTopLeftPoint(a,d);return new b.Bounds(c,c.add(this.getSize()))},getPixelOrigin:function(){this._checkIfLoaded();return this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===l?this.getZoom():a)},getPane:function(a){return"string"===typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,b){var d=this.options.crs;b=b===l?this._zoom:b;return d.scale(a)/d.scale(b)},getScaleZoom:function(a,b){var d=this.options.crs;b=b===l?this._zoom:b;d=d.zoom(a*d.scale(b));return isNaN(d)?Infinity:d},project:function(a,d){d=d===l?this._zoom:d;return this.options.crs.latLngToPoint(b.latLng(a),d)},unproject:function(a,d){d=d===l?this._zoom:d;return this.options.crs.pointToLatLng(b.point(a),d)},layerPointToLatLng:function(a){a=b.point(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(b.latLng(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(b.latLng(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(b.latLngBounds(a))},distance:function(a,d){return this.options.crs.distance(b.latLng(a),b.latLng(d))},containerPointToLayerPoint:function(a){return b.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return b.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(b.point(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(b.latLng(a)))},mouseEventToContainerPoint:function(a){return b.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){a=this._container=b.DomUtil.get(a);if(!a)throw Error("Map container not found.");if(a._leaflet_id)throw Error("Map container is already initialized.");b.DomEvent.addListener(a,"scroll",this._onScroll,this);this._containerId=b.Util.stamp(a)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&b.Browser.any3d;b.DomUtil.addClass(a,"leaflet-container"+(b.Browser.touch?" leaflet-touch":"")+(b.Browser.retina?" leaflet-retina":"")+(b.Browser.ielt9?" leaflet-oldie":"")+(b.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=b.DomUtil.getStyle(a,"position");"absolute"!==d&&"relative"!==d&&"fixed"!==d&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);b.DomUtil.setPosition(this._mapPane,new b.Point(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||(b.DomUtil.addClass(a.markerPane,"leaflet-zoom-hide"),b.DomUtil.addClass(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,d){b.DomUtil.setPosition(this._mapPane,new b.Point(0,0));var c=!this._loaded;this._loaded=!0;d=this._limitZoom(d);this.fire("viewprereset");var f=this._zoom!==d;this._moveStart(f)._move(a,d)._moveEnd(f);this.fire("viewreset");c&&this.fire("load")},_moveStart:function(a){a&&this.fire("zoomstart");return this.fire("movestart")},_move:function(a,b,c){b===l&&(b=this._zoom);var d=this._zoom!==b;this._zoom=b;this._lastCenter=a;this._pixelOrigin=this._getNewPixelOrigin(a);(d||c&&c.pinch)&&this.fire("zoom",c);return this.fire("move",c)},_moveEnd:function(a){a&&this.fire("zoomend");return this.fire("moveend")},_stop:function(){b.Util.cancelAnimFrame(this._flyToFrame);this._panAnim&&this._panAnim.stop();return this},_rawPanBy:function(a){b.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(a){if(b.DomEvent){this._targets={};this._targets[b.stamp(this._container)]=this;a=a?"off":"on";b.DomEvent[a](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this);if(this.options.trackResize)b.DomEvent[a](e,"resize",this._onResize,this);if(b.Browser.any3d&&this.options.transform3DLimit)this[a]("moveend",this._onMoveEnd)}},_onResize:function(){b.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=b.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,d){for(var c=[],f,m="mouseout"===d||"mouseover"===d,h=a.target||a.srcElement,e=!1;h;){if((f=this._targets[b.stamp(h)])&&("click"===d||"preclick"===d)&&!a._simulated&&this._draggableMoved(f)){e=!0;break}if(f&&f.listens(d,!0)){if(m&&!b.DomEvent._isExternalTarget(h,a))break;c.push(f);if(m)break}if(h===this._container)break;h=h.parentNode}c.length||e||m||!b.DomEvent._isExternalTarget(h,a)||(c=[this]);return c},_handleDOMEvent:function(a){if(this._loaded&&!b.DomEvent._skipped(a)){var d="keypress"===a.type&&13===a.keyCode?"click":a.type;"mousedown"===d&&b.DomUtil.preventOutline(a.target||a.srcElement);this._fireDOMEvent(a,d)}},_fireDOMEvent:function(a,d,c){if("click"===a.type){var g=b.Util.extend({},a);g.type="preclick";this._fireDOMEvent(g,g.type,c)}if(!a._stopped&&(c=(c||[]).concat(this._findEventTargets(a,d)),c.length)){var m=c[0];"contextmenu"===d&&m.listens(d,!0)&&b.DomEvent.preventDefault(a);g={originalEvent:a};if("keypress"!==a.type){var h=m instanceof b.Marker;g.containerPoint=h?this.latLngToContainerPoint(m.getLatLng()):this.mouseEventToContainerPoint(a);g.layerPoint=this.containerPointToLayerPoint(g.containerPoint);g.latlng=h?m.getLatLng():this.layerPointToLatLng(g.layerPoint)}for(a=0;a<c.length&&!(c[a].fire(d,g,!0),g.originalEvent._stopped||c[a].options.nonBubblingEvents&&-1!==b.Util.indexOf(c[a].options.nonBubblingEvents,d));a++);}},_draggableMoved:function(a){a=a.dragging&&a.dragging.enabled()?a:this;return a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,b=this._handlers.length;a<b;a++)this._handlers[a].disable()},whenReady:function(a,b){if(this._loaded)a.call(b||this,{target:this});else this.on("load",a,b);return this},_getMapPanePos:function(){return b.DomUtil.getPosition(this._mapPane)||new b.Point(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,b){return(a&&b!==l?this._getNewPixelOrigin(a,b):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,b){var d=this.getSize()._divideBy(2);return this.project(a,b)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,b,c){c=this._getNewPixelOrigin(c,b);return this.project(a,b)._subtract(c)},_latLngBoundsToNewLayerBounds:function(a,d,c){c=this._getNewPixelOrigin(c,d);return b.bounds([this.project(a.getSouthWest(),d)._subtract(c),this.project(a.getNorthWest(),d)._subtract(c),this.project(a.getSouthEast(),d)._subtract(c),this.project(a.getNorthEast(),d)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,d,c){if(!c)return a;var g=this.project(a,d),m=this.getSize().divideBy(2),m=new b.Bounds(g.subtract(m),g.add(m));c=this._getBoundsOffset(m,c,d);return c.round().equals([0,0])?a:this.unproject(g.add(c),d)},_limitOffset:function(a,d){if(!d)return a;var c=this.getPixelBounds(),c=new b.Bounds(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(c,d))},_getBoundsOffset:function(a,d,c){c=b.bounds(this.project(d.getNorthEast(),c),this.project(d.getSouthWest(),c));d=c.min.subtract(a.min);c=c.max.subtract(a.max);a=this._rebound(d.x,-c.x);d=this._rebound(d.y,-c.y);return new b.Point(a,d)},_rebound:function(a,b){return 0<a+b?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var d=this.getMinZoom(),c=this.getMaxZoom(),f=b.Browser.any3d?this.options.zoomSnap:1;f&&(a=Math.round(a/f)*f);return Math.max(d,Math.min(c,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){b.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,b){var d=this._getCenterOffset(a)._floor();if(!0!==(b&&b.animate)&&!this.getSize().contains(d))return!1;this.panBy(d,b);return!0},_createAnimProxy:function(){var a=this._proxy=b.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a);this.on("zoomanim",function(d){var c=b.DomUtil.TRANSFORM,f=a.style[c];b.DomUtil.setTransform(a,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1));f===a.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var d=this.getCenter(),c=this.getZoom();b.DomUtil.setTransform(a,this.project(d,c),this.getZoomScale(c,1))},this)},_catchTransitionEnd:function(a){this._animatingZoom&&0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,d,c){if(this._animatingZoom)return!0;c=c||{};if(!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(d),g=this._getCenterOffset(a)._divideBy(1-1/g);if(!0!==c.animate&&!this.getSize().contains(g))return!1;b.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(a,d,!0)},this);return!0},_animateZoom:function(a,d,c,f){c&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=d,b.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"));this.fire("zoomanim",{center:a,zoom:d,noUpdate:f});setTimeout(b.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(b.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),b.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}});b.map=function(a,d){return new b.Map(a,d)};b.Layer=b.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(a){a.addLayer(this);return this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){a&&a.removeLayer(this);return this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){this._map._targets[b.stamp(a)]=this;return this},removeInteractiveTarget:function(a){delete this._map._targets[b.stamp(a)];return this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var b=a.target;if(b.hasLayer(this)){this._map=b;this._zoomAnimated=b._zoomAnimated;if(this.getEvents){var c=this.getEvents();b.on(c,this);this.once("remove",function(){b.off(c,this)},this)}this.onAdd(b);this.getAttribution&&b.attributionControl&&b.attributionControl.addAttribution(this.getAttribution());this.fire("add");b.fire("layeradd",{layer:this})}}});b.Map.include({addLayer:function(a){var c=b.stamp(a);if(this._layers[c])return this;this._layers[c]=a;a._mapToAdd=this;a.beforeAdd&&a.beforeAdd(this);this.whenReady(a._layerAdd,a);return this},removeLayer:function(a){var c=b.stamp(a);if(!this._layers[c])return this;if(this._loaded)a.onRemove(this);a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution());delete this._layers[c];this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove"));a._map=a._mapToAdd=null;return this},hasLayer:function(a){return!!a&&b.stamp(a)in this._layers},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},_addLayers:function(a){a=a?b.Util.isArray(a)?a:[a]:[];for(var c=0,g=a.length;c<g;c++)this.addLayer(a[c])},_addZoomLimit:function(a){if(isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))this._zoomBoundLayers[b.stamp(a)]=a,this._updateZoomLevels()},_removeZoomLimit:function(a){a=b.stamp(a);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var a=Infinity,b=-Infinity,c=this._getZoomSpan(),f;for(f in this._zoomBoundLayers)var m=this._zoomBoundLayers[f].options,a=m.minZoom===l?a:Math.min(a,m.minZoom),b=m.maxZoom===l?b:Math.max(b,m.maxZoom);this._layersMaxZoom=-Infinity===b?l:b;this._layersMinZoom=Infinity===a?l:a;c!==this._getZoomSpan()&&this.fire("zoomlevelschange");this.options.maxZoom===l&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom);this.options.minZoom===l&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});b.DomEvent={on:function(a,c,g,f){if("object"===typeof c)for(var d in c)this._on(a,d,c[d],g);else{c=b.Util.splitWords(c);d=0;for(var h=c.length;d<h;d++)this._on(a,c[d],g,f)}return this},off:function(a,c,g,f){if("object"===typeof c)for(var d in c)this._off(a,d,c[d],g);else{c=b.Util.splitWords(c);d=0;for(var h=c.length;d<h;d++)this._off(a,c[d],g,f)}return this},_on:function(a,c,g,f){var d=c+b.stamp(g)+(f?"_"+b.stamp(f):"");if(a._leaflet_events&&a._leaflet_events[d])return this;var h=function(b){return g.call(f||a,b||e.event)},k=h;b.Browser.pointer&&0===c.indexOf("touch")?this.addPointerListener(a,c,h,d):!b.Browser.touch||"dblclick"!==c||!this.addDoubleTapListener||b.Browser.pointer&&b.Browser.chrome?"addEventListener"in a?"mousewheel"===c?a.addEventListener("onwheel"in a?"wheel":"mousewheel",h,!1):"mouseenter"===c||"mouseleave"===c?(h=function(c){c=c||e.event;b.DomEvent._isExternalTarget(a,c)&&k(c)},a.addEventListener("mouseenter"===c?"mouseover":"mouseout",h,!1)):("click"===c&&b.Browser.android&&(h=function(a){return b.DomEvent._filterClick(a,k)}),a.addEventListener(c,h,!1)):"attachEvent"in a&&a.attachEvent("on"+c,h):this.addDoubleTapListener(a,h,d);a._leaflet_events=a._leaflet_events||{};a._leaflet_events[d]=h;return this},_off:function(a,c,g,f){g=c+b.stamp(g)+(f?"_"+b.stamp(f):"");f=a._leaflet_events&&a._leaflet_events[g];if(!f)return this;b.Browser.pointer&&0===c.indexOf("touch")?this.removePointerListener(a,c,g):b.Browser.touch&&"dblclick"===c&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,g):"removeEventListener"in a?"mousewheel"===c?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",f,!1):a.removeEventListener("mouseenter"===c?"mouseover":"mouseleave"===c?"mouseout":c,f,!1):"detachEvent"in a&&a.detachEvent("on"+c,f);a._leaflet_events[g]=null;return this},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0;b.DomEvent._skipped(a);return this},disableScrollPropagation:function(a){return b.DomEvent.on(a,"mousewheel",b.DomEvent.stopPropagation)},disableClickPropagation:function(a){var c=b.DomEvent.stopPropagation;b.DomEvent.on(a,b.Draggable.START.join(" "),c);return b.DomEvent.on(a,{click:b.DomEvent._fakeStop,dblclick:c})},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return this},stop:function(a){return b.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,c){if(!c)return new b.Point(a.clientX,a.clientY);var d=c.getBoundingClientRect();return new b.Point(a.clientX-d.left-c.clientLeft,a.clientY-d.top-c.clientTop)},_wheelPxFactor:b.Browser.win&&b.Browser.chrome?2:b.Browser.gecko?e.devicePixelRatio:1,getWheelDelta:function(a){return b.Browser.edge?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/b.DomEvent._wheelPxFactor:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&32765>Math.abs(a.detail)?20*-a.detail:a.detail?a.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(a){b.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];this._skipEvents[a.type]=!1;return b},_isExternalTarget:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(f){return!1}return c!==a},_filterClick:function(a,c){var d=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,f=b.DomEvent._lastClick&&d-b.DomEvent._lastClick;f&&100<f&&500>f||a.target._simulatedClick&&!a._simulated?b.DomEvent.stop(a):(b.DomEvent._lastClick=d,c(a))}};b.DomEvent.addListener=b.DomEvent.on;b.DomEvent.removeListener=b.DomEvent.off;b.PosAnimation=b.Evented.extend({run:function(a,c,g,f){this.stop();this._el=a;this._inProgress=!0;this._duration=g||.25;this._easeOutPower=1/Math.max(f||.5,.2);this._startPos=b.DomUtil.getPosition(a);this._offset=c.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=b.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(a){var b=+new Date-this._startTime,c=1E3*this._duration;b<c?this._runFrame(this._easeOut(b/c),a):(this._runFrame(1),this._complete())},_runFrame:function(a,c){var d=this._startPos.add(this._offset.multiplyBy(a));c&&d._round();b.DomUtil.setPosition(this._el,d);this.fire("step")},_complete:function(){b.Util.cancelAnimFrame(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});b.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:b.bounds([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),project:function(a){var c=Math.PI/180,g=this.R,f=a.lat*c,m=this.R_MINOR/g,m=Math.sqrt(1-m*m),h=m*Math.sin(f),f=-g*Math.log(Math.max(Math.tan(Math.PI/4-f/2)/Math.pow((1-h)/(1+h),m/2),1E-10));return new b.Point(a.lng*c*g,f)},unproject:function(a){for(var c=180/Math.PI,g=this.R,f=this.R_MINOR/g,f=Math.sqrt(1-f*f),m=Math.exp(-a.y/g),h=Math.PI/2-2*Math.atan(m),e=0,k=.1;15>e&&1E-7<Math.abs(k);e++)k=f*Math.sin(h),k=Math.pow((1-k)/(1+k),f/2),k=Math.PI/2-2*Math.atan(m*k)-h,h+=k;return new b.LatLng(h*c,a.x*c/g)}};b.CRS.EPSG3395=b.extend({},b.CRS.Earth,{code:"EPSG:3395",projection:b.Projection.Mercator,transformation:function(){var a=.5/(Math.PI*b.Projection.Mercator.R);return new b.Transformation(a,.5,-a,.5)}()});b.GridLayer=b.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:b.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:l,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){b.setOptions(this,a)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles();b.DomUtil.remove(this._container);a._removeZoomLimit(this);this._tileZoom=this._container=null},bringToFront:function(){this._map&&(b.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max));return this},bringToBack:function(){this._map&&(b.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min));return this},getContainer:function(){return this._container},setOpacity:function(a){this.options.opacity=a;this._updateOpacity();return this},setZIndex:function(a){this.options.zIndex=a;this._updateZIndex();return this},isLoading:function(){return this._loading},redraw:function(){this._map&&(this._removeAllTiles(),this._update());return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};this.options.updateWhenIdle||(this._onMove||(this._onMove=b.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove);this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},createTile:function(){return k.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof b.Point?a:new b.Point(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==l&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var b=this.getPane().children,c=-a(-Infinity,Infinity),f=0,m=b.length,h;f<m;f++)h=b[f].style.zIndex,b[f]!==this._container&&h&&(c=a(c,+h));isFinite(c)&&(this.options.zIndex=c+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!b.Browser.ielt9){b.DomUtil.setOpacity(this._container,this.options.opacity);var a=+new Date,c=!1,g=!1,f;for(f in this._tiles){var m=this._tiles[f];if(m.current&&m.loaded){var h=Math.min(1,(a-m.loaded)/200);b.DomUtil.setOpacity(m.el,h);1>h?c=!0:(m.active&&(g=!0),m.active=!0)}}g&&!this._noPrune&&this._pruneTiles();c&&(b.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=b.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=b.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,c=this.options.maxZoom;if(a===l)return l;for(var g in this._levels)this._levels[g].el.children.length||g===a?this._levels[g].el.style.zIndex=c-Math.abs(a-g):(b.DomUtil.remove(this._levels[g].el),this._removeTilesAtZoom(g),delete this._levels[g]);g=this._levels[a];var f=this._map;g||(g=this._levels[a]={},g.el=b.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=c,g.origin=f.project(f.unproject(f.getPixelOrigin()),a).round(),g.zoom=a,this._setZoomTransform(g,f.getCenter(),f.getZoom()),b.Util.falseFn(g.el.offsetWidth));return this._level=g},_pruneTiles:function(){if(this._map){var a,b;b=this._map.getZoom();if(b>this.options.maxZoom||b<this.options.minZoom)this._removeAllTiles();else{for(a in this._tiles)b=this._tiles[a],b.retain=b.current;for(a in this._tiles)b=this._tiles[a],b.current&&!b.active&&(b=b.coords,this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2));for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}}},_removeTilesAtZoom:function(a){for(var b in this._tiles)this._tiles[b].coords.z===a&&this._removeTile(b)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)b.DomUtil.remove(this._levels[a].el),delete this._levels[a];this._removeAllTiles();this._tileZoom=null},_retainParent:function(a,c,g,f){a=Math.floor(a/2);c=Math.floor(c/2);--g;var d=new b.Point(+a,+c);d.z=+g;d=this._tileCoordsToKey(d);if((d=this._tiles[d])&&d.active)return d.retain=!0;d&&d.loaded&&(d.retain=!0);return g>f?this._retainParent(a,c,g,f):!1},_retainChildren:function(a,c,g,f){for(var d=2*a;d<2*a+2;d++)for(var h=2*c;h<2*c+2;h++){var e=new b.Point(d,h);e.z=g+1;e=this._tileCoordsToKey(e);(e=this._tiles[e])&&e.active?e.retain=!0:(e&&e.loaded&&(e.retain=!0),g+1<f&&this._retainChildren(d,h,g+1,f))}},_resetView:function(a){a=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_setView:function(a,b,c,f){var d=Math.round(b);if(this.options.maxZoom!==l&&d>this.options.maxZoom||this.options.minZoom!==l&&d<this.options.minZoom)d=l;var g=this.options.updateWhenZooming&&d!==this._tileZoom;if(!f||g)this._tileZoom=d,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),d!==l&&this._update(a),c||this._pruneTiles(),this._noPrune=!!c;this._setZoomTransforms(a,b)},_setZoomTransforms:function(a,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],a,b)},_setZoomTransform:function(a,c,g){var d=this._map.getZoomScale(g,a.zoom);c=a.origin.multiplyBy(d).subtract(this._map._getNewPixelOrigin(c,g)).round();b.Browser.any3d?b.DomUtil.setTransform(a.el,c,d):b.DomUtil.setPosition(a.el,c)},_resetGrid:function(){var a=this._map,b=a.options.crs,c=this._tileSize=this.getTileSize(),f=this._tileZoom,h=this._map.getPixelWorldBounds(this._tileZoom);h&&(this._globalTileRange=this._pxBoundsToTileRange(h));this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,b.wrapLng[0]],f).x/c.x),Math.ceil(a.project([0,b.wrapLng[1]],f).x/c.y)];this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([b.wrapLat[0],0],f).y/c.x),Math.ceil(a.project([b.wrapLat[1],0],f).y/c.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var c=this._map,g=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),g=c.getZoomScale(g,this._tileZoom);a=c.project(a,this._tileZoom).floor();c=c.getSize().divideBy(2*g);return new b.Bounds(a.subtract(c),a.add(c))},_update:function(a){var c=this._map;if(c){var g=c.getZoom();a===l&&(a=c.getCenter());if(this._tileZoom!==l){var c=this._getTiledPixelBounds(a),f=this._pxBoundsToTileRange(c),h=f.getCenter(),c=[],e=this.options.keepBuffer,e=new b.Bounds(f.getBottomLeft().subtract([e,-e]),f.getTopRight().add([e,-e])),C;for(C in this._tiles){var v=this._tiles[C].coords;v.z===this._tileZoom&&e.contains(b.point(v.x,v.y))||(this._tiles[C].current=!1)}if(1<Math.abs(g-this._tileZoom))this._setView(a,g);else{for(g=f.min.y;g<=f.max.y;g++)for(a=f.min.x;a<=f.max.x;a++)C=new b.Point(a,g),C.z=this._tileZoom,this._isValidTile(C)&&((e=this._tiles[this._tileCoordsToKey(C)])?e.current=!0:c.push(C));c.sort(function(a,b){return a.distanceTo(h)-b.distanceTo(h)});if(0!==c.length){this._loading||(this._loading=!0,this.fire("loading"));f=k.createDocumentFragment();for(a=0;a<c.length;a++)this._addTile(c[a],f);this._level.el.appendChild(f)}}}}},_isValidTile:function(a){var c=this._map.options.crs;if(!c.infinite){var g=this._globalTileRange;if(!c.wrapLng&&(a.x<g.min.x||a.x>g.max.x)||!c.wrapLat&&(a.y<g.min.y||a.y>g.max.y))return!1}if(!this.options.bounds)return!0;a=this._tileCoordsToBounds(a);return b.latLngBounds(this.options.bounds).overlaps(a)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var c=this._map,g=this.getTileSize(),f=a.scaleBy(g),g=f.add(g),f=c.unproject(f,a.z);a=c.unproject(g,a.z);a=new b.LatLngBounds(f,a);this.options.noWrap||c.wrapLatLngBounds(a);return a},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){a=a.split(":");var c=new b.Point(+a[0],+a[1]);c.z=+a[2];return c},_removeTile:function(a){var c=this._tiles[a];c&&(b.DomUtil.remove(c.el),delete this._tiles[a],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){b.DomUtil.addClass(a,"leaflet-tile");var c=this.getTileSize();a.style.width=c.x+"px";a.style.height=c.y+"px";a.onselectstart=b.Util.falseFn;a.onmousemove=b.Util.falseFn;b.Browser.ielt9&&1>this.options.opacity&&b.DomUtil.setOpacity(a,this.options.opacity);b.Browser.android&&!b.Browser.android23&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,c){var d=this._getTilePos(a),f=this._tileCoordsToKey(a),h=this.createTile(this._wrapCoords(a),b.bind(this._tileReady,this,a));this._initTile(h);2>this.createTile.length&&b.Util.requestAnimFrame(b.bind(this._tileReady,this,a,null,h));b.DomUtil.setPosition(h,d);this._tiles[f]={el:h,coords:a,current:!0};c.appendChild(h);this.fire("tileloadstart",{tile:h,coords:a})},_tileReady:function(a,c,g){this._map&&(c&&this.fire("tileerror",{error:c,tile:g,coords:a}),g=this._tileCoordsToKey(a),g=this._tiles[g])&&(g.loaded=+new Date,this._map._fadeAnimated?(b.DomUtil.setOpacity(g.el,0),b.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=b.Util.requestAnimFrame(this._updateOpacity,this)):(g.active=!0,this._pruneTiles()),c||(b.DomUtil.addClass(g.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:g.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),b.Browser.ielt9||!this._map._fadeAnimated?b.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(b.bind(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var c=new b.Point(this._wrapX?b.Util.wrapNum(a.x,this._wrapX):a.x,this._wrapY?b.Util.wrapNum(a.y,this._wrapY):a.y);c.z=a.z;return c},_pxBoundsToTileRange:function(a){var c=this.getTileSize();return new b.Bounds(a.min.unscaleBy(c).floor(),a.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});b.gridLayer=function(a){return new b.GridLayer(a)};b.TileLayer=b.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,c){this._url=a;c=b.setOptions(this,c);c.detectRetina&&b.Browser.retina&&0<c.maxZoom&&(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom++):(c.zoomOffset++,c.maxZoom--),c.minZoom=Math.max(0,c.minZoom));"string"===typeof c.subdomains&&(c.subdomains=c.subdomains.split(""));if(!b.Browser.android)this.on("tileunload",this._onTileRemove)},setUrl:function(a,b){this._url=a;b||this.redraw();return this},createTile:function(a,c){var d=k.createElement("img");b.DomEvent.on(d,"load",b.bind(this._tileOnLoad,this,c,d));b.DomEvent.on(d,"error",b.bind(this._tileOnError,this,c,d));this.options.crossOrigin&&(d.crossOrigin="");d.alt="";d.setAttribute("role","presentation");d.src=this.getTileUrl(a);return d},getTileUrl:function(a){var c={r:b.Browser.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(c.y=a),c["-y"]=a);return b.Util.template(this._url,b.extend(c,this.options))},_tileOnLoad:function(a,c){b.Browser.ielt9?setTimeout(b.bind(a,this,null,c),0):a(null,c)},_tileOnError:function(a,b,c){var d=this.options.errorTileUrl;d&&b.src!==d&&(b.src=d);a(c,b)},getTileSize:function(){var a=this._map,c=b.GridLayer.prototype.getTileSize.call(this),g=this._tileZoom+this.options.zoomOffset,f=this.options.minNativeZoom,h=this.options.maxNativeZoom;return null!==f&&g<f?c.divideBy(a.getZoomScale(f,g)).round():null!==h&&g>h?c.divideBy(a.getZoomScale(h,g)).round():c},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,b=this.options.maxZoom,c=this.options.zoomOffset,f=this.options.minNativeZoom,h=this.options.maxNativeZoom;this.options.zoomReverse&&(a=b-a);a+=c;return null!==f&&a<f?f:null!==h&&a>h?h:a},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_abortLoading:function(){var a,c;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(c=this._tiles[a].el,c.onload=b.Util.falseFn,c.onerror=b.Util.falseFn,c.complete||(c.src=b.Util.emptyImageUrl,b.DomUtil.remove(c)))}});b.tileLayer=function(a,c){return new b.TileLayer(a,c)};b.TileLayer.WMS=b.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,c){this._url=a;var d=b.extend({},this.defaultWmsParams),f;for(f in c)f in this.options||(d[f]=c[f]);c=b.setOptions(this,c);d.width=d.height=c.tileSize*(c.detectRetina&&b.Browser.retina?2:1);this.wmsParams=d},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;b.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var c=this._tileCoordsToBounds(a),g=this._crs.project(c.getNorthWest()),c=this._crs.project(c.getSouthEast()),g=(1.3<=this._wmsVersion&&this._crs===b.CRS.EPSG4326?[c.y,g.x,g.y,c.x]:[g.x,c.y,c.x,g.y]).join(",");a=b.TileLayer.prototype.getTileUrl.call(this,a);return a+b.Util.getParamString(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"\x26BBOX\x3d":"\x26bbox\x3d")+g},setParams:function(a,c){b.extend(this.wmsParams,a);c||this.redraw();return this}});b.tileLayer.wms=function(a,c){return new b.TileLayer.WMS(a,c)};b.ImageOverlay=b.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(a,c,g){this._url=a;this._bounds=b.latLngBounds(c);b.setOptions(this,g)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(b.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image));this.getPane().appendChild(this._image);this._reset()},onRemove:function(){b.DomUtil.remove(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){this.options.opacity=a;this._image&&this._updateOpacity();return this},setStyle:function(a){a.opacity&&this.setOpacity(a.opacity);return this},bringToFront:function(){this._map&&b.DomUtil.toFront(this._image);return this},bringToBack:function(){this._map&&b.DomUtil.toBack(this._image);return this},setUrl:function(a){this._url=a;this._image&&(this._image.src=a);return this},setBounds:function(a){this._bounds=a;this._map&&this._reset();return this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._image=b.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));a.onselectstart=b.Util.falseFn;a.onmousemove=b.Util.falseFn;a.onload=b.bind(this.fire,this,"load");this.options.crossOrigin&&(a.crossOrigin="");a.src=this._url;a.alt=this.options.alt},_animateZoom:function(a){var c=this._map.getZoomScale(a.zoom);a=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;b.DomUtil.setTransform(this._image,a,c)},_reset:function(){var a=this._image,c=new b.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),g=c.getSize();b.DomUtil.setPosition(a,c.min);a.style.width=g.x+"px";a.style.height=g.y+"px"},_updateOpacity:function(){b.DomUtil.setOpacity(this._image,this.options.opacity)}});b.imageOverlay=function(a,c,g){return new b.ImageOverlay(a,c,g)};b.Icon=b.Class.extend({initialize:function(a){b.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);if(!c){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}c=this._createImg(c,b&&"IMG"===b.tagName?b:null);this._setIconStyles(c,a);return c},_setIconStyles:function(a,c){var d=this.options,f=d[c+"Size"];"number"===typeof f&&(f=[f,f]);var f=b.point(f),h=b.point("shadow"===c&&d.shadowAnchor||d.iconAnchor||f&&f.divideBy(2,!0));a.className="leaflet-marker-"+c+" "+(d.className||"");h&&(a.style.marginLeft=-h.x+"px",a.style.marginTop=-h.y+"px");f&&(a.style.width=f.x+"px",a.style.height=f.y+"px")},_createImg:function(a,b){b=b||k.createElement("img");b.src=a;return b},_getIconUrl:function(a){return b.Browser.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});b.icon=function(a){return new b.Icon(a)};b.Icon.Default=b.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){b.Icon.Default.imagePath||(b.Icon.Default.imagePath=this._detectIconPath());return(this.options.imagePath||b.Icon.Default.imagePath)+b.Icon.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=b.DomUtil.create("div","leaflet-default-icon-path",k.body),c=b.DomUtil.getStyle(a,"background-image")||b.DomUtil.getStyle(a,"backgroundImage");k.body.removeChild(a);return 0===c.indexOf("url")?c.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}});b.Marker=b.Layer.extend({options:{icon:new b.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(a,c){b.setOptions(this,c);this._latlng=b.latLng(a)},onAdd:function(a){if(this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation)a.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var c=this._latlng;this._latlng=b.latLng(a);this.update();return this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(a){this.options.zIndexOffset=a;return this.update()},setIcon:function(a){this.options.icon=a;this._map&&(this._initIcon(),this.update());this._popup&&this.bindPopup(this._popup,this._popup.options);return this},getElement:function(){return this._icon},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),g=a.icon.createIcon(this._icon),f=!1;g!==this._icon&&(this._icon&&this._removeIcon(),f=!0,a.title&&(g.title=a.title),a.alt&&(g.alt=a.alt));b.DomUtil.addClass(g,c);a.keyboard&&(g.tabIndex="0");this._icon=g;if(a.riseOnHover)this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var g=a.icon.createShadow(this._shadow),h=!1;g!==this._shadow&&(this._removeShadow(),h=!0);g&&(b.DomUtil.addClass(g,c),g.alt="");this._shadow=g;1>a.opacity&&this._updateOpacity();f&&this.getPane().appendChild(this._icon);this._initInteraction();g&&h&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});b.DomUtil.remove(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&b.DomUtil.remove(this._shadow);this._shadow=null},_setPos:function(a){b.DomUtil.setPosition(this._icon,a);this._shadow&&b.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(b.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),b.Handler.MarkerDrag)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable());this.dragging=new b.Handler.MarkerDrag(this);a&&this.dragging.enable()}},setOpacity:function(a){this.options.opacity=a;this._map&&this._updateOpacity();return this},_updateOpacity:function(){var a=this.options.opacity;b.DomUtil.setOpacity(this._icon,a);this._shadow&&b.DomUtil.setOpacity(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}});b.marker=function(a,c){return new b.Marker(a,c)};b.DivIcon=b.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){a=a&&"DIV"===a.tagName?a:k.createElement("div");var c=this.options;a.innerHTML=!1!==c.html?c.html:"";c.bgPos&&(c=b.point(c.bgPos),a.style.backgroundPosition=-c.x+"px "+-c.y+"px");this._setIconStyles(a,"icon");return a},createShadow:function(){return null}});b.divIcon=function(a){return new b.DivIcon(a)};b.DivOverlay=b.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,c){b.setOptions(this,a);this._source=c},onAdd:function(a){this._zoomAnimated=a._zoomAnimated;this._container||this._initLayout();a._fadeAnimated&&b.DomUtil.setOpacity(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();a._fadeAnimated&&b.DomUtil.setOpacity(this._container,1);this.bringToFront()},onRemove:function(a){a._fadeAnimated?(b.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(b.bind(b.DomUtil.remove,b.DomUtil,this._container),200)):b.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=b.latLng(a);this._map&&(this._updatePosition(),this._adjustPan());return this},getContent:function(){return this._content},setContent:function(a){this._content=a;this.update();return this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){this._map&&b.DomUtil.toFront(this._container);return this},bringToBack:function(){this._map&&b.DomUtil.toBack(this._container);return this},_updateContent:function(){if(this._content){var a=this._contentNode,b="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof b)a.innerHTML=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),c=b.point(this.options.offset),g=this._getAnchor();this._zoomAnimated?b.DomUtil.setPosition(this._container,a.add(g)):c=c.add(a).add(g);a=this._containerBottom=-c.y;c=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=a+"px";this._container.style.left=c+"px"}},_getAnchor:function(){return[0,0]}});b.Popup=b.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){a.openPopup(this);return this},onAdd:function(a){b.DivOverlay.prototype.onAdd.call(this,a);a.fire("popupopen",{popup:this});if(this._source&&(this._source.fire("popupopen",{popup:this},!0),!(this._source instanceof b.Path)))this._source.on("preclick",b.DomEvent.stopPropagation)},onRemove:function(a){b.DivOverlay.prototype.onRemove.call(this,a);a.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof b.Path||this._source.off("preclick",b.DomEvent.stopPropagation))},getEvents:function(){var a=b.DivOverlay.prototype.getEvents.call(this);if("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)a.preclick=this._close;this.options.keepInView&&(a.moveend=this._adjustPan);return a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a=this._container=b.DomUtil.create("div","leaflet-popup "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var c=this._closeButton=b.DomUtil.create("a","leaflet-popup-close-button",a);c.href="#close";c.innerHTML="\x26#215;";b.DomEvent.on(c,"click",this._onCloseButtonClick,this)}c=this._wrapper=b.DomUtil.create("div","leaflet-popup-content-wrapper",a);this._contentNode=b.DomUtil.create("div","leaflet-popup-content",c);b.DomEvent.disableClickPropagation(c).disableScrollPropagation(this._contentNode).on(c,"contextmenu",b.DomEvent.stopPropagation);this._tipContainer=b.DomUtil.create("div","leaflet-popup-tip-container",a);this._tip=b.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_updateLayout:function(){var a=this._contentNode,c=a.style;c.width="";c.whiteSpace="nowrap";var g=a.offsetWidth,g=Math.min(g,this.options.maxWidth),g=Math.max(g,this.options.minWidth);c.width=g+1+"px";c.whiteSpace="";c.height="";var g=a.offsetHeight,f=this.options.maxHeight;f&&g>f?(c.height=f+"px",b.DomUtil.addClass(a,"leaflet-popup-scrolled")):b.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);var c=this._getAnchor();b.DomUtil.setPosition(this._container,a.add(c))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,c=parseInt(b.DomUtil.getStyle(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+c,g=this._containerWidth,f=new b.Point(this._containerLeft,-c-this._containerBottom);f._add(b.DomUtil.getPosition(this._container));var f=a.layerPointToContainerPoint(f),h=b.point(this.options.autoPanPadding),e=b.point(this.options.autoPanPaddingTopLeft||h),h=b.point(this.options.autoPanPaddingBottomRight||h),k=a.getSize(),l=0,q=0;f.x+g+h.x>k.x&&(l=f.x+g-k.x+h.x);0>f.x-l-e.x&&(l=f.x-e.x);f.y+c+h.y>k.y&&(q=f.y+c-k.y+h.y);0>f.y-q-e.y&&(q=f.y-e.y);(l||q)&&a.fire("autopanstart").panBy([l,q])}},_onCloseButtonClick:function(a){this._close();b.DomEvent.stop(a)},_getAnchor:function(){return b.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});b.popup=function(a,c){return new b.Popup(a,c)};b.Map.mergeOptions({closePopupOnClick:!0});b.Map.include({openPopup:function(a,c,g){a instanceof b.Popup||(a=(new b.Popup(g)).setContent(a));c&&a.setLatLng(c);if(this.hasLayer(a))return this;this._popup&&this._popup.options.autoClose&&this.closePopup();this._popup=a;return this.addLayer(a)},closePopup:function(a){a&&a!==this._popup||(a=this._popup,this._popup=null);a&&this.removeLayer(a);return this}});b.Layer.include({bindPopup:function(a,c){if(a instanceof b.Popup)b.setOptions(a,c),this._popup=a,a._source=this;else{if(!this._popup||c)this._popup=new b.Popup(c,this);this._popup.setContent(a)}this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0);return this},unbindPopup:function(){this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null);return this},openPopup:function(a,c){a instanceof b.Layer||(c=a,a=this);if(a instanceof b.FeatureGroup)for(var d in this._layers){a=this._layers[d];break}c||(c=a.getCenter?a.getCenter():a.getLatLng());this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,c));return this},closePopup:function(){this._popup&&this._popup._close();return this},togglePopup:function(a){this._popup&&(this._popup._map?this.closePopup():this.openPopup(a));return this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){this._popup&&this._popup.setContent(a);return this},getPopup:function(){return this._popup},_openPopup:function(a){var c=a.layer||a.target;this._popup&&this._map&&(b.DomEvent.stop(a),c instanceof b.Path?this.openPopup(a.layer||a.target,a.latlng):this._map.hasLayer(this._popup)&&this._popup._source===c?this.closePopup():this.openPopup(c,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});b.Tooltip=b.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){b.DivOverlay.prototype.onAdd.call(this,a);this.setOpacity(this.options.opacity);a.fire("tooltipopen",{tooltip:this});this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){b.DivOverlay.prototype.onRemove.call(this,a);a.fire("tooltipclose",{tooltip:this});this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=b.DivOverlay.prototype.getEvents.call(this);b.Browser.touch&&!this.options.permanent&&(a.preclick=this._close);return a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=b.DomUtil.create("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var c=this._map,g=this._container,f=c.latLngToContainerPoint(c.getCenter()),c=c.layerPointToContainerPoint(a),h=this.options.direction,e=g.offsetWidth,k=g.offsetHeight,l=b.point(this.options.offset),q=this._getAnchor();"top"===h?a=a.add(b.point(-e/2+l.x,-k+l.y+q.y,!0)):"bottom"===h?a=a.subtract(b.point(e/2-l.x,-l.y,!0)):"center"===h?a=a.subtract(b.point(e/2+l.x,k/2-q.y+l.y,!0)):"right"===h||"auto"===h&&c.x<f.x?(h="right",a=a.add(b.point(l.x+q.x,q.y-k/2+l.y,!0))):(h="left",a=a.subtract(b.point(e+q.x-l.x,k/2-q.y-l.y,!0)));b.DomUtil.removeClass(g,"leaflet-tooltip-right");b.DomUtil.removeClass(g,"leaflet-tooltip-left");b.DomUtil.removeClass(g,"leaflet-tooltip-top");b.DomUtil.removeClass(g,"leaflet-tooltip-bottom");b.DomUtil.addClass(g,"leaflet-tooltip-"+h);b.DomUtil.setPosition(g,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a;this._container&&b.DomUtil.setOpacity(this._container,a)},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(a)},_getAnchor:function(){return b.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});b.tooltip=function(a,c){return new b.Tooltip(a,c)};b.Map.include({openTooltip:function(a,c,g){a instanceof b.Tooltip||(a=(new b.Tooltip(g)).setContent(a));c&&a.setLatLng(c);return this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){a&&this.removeLayer(a);return this}});b.Layer.include({bindTooltip:function(a,c){if(a instanceof b.Tooltip)b.setOptions(a,c),this._tooltip=a,a._source=this;else{if(!this._tooltip||c)this._tooltip=b.tooltip(c,this);this._tooltip.setContent(a)}this._initTooltipInteractions();this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip();return this},unbindTooltip:function(){this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null);return this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),b.Browser.touch&&(c.click=this._openTooltip));this[a?"off":"on"](c);this._tooltipHandlersAdded=!a}},openTooltip:function(a,c){a instanceof b.Layer||(c=a,a=this);if(a instanceof b.FeatureGroup)for(var d in this._layers){a=this._layers[d];break}c||(c=a.getCenter?a.getCenter():a.getLatLng());this._tooltip&&this._map&&(this._tooltip._source=a,this._tooltip.update(),this._map.openTooltip(this._tooltip,c),this._tooltip.options.interactive&&this._tooltip._container&&(b.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container)));return this},closeTooltip:function(){this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(b.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container)));return this},toggleTooltip:function(a){this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a));return this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){this._tooltip&&this._tooltip.setContent(a);return this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){this._tooltip&&this._map&&this.openTooltip(a.layer||a.target,this._tooltip.options.sticky?a.latlng:l)},_moveTooltip:function(a){var b=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(a=this._map.mouseEventToContainerPoint(a.originalEvent),a=this._map.containerPointToLayerPoint(a),b=this._map.layerPointToLatLng(a));this._tooltip.setLatLng(b)}});b.LayerGroup=b.Layer.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;b<c;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);this._layers[b]=a;this._map&&this._map.addLayer(a);return this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]);delete this._layers[a];return this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var b=Array.prototype.slice.call(arguments,1),c,f;for(c in this._layers)f=this._layers[c],f[a]&&f[a].apply(f,b);return this},onAdd:function(a){for(var b in this._layers)a.addLayer(this._layers[b])},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b])},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],b;for(b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return b.stamp(a)}});b.layerGroup=function(a){return new b.LayerGroup(a)};b.FeatureGroup=b.LayerGroup.extend({addLayer:function(a){if(this.hasLayer(a))return this;a.addEventParent(this);b.LayerGroup.prototype.addLayer.call(this,a);return this.fire("layeradd",{layer:a})},removeLayer:function(a){if(!this.hasLayer(a))return this;a in this._layers&&(a=this._layers[a]);a.removeEventParent(this);b.LayerGroup.prototype.removeLayer.call(this,a);return this.fire("layerremove",{layer:a})},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new b.LatLngBounds,c;for(c in this._layers){var g=this._layers[c];a.extend(g.getBounds?g.getBounds():g.getLatLng())}return a}});b.featureGroup=function(a){return new b.FeatureGroup(a)};b.Renderer=b.Layer.extend({options:{padding:.1},initialize:function(a){b.setOptions(this,a);b.stamp(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&b.DomUtil.addClass(this._container,"leaflet-zoom-animated"));this.getPane().appendChild(this._container);this._update();this.on("update",this._updatePaths,this)},onRemove:function(){b.DomUtil.remove(this._container);this.off("update",this._updatePaths,this)},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};this._zoomAnimated&&(a.zoomanim=this._onAnimZoom);return a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,c){var d=this._map.getZoomScale(c,this._zoom),f=b.DomUtil.getPosition(this._container),h=this._map.getSize().multiplyBy(.5+this.options.padding),e=this._map.project(this._center,c),e=this._map.project(a,c).subtract(e),f=h.multiplyBy(-d).add(f).add(h).subtract(e);b.Browser.any3d?b.DomUtil.setTransform(this._container,f,d):b.DomUtil.setPosition(this._container,f)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,c=this._map.getSize(),g=this._map.containerPointToLayerPoint(c.multiplyBy(-a)).round();this._bounds=new b.Bounds(g,g.add(c.multiplyBy(1+2*a)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom()}});b.Map.include({getRenderer:function(a){a=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;a||(a=this._renderer=this.options.preferCanvas&&b.canvas()||b.svg());this.hasLayer(a)||this.addLayer(a);return a},_getPaneRenderer:function(a){if("overlayPane"===a||a===l)return!1;var c=this._paneRenderers[a];c===l&&(c=b.SVG&&b.svg({pane:a})||b.Canvas&&b.canvas({pane:a}),this._paneRenderers[a]=c);return c}});b.Path=b.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){this._map&&this._renderer._updatePath(this);return this},setStyle:function(a){b.setOptions(this,a);this._renderer&&this._renderer._updateStyle(this);return this},bringToFront:function(){this._renderer&&this._renderer._bringToFront(this);return this},bringToBack:function(){this._renderer&&this._renderer._bringToBack(this);return this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(b.Browser.touch?10:0)}});b.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=b*b;a=this._reducePoints(a,c);return a=this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var c=a.length,d=new (typeof Uint8Array!==l+""?Uint8Array:Array)(c);d[0]=d[c-1]=1;this._simplifyDPStep(a,d,b,0,c-1);var h,e=[];for(h=0;h<c;h++)d[h]&&e.push(a[h]);return e},_simplifyDPStep:function(a,b,c,f,h){var d=0,g,m,e;for(m=f+1;m<=h-1;m++)e=this._sqClosestPointOnSegment(a[m],a[f],a[h],!0),e>d&&(g=m,d=e);d>c&&(b[g]=1,this._simplifyDPStep(a,b,c,f,g),this._simplifyDPStep(a,b,c,g,h))},_reducePoints:function(a,b){for(var c=[a[0]],d=1,h=0,e=a.length;d<e;d++)this._sqDist(a[d],a[h])>b&&(c.push(a[d]),h=d);h<e-1&&c.push(a[e-1]);return c},clipSegment:function(a,b,c,f,h){f=f?this._lastCode:this._getBitCode(a,c);var d=this._getBitCode(b,c),g,m,e;for(this._lastCode=d;;){if(!(f|d))return[a,b];if(f&d)return!1;g=f||d;m=this._getEdgeIntersection(a,b,g,c,h);e=this._getBitCode(m,c);g===f?(a=m,f=e):(b=m,d=e)}},_getEdgeIntersection:function(a,c,g,f,h){var d=c.x-a.x;c=c.y-a.y;var m=f.min;f=f.max;var e,k;g&8?(e=a.x+d*(f.y-a.y)/c,k=f.y):g&4?(e=a.x+d*(m.y-a.y)/c,k=m.y):g&2?(e=f.x,k=a.y+c*(f.x-a.x)/d):g&1&&(e=m.x,k=a.y+c*(m.x-a.x)/d);return new b.Point(e,k,h)},_getBitCode:function(a,b){var c=0;a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2);a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8);return c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqClosestPointOnSegment:function(a,c,g,f){var d=c.x;c=c.y;var h=g.x-d,e=g.y-c,k=h*h+e*e;0<k&&(k=((a.x-d)*h+(a.y-c)*e)/k,1<k?(d=g.x,c=g.y):0<k&&(d+=h*k,c+=e*k));h=a.x-d;e=a.y-c;return f?h*h+e*e:new b.Point(d,c)}};b.Polyline=b.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,c){b.setOptions(this,c);this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){this._setLatLngs(a);return this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var c=Infinity,g=null,f=b.LineUtil._sqClosestPointOnSegment,h,e,k=0,l=this._parts.length;k<l;k++)for(var q=this._parts[k],u=1,y=q.length;u<y;u++){h=q[u-1];e=q[u];var z=f(a,h,e,!0);z<c&&(c=z,g=f(a,h,e))}g&&(g.distance=Math.sqrt(c));return g},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,b,c,f,h,e,k=this._rings[0],l=k.length;if(!l)return null;for(b=a=0;a<l-1;a++)b+=k[a].distanceTo(k[a+1])/2;if(0===b)return this._map.layerPointToLatLng(k[0]);for(f=a=0;a<l-1;a++)if(h=k[a],e=k[a+1],c=h.distanceTo(e),f+=c,f>b)return a=(f-b)/c,this._map.layerPointToLatLng([e.x-a*(e.x-h.x),e.y-a*(e.y-h.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,c){c=c||this._defaultShape();a=b.latLng(a);c.push(a);this._bounds.extend(a);return this.redraw()},_setLatLngs:function(a){this._bounds=new b.LatLngBounds;this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return b.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var c=[],g=b.Polyline._flat(a),f=0,h=a.length;f<h;f++)g?(c[f]=b.latLng(a[f]),this._bounds.extend(c[f])):c[f]=this._convertLatLngs(a[f]);return c},_project:function(){var a=new b.Bounds;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,a);var c=this._clickTolerance(),c=new b.Point(c,c);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(c),a.max._add(c),this._pxBounds=a)},_projectLatlngs:function(a,c,g){var d=a.length,h,e;if(a[0]instanceof b.LatLng){e=[];for(h=0;h<d;h++)e[h]=this._map.latLngToLayerPoint(a[h]),g.extend(e[h]);c.push(e)}else for(h=0;h<d;h++)this._projectLatlngs(a[h],c,g)},_clipPoints:function(){var a=this._renderer._bounds;this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else{var c=this._parts,g,f,h,e,k,l,q;h=g=0;for(e=this._rings.length;g<e;g++)for(q=this._rings[g],f=0,k=q.length;f<k-1;f++)if(l=b.LineUtil.clipSegment(q[f],q[f+1],a,f,!0))if(c[h]=c[h]||[],c[h].push(l[0]),l[1]!==q[f+1]||f===k-2)c[h].push(l[1]),h++}},_simplifyPoints:function(){for(var a=this._parts,c=this.options.smoothFactor,g=0,f=a.length;g<f;g++)a[g]=b.LineUtil.simplify(a[g],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}});b.polyline=function(a,c){return new b.Polyline(a,c)};b.Polyline._flat=function(a){return!b.Util.isArray(a[0])||"object"!==typeof a[0][0]&&"undefined"!==typeof a[0][0]};b.PolyUtil={};b.PolyUtil.clipPolygon=function(a,c,g){var d,h=[1,4,2,8],e,k,l,q,u,y,z=b.LineUtil;e=0;for(u=a.length;e<u;e++)a[e]._code=z._getBitCode(a[e],c);for(l=0;4>l;l++){y=h[l];d=[];e=0;u=a.length;for(k=u-1;e<u;k=e++)(q=a[e],k=a[k],q._code&y)?k._code&y||(k=z._getEdgeIntersection(k,q,y,c,g),k._code=z._getBitCode(k,c),d.push(k)):(k._code&y&&(k=z._getEdgeIntersection(k,q,y,c,g),k._code=z._getBitCode(k,c),d.push(k)),d.push(q));a=d}return a};b.Polygon=b.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,b,c,f,h,e,k,l=this._rings[0],q=l.length;if(!q)return null;a=h=e=k=0;for(b=q-1;a<q;b=a++)c=l[a],b=l[b],f=c.y*b.x-b.y*c.x,e+=(c.x+b.x)*f,k+=(c.y+b.y)*f,h+=3*f;return this._map.layerPointToLatLng(0===h?l[0]:[e/h,k/h])},_convertLatLngs:function(a){a=b.Polyline.prototype._convertLatLngs.call(this,a);var c=a.length;2<=c&&a[0]instanceof b.LatLng&&a[0].equals(a[c-1])&&a.pop();return a},_setLatLngs:function(a){b.Polyline.prototype._setLatLngs.call(this,a);b.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return b.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,c=this.options.weight,c=new b.Point(c,c),a=new b.Bounds(a.min.subtract(c),a.max.add(c));this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else for(var c=0,g=this._rings.length,f;c<g;c++)f=b.PolyUtil.clipPolygon(this._rings[c],a,!0),f.length&&this._parts.push(f)},_updatePath:function(){this._renderer._updatePoly(this,!0)}});b.polygon=function(a,c){return new b.Polygon(a,c)};b.Rectangle=b.Polygon.extend({initialize:function(a,c){b.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),c)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){a=b.latLngBounds(a);return[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});b.rectangle=function(a,c){return new b.Rectangle(a,c)};b.CircleMarker=b.Path.extend({options:{fill:!0,radius:10},initialize:function(a,c){b.setOptions(this,c);this._latlng=b.latLng(a);this._radius=this.options.radius},setLatLng:function(a){this._latlng=b.latLng(a);this.redraw();return this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){this.options.radius=this._radius=a;return this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var c=a&&a.radius||this._radius;b.Path.prototype.setStyle.call(this,a);this.setRadius(c);return this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var a=this._radius,c=this._radiusY||a,g=this._clickTolerance(),a=[a+g,c+g];this._pxBounds=new b.Bounds(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}});b.circleMarker=function(a,c){return new b.CircleMarker(a,c)};b.Circle=b.CircleMarker.extend({initialize:function(a,c,g){"number"===typeof c&&(c=b.extend({},g,{radius:c}));b.setOptions(this,c);this._latlng=b.latLng(a);if(isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){this._mRadius=a;return this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new b.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:b.Path.prototype.setStyle,_project:function(){var a=this._latlng.lng,c=this._latlng.lat,g=this._map,f=g.options.crs;if(f.distance===b.CRS.Earth.distance){var h=Math.PI/180,f=this._mRadius/b.CRS.Earth.R/h,e=g.project([c+f,a]),k=g.project([c-f,a]),k=e.add(k).divideBy(2),l=g.unproject(k).lat,h=Math.acos((Math.cos(f*h)-Math.sin(c*h)*Math.sin(l*h))/(Math.cos(c*h)*Math.cos(l*h)))/h;if(isNaN(h)||0===h)h=f/Math.cos(Math.PI/180*c);this._point=k.subtract(g.getPixelOrigin());this._radius=isNaN(h)?0:Math.max(Math.round(k.x-g.project([l,a-h]).x),1);this._radiusY=Math.max(Math.round(k.y-e.y),1)}else a=f.unproject(f.project(this._latlng).subtract([this._mRadius,0])),this._point=g.latLngToLayerPoint(this._latlng),this._radius=this._point.x-g.latLngToLayerPoint(a).x;this._updateBounds()}});b.circle=function(a,c,g){return new b.Circle(a,c,g)};b.SVG=b.Renderer.extend({getEvents:function(){var a=b.Renderer.prototype.getEvents.call(this);a.zoomstart=this._onZoomStart;return a},_initContainer:function(){this._container=b.SVG.create("svg");this._container.setAttribute("pointer-events","none");this._rootGroup=b.SVG.create("g");this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){b.Renderer.prototype._update.call(this);var a=this._bounds,c=a.getSize(),g=this._container;this._svgSize&&this._svgSize.equals(c)||(this._svgSize=c,g.setAttribute("width",c.x),g.setAttribute("height",c.y));b.DomUtil.setPosition(g,a.min);g.setAttribute("viewBox",[a.min.x,a.min.y,c.x,c.y].join(" "));this.fire("update")}},_initPath:function(a){var c=a._path=b.SVG.create("path");a.options.className&&b.DomUtil.addClass(c,a.options.className);a.options.interactive&&b.DomUtil.addClass(c,"leaflet-interactive");this._updateStyle(a);this._layers[b.stamp(a)]=a},_addPath:function(a){this._rootGroup.appendChild(a._path);a.addInteractiveTarget(a._path)},_removePath:function(a){b.DomUtil.remove(a._path);a.removeInteractiveTarget(a._path);delete this._layers[b.stamp(a)]},_updatePath:function(a){a._project();a._update()},_updateStyle:function(a){var b=a._path;a=a.options;b&&(a.stroke?(b.setAttribute("stroke",a.color),b.setAttribute("stroke-opacity",a.opacity),b.setAttribute("stroke-width",a.weight),b.setAttribute("stroke-linecap",a.lineCap),b.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?b.setAttribute("stroke-dasharray",a.dashArray):b.removeAttribute("stroke-dasharray"),a.dashOffset?b.setAttribute("stroke-dashoffset",a.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),a.fill?(b.setAttribute("fill",a.fillColor||a.color),b.setAttribute("fill-opacity",a.fillOpacity),b.setAttribute("fill-rule",a.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(a,c){this._setPath(a,b.SVG.pointsToPath(a._parts,c))},_updateCircle:function(a){var b=a._point,c=a._radius,f="a"+c+","+(a._radiusY||c)+" 0 1,0 ",b=a._empty()?"M0 0":"M"+(b.x-c)+","+b.y+f+2*c+",0 "+f+2*-c+",0 ";this._setPath(a,b)},_setPath:function(a,b){a._path.setAttribute("d",b)},_bringToFront:function(a){b.DomUtil.toFront(a._path)},_bringToBack:function(a){b.DomUtil.toBack(a._path)}});b.extend(b.SVG,{create:function(a){return k.createElementNS("http://www.w3.org/2000/svg",a)},pointsToPath:function(a,c){var d="",f,h,e,k,l,q;f=0;for(e=a.length;f<e;f++){l=a[f];h=0;for(k=l.length;h<k;h++)q=l[h],d+=(h?"L":"M")+q.x+" "+q.y;d+=c?b.Browser.svg?"z":"x":""}return d||"M0 0"}});b.Browser.svg=!(!k.createElementNS||!b.SVG.create("svg").createSVGRect);b.svg=function(a){return b.Browser.svg||b.Browser.vml?new b.SVG(a):null};b.Browser.vml=!b.Browser.svg&&function(){try{var a=k.createElement("div");a.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';var b=a.firstChild;b.style.behavior="url(#default#VML)";return b&&"object"===typeof b.adj}catch(g){return!1}}();b.SVG.include(b.Browser.vml?{_initContainer:function(){this._container=b.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(b.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var c=a._container=b.SVG.create("shape");b.DomUtil.addClass(c,"leaflet-vml-shape "+(this.options.className||""));c.coordsize="1 1";a._path=b.SVG.create("path");c.appendChild(a._path);this._updateStyle(a);this._layers[b.stamp(a)]=a},_addPath:function(a){var b=a._container;this._container.appendChild(b);a.options.interactive&&a.addInteractiveTarget(b)},_removePath:function(a){var c=a._container;b.DomUtil.remove(c);a.removeInteractiveTarget(c);delete this._layers[b.stamp(a)]},_updateStyle:function(a){var c=a._stroke,g=a._fill,f=a.options,h=a._container;h.stroked=!!f.stroke;h.filled=!!f.fill;f.stroke?(c||(c=a._stroke=b.SVG.create("stroke")),h.appendChild(c),c.weight=f.weight+"px",c.color=f.color,c.opacity=f.opacity,c.dashStyle=f.dashArray?b.Util.isArray(f.dashArray)?f.dashArray.join(" "):f.dashArray.replace(/( *, *)/g," "):"",c.endcap=f.lineCap.replace("butt","flat"),c.joinstyle=f.lineJoin):c&&(h.removeChild(c),a._stroke=null);f.fill?(g||(g=a._fill=b.SVG.create("fill")),h.appendChild(g),g.color=f.fillColor||f.color,g.opacity=f.fillOpacity):g&&(h.removeChild(g),a._fill=null)},_updateCircle:function(a){var b=a._point.round(),c=Math.round(a._radius),f=Math.round(a._radiusY||c);this._setPath(a,a._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+f+" 0,23592600")},_setPath:function(a,b){a._path.v=b},_bringToFront:function(a){b.DomUtil.toFront(a._container)},_bringToBack:function(a){b.DomUtil.toBack(a._container)}}:{});b.Browser.vml&&(b.SVG.create=function(){try{return k.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return k.createElement("\x3clvml:"+a+' class\x3d"lvml"\x3e')}}catch(a){return function(a){return k.createElement("\x3c"+a+' xmlns\x3d"urn:schemas-microsoft.com:vml" class\x3d"lvml"\x3e')}}}());b.Canvas=b.Renderer.extend({getEvents:function(){var a=b.Renderer.prototype.getEvents.call(this);a.viewprereset=this._onViewPreReset;return a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){b.Renderer.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var a=this._container=k.createElement("canvas");b.DomEvent.on(a,"mousemove",b.Util.throttle(this._onMouseMove,32,this),this).on(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(a,"mouseout",this._handleMouseOut,this);this._ctx=a.getContext("2d")},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var b in this._layers)a=this._layers[b],a._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};b.Renderer.prototype._update.call(this);var a=this._bounds,c=this._container,g=a.getSize(),f=b.Browser.retina?2:1;b.DomUtil.setPosition(c,a.min);c.width=f*g.x;c.height=f*g.y;c.style.width=g.x+"px";c.style.height=g.y+"px";b.Browser.retina&&this._ctx.scale(2,2);this._ctx.translate(-a.min.x,-a.min.y);this.fire("update")}},_reset:function(){b.Renderer.prototype._reset.call(this);this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a);this._layers[b.stamp(a)]=a;a=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a);this._drawLast=a;this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var c=a._order,g=c.next,c=c.prev;g?g.prev=c:this._drawLast=c;c?c.next=g:this._drawFirst=g;delete a._order;delete this._layers[b.stamp(a)];this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a);a._project();a._update();this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a);this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var b=a.options.dashArray.split(","),c=[],f;for(f=0;f<b.length;f++)c.push(Number(b[f]));a.options._dashArray=c}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||b.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(a){var c=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new b.Bounds;this._redrawBounds.extend(a._pxBounds.min.subtract([c,c]));this._redrawBounds.extend(a._pxBounds.max.add([c,c]))},_redraw:function(){this._redrawRequest=null;this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil());this._clear();this._draw();this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var b=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,b=this._redrawBounds;this._ctx.save();b&&(a=b.getSize(),this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,a.x,a.y),this._ctx.clip());this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)a=c.layer,(!b||a._pxBounds&&a._pxBounds.intersects(b))&&a._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(a,b){if(this._drawing){var c,d,h,e,k=a._parts,l=k.length,q=this._ctx;if(l){this._drawnLayers[a._leaflet_id]=a;q.beginPath();q.setLineDash&&q.setLineDash(a.options&&a.options._dashArray||[]);for(c=0;c<l;c++){d=0;for(h=k[c].length;d<h;d++)e=k[c][d],q[d?"lineTo":"moveTo"](e.x,e.y);b&&q.closePath()}this._fillStroke(q,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var b=a._point,c=this._ctx,f=a._radius,h=(a._radiusY||f)/f;this._drawnLayers[a._leaflet_id]=a;1!==h&&(c.save(),c.scale(1,h));c.beginPath();c.arc(b.x,b.y/h,f,0,2*Math.PI,!1);1!==h&&c.restore();this._fillStroke(c,a)}},_fillStroke:function(a,b){var c=b.options;c.fill&&(a.globalAlpha=c.fillOpacity,a.fillStyle=c.fillColor||c.color,a.fill(c.fillRule||"evenodd"));c.stroke&&0!==c.weight&&(a.globalAlpha=c.opacity,a.lineWidth=c.weight,a.strokeStyle=c.color,a.lineCap=c.lineCap,a.lineJoin=c.lineJoin,a.stroke())},_onClick:function(a){for(var c=this._map.mouseEventToLayerPoint(a),g,f,h=this._drawFirst;h;h=h.next)g=h.layer,g.options.interactive&&g._containsPoint(c)&&!this._map._draggableMoved(g)&&(f=g);f&&(b.DomEvent._fakeStop(a),this._fireEvent([f],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,b)}},_handleMouseOut:function(a){var c=this._hoveredLayer;c&&(b.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([c],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,c){for(var d,f,h=this._drawFirst;h;h=h.next)d=h.layer,d.options.interactive&&d._containsPoint(c)&&(f=d);f!==this._hoveredLayer&&(this._handleMouseOut(a),f&&(b.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([f],a,"mouseover"),this._hoveredLayer=f));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,b,c){this._map._fireDOMEvent(b,c||b.type,a)},_bringToFront:function(a){var b=a._order,c=b.next,f=b.prev;c&&((c.prev=f)?f.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(a))},_bringToBack:function(a){var b=a._order,c=b.next,f=b.prev;f&&((f.next=c)?c.prev=f:f&&(this._drawLast=f),b.prev=null,b.next=this._drawFirst,this._drawFirst=this._drawFirst.prev=b,this._requestRedraw(a))}});b.Browser.canvas=!!k.createElement("canvas").getContext;b.canvas=function(a){return b.Browser.canvas?new b.Canvas(a):null};b.Polyline.prototype._containsPoint=function(a,c){var d,f,h,e,k,l,q=this._clickTolerance();if(!this._pxBounds.contains(a))return!1;d=0;for(e=this._parts.length;d<e;d++)for(l=this._parts[d],f=0,k=l.length,h=k-1;f<k;h=f++)if((c||0!==f)&&b.LineUtil.pointToSegmentDistance(a,l[h],l[f])<=q)return!0;return!1};b.Polygon.prototype._containsPoint=function(a){var c=!1,g,f,h,e,k,l,q;if(!this._pxBounds.contains(a))return!1;e=0;for(l=this._parts.length;e<l;e++)for(g=this._parts[e],k=0,q=g.length,h=q-1;k<q;h=k++)f=g[k],h=g[h],f.y>a.y!==h.y>a.y&&a.x<(h.x-f.x)*(a.y-f.y)/(h.y-f.y)+f.x&&(c=!c);return c||b.Polyline.prototype._containsPoint.call(this,a,!0)};b.CircleMarker.prototype._containsPoint=function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()};b.GeoJSON=b.FeatureGroup.extend({initialize:function(a,c){b.setOptions(this,c);this._layers={};a&&this.addData(a)},addData:function(a){var c=b.Util.isArray(a)?a:a.features,g,f;if(c){a=0;for(g=c.length;a<g;a++)f=c[a],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(f);return this}c=this.options;if(c.filter&&!c.filter(a))return this;g=b.GeoJSON.geometryToLayer(a,c);if(!g)return this;g.feature=b.GeoJSON.asFeature(a);g.defaultOptions=g.options;this.resetStyle(g);if(c.onEachFeature)c.onEachFeature(a,g);return this.addLayer(g)},resetStyle:function(a){a.options=b.Util.extend({},a.defaultOptions);this._setLayerStyle(a,this.options.style);return this},setStyle:function(a){return this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"===typeof b&&(b=b(a.feature));a.setStyle&&a.setStyle(b)}});b.extend(b.GeoJSON,{geometryToLayer:function(a,c){var d="Feature"===a.type?a.geometry:a,f=d?d.coordinates:null,h=[],e=c&&c.pointToLayer,k=c&&c.coordsToLatLng||this.coordsToLatLng,l,q;if(!f&&!d)return null;switch(d.type){case "Point":return d=k(f),e?e(a,d):new b.Marker(d);case "MultiPoint":l=0;for(q=f.length;l<q;l++)d=k(f[l]),h.push(e?e(a,d):new b.Marker(d));return new b.FeatureGroup(h);case "LineString":case "MultiLineString":return h=this.coordsToLatLngs(f,"LineString"===d.type?0:1,k),new b.Polyline(h,c);case "Polygon":case "MultiPolygon":return h=this.coordsToLatLngs(f,"Polygon"===d.type?1:2,k),new b.Polygon(h,c);case "GeometryCollection":l=0;for(q=d.geometries.length;l<q;l++)(f=this.geometryToLayer({geometry:d.geometries[l],type:"Feature",properties:a.properties},c))&&h.push(f);return new b.FeatureGroup(h);default:throw Error("Invalid GeoJSON object.");}},coordsToLatLng:function(a){return new b.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){for(var d=[],g=0,h=a.length,e;g<h;g++)e=b?this.coordsToLatLngs(a[g],b-1,c):(c||this.coordsToLatLng)(a[g]),d.push(e);return d},latLngToCoords:function(a){return a.alt!==l?[a.lng,a.lat,a.alt]:[a.lng,a.lat]},latLngsToCoords:function(a,c,g){for(var d=[],h=0,e=a.length;h<e;h++)d.push(c?b.GeoJSON.latLngsToCoords(a[h],c-1,g):b.GeoJSON.latLngToCoords(a[h]));!c&&g&&d.push(d[0]);return d},getFeature:function(a,c){return a.feature?b.extend({},a.feature,{geometry:c}):b.GeoJSON.asFeature(c)},asFeature:function(a){return"Feature"===a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}});h={toGeoJSON:function(){return b.GeoJSON.getFeature(this,{type:"Point",coordinates:b.GeoJSON.latLngToCoords(this.getLatLng())})}};b.Marker.include(h);b.Circle.include(h);b.CircleMarker.include(h);b.Polyline.prototype.toGeoJSON=function(){var a=!b.Polyline._flat(this._latlngs),c=b.GeoJSON.latLngsToCoords(this._latlngs,a?1:0);return b.GeoJSON.getFeature(this,{type:(a?"Multi":"")+"LineString",coordinates:c})};b.Polygon.prototype.toGeoJSON=function(){var a=!b.Polyline._flat(this._latlngs),c=a&&!b.Polyline._flat(this._latlngs[0]),g=b.GeoJSON.latLngsToCoords(this._latlngs,c?2:a?1:0,!0);a||(g=[g]);return b.GeoJSON.getFeature(this,{type:(c?"Multi":"")+"Polygon",coordinates:g})};b.LayerGroup.include({toMultiPoint:function(){var a=[];this.eachLayer(function(b){a.push(b.toGeoJSON().geometry.coordinates)});return b.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===a)return this.toMultiPoint();var c="GeometryCollection"===a,g=[];this.eachLayer(function(a){a.toGeoJSON&&(a=a.toGeoJSON(),g.push(c?a.geometry:b.GeoJSON.asFeature(a)))});return c?b.GeoJSON.getFeature(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});b.geoJSON=function(a,c){return new b.GeoJSON(a,c)};b.geoJson=b.geoJSON;b.Draggable=b.Evented.extend({options:{clickTolerance:3},statics:{START:b.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b,c){this._element=a;this._dragStartTarget=b||a;this._preventOutline=c},enable:function(){this._enabled||(b.DomEvent.on(this._dragStartTarget,b.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(b.Draggable._dragging===this&&this.finishDrag(),b.DomEvent.off(this._dragStartTarget,b.Draggable.START.join(" "),this._onDown,this),this._moved=this._enabled=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!(b.DomUtil.hasClass(this._element,"leaflet-zoom-anim")||b.Draggable._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(b.Draggable._dragging=this,this._preventOutline&&b.DomUtil.preventOutline(this._element),b.DomUtil.disableImageDrag(),b.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var c=a.touches?a.touches[0]:a;this._startPoint=new b.Point(c.clientX,c.clientY);b.DomEvent.on(k,b.Draggable.MOVE[a.type],this._onMove,this).on(k,b.Draggable.END[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled)if(a.touches&&1<a.touches.length)this._moved=!0;else{var c=a.touches&&1===a.touches.length?a.touches[0]:a,c=(new b.Point(c.clientX,c.clientY)).subtract(this._startPoint);!c.x&&!c.y||Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(b.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=b.DomUtil.getPosition(this._element).subtract(c),b.DomUtil.addClass(k.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,e.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),b.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,b.Util.cancelAnimFrame(this._animRequest),this._lastEvent=a,this._animRequest=b.Util.requestAnimFrame(this._updatePosition,this,!0))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a);b.DomUtil.setPosition(this._element,this._newPos);this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){b.DomUtil.removeClass(k.body,"leaflet-dragging");this._lastTarget&&(b.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in b.Draggable.MOVE)b.DomEvent.off(k,b.Draggable.MOVE[a],this._onMove,this).off(k,b.Draggable.END[a],this._onUp,this);b.DomUtil.enableImageDrag();b.DomUtil.enableTextSelection();this._moved&&this._moving&&(b.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;b.Draggable._dragging=!1}});b.Handler=b.Class.extend({initialize:function(a){this._map=a},enable:function(){if(this._enabled)return this;this._enabled=!0;this.addHooks();return this},disable:function(){if(!this._enabled)return this;this._enabled=!1;this.removeHooks();return this},enabled:function(){return!!this._enabled}});b.Map.mergeOptions({dragging:!0,inertia:!b.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});b.Map.Drag=b.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new b.Draggable(a._mapPane,a._container);this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on("predrag",this._onPreDragLimit,this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}b.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag");this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){b.DomUtil.removeClass(this._map._container,"leaflet-grab");b.DomUtil.removeClass(this._map._container,"leaflet-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var a=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=b.latLngBounds(this._map.options.maxBounds);this._offsetLimit=b.bounds(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var b=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c);this._times.push(b);50<b-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,b){return a-(a-b)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;a.x<b.min.x&&(a.x=this._viscousLimit(a.x,b.min.x));a.y<b.min.y&&(a.y=this._viscousLimit(a.y,b.min.y));a.x>b.max.x&&(a.x=this._viscousLimit(a.x,b.max.x));a.y>b.max.y&&(a.y=this._viscousLimit(a.y,b.max.y));this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,f=this._draggable._newPos.x,h=(f-b+c)%a+b-c,a=(f+b+c)%a-b-c,c=Math.abs(h+c)<Math.abs(a+c)?h:a;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=c},_onDragEnd:function(a){var c=this._map,g=c.options,f=!g.inertia||2>this._times.length;c.fire("dragend",a);if(f)c.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var h=g.easeLinearity,f=a.multiplyBy(h/((this._lastTime-this._times[0])/1E3)),e=f.distanceTo([0,0]);a=Math.min(g.inertiaMaxSpeed,e);var f=f.multiplyBy(a/e),k=a/(g.inertiaDeceleration*h),l=f.multiplyBy(-k/2).round();l.x||l.y?(l=c._limitOffset(l,c.options.maxBounds),b.Util.requestAnimFrame(function(){c.panBy(l,{duration:k,easeLinearity:h,noMoveStart:!0,animate:!0})})):c.fire("moveend")}}});b.Map.addInitHook("addHandler","dragging",b.Map.Drag);b.Map.mergeOptions({doubleClickZoom:!0});b.Map.DoubleClickZoom=b.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom(),f=b.options.zoomDelta,c=a.originalEvent.shiftKey?c-f:c+f;"center"===b.options.doubleClickZoom?b.setZoom(c):b.setZoomAround(a.containerPoint,c)}});b.Map.addInitHook("addHandler","doubleClickZoom",b.Map.DoubleClickZoom);b.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});b.Map.ScrollWheelZoom=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){b.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var c=b.DomEvent.getWheelDelta(a),g=this._map.options.wheelDebounceTime;this._delta+=c;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);c=Math.max(g-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(b.bind(this._performZoom,this),c);b.DomEvent.stop(a)},_performZoom:function(){var a=this._map,b=a.getZoom(),c=this._map.options.zoomSnap||0;a._stop();var f=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,c=c?Math.ceil(f/c)*c:f,c=a._limitZoom(b+(0<this._delta?c:-c))-b;this._delta=0;this._startTime=null;c&&("center"===a.options.scrollWheelZoom?a.setZoom(b+c):a.setZoomAround(this._lastMousePos,b+c))}});b.Map.addInitHook("addHandler","scrollWheelZoom",b.Map.ScrollWheelZoom);b.extend(b.DomEvent,{_touchstart:b.Browser.msPointer?"MSPointerDown":b.Browser.pointer?"pointerdown":"touchstart",_touchend:b.Browser.msPointer?"MSPointerUp":b.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,c,g){function d(a){var c;if(b.Browser.pointer){if(!b.Browser.edge||"mouse"===a.pointerType)return;c=b.DomEvent._pointersCount}else c=a.touches.length;if(!(1<c)){c=Date.now();var d=c-(e||c);k=a.touches?a.touches[0]:a;l=0<d&&250>=d;e=c}}function h(a){if(l&&!k.cancelBubble){if(b.Browser.pointer){if(!b.Browser.edge||"mouse"===a.pointerType)return;a={};var d,f;for(f in k)d=k[f],a[f]=d&&d.bind?d.bind(k):d;k=a}k.type="dblclick";c(k);e=null}}var e,k,l=!1,q=this._touchstart,u=this._touchend;a["_leaflet_"+q+g]=d;a["_leaflet_"+u+g]=h;a["_leaflet_dblclick"+g]=c;a.addEventListener(q,d,!1);a.addEventListener(u,h,!1);a.addEventListener("dblclick",c,!1);return this},removeDoubleTapListener:function(a,c){var d=a["_leaflet_"+this._touchend+c],f=a["_leaflet_dblclick"+c];a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+c],!1);a.removeEventListener(this._touchend,d,!1);b.Browser.edge||a.removeEventListener("dblclick",f,!1);return this}});b.extend(b.DomEvent,{POINTER_DOWN:b.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:b.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:b.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:b.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(a,b,c,f){"touchstart"===b?this._addPointerStart(a,c,f):"touchmove"===b?this._addPointerMove(a,c,f):"touchend"===b&&this._addPointerEnd(a,c,f);return this},removePointerListener:function(a,b,c){c=a["_leaflet_"+b+c];"touchstart"===b?a.removeEventListener(this.POINTER_DOWN,c,!1):"touchmove"===b?a.removeEventListener(this.POINTER_MOVE,c,!1):"touchend"===b&&(a.removeEventListener(this.POINTER_UP,c,!1),a.removeEventListener(this.POINTER_CANCEL,c,!1));return this},_addPointerStart:function(a,c,g){var d=b.bind(function(a){if("mouse"!==a.pointerType&&a.MSPOINTER_TYPE_MOUSE&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE)if(0>this.TAG_WHITE_LIST.indexOf(a.target.tagName))b.DomEvent.preventDefault(a);else return;this._handlePointer(a,c)},this);a["_leaflet_touchstart"+g]=d;a.addEventListener(this.POINTER_DOWN,d,!1);this._pointerDocListener||(a=b.bind(this._globalPointerUp,this),k.documentElement.addEventListener(this.POINTER_DOWN,b.bind(this._globalPointerDown,this),!0),k.documentElement.addEventListener(this.POINTER_MOVE,b.bind(this._globalPointerMove,this),!0),k.documentElement.addEventListener(this.POINTER_UP,a,!0),k.documentElement.addEventListener(this.POINTER_CANCEL,a,!0),this._pointerDocListener=!0)},_globalPointerDown:function(a){this._pointers[a.pointerId]=a;this._pointersCount++},_globalPointerMove:function(a){this._pointers[a.pointerId]&&(this._pointers[a.pointerId]=a)},_globalPointerUp:function(a){delete this._pointers[a.pointerId];this._pointersCount--},_handlePointer:function(a,b){a.touches=[];for(var c in this._pointers)a.touches.push(this._pointers[c]);a.changedTouches=[a];b(a)},_addPointerMove:function(a,c,g){var d=b.bind(function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&this._handlePointer(a,c)},this);a["_leaflet_touchmove"+g]=d;a.addEventListener(this.POINTER_MOVE,d,!1)},_addPointerEnd:function(a,c,g){var d=b.bind(function(a){this._handlePointer(a,c)},this);a["_leaflet_touchend"+g]=d;a.addEventListener(this.POINTER_UP,d,!1);a.addEventListener(this.POINTER_CANCEL,d,!1)}});b.Map.mergeOptions({touchZoom:b.Browser.touch&&!b.Browser.android23,bounceAtZoomLimits:!0});b.Map.TouchZoom=b.Handler.extend({addHooks:function(){b.DomUtil.addClass(this._map._container,"leaflet-touch-zoom");b.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){b.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom");b.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(a.touches&&2===a.touches.length&&!c._animatingZoom&&!this._zooming){var g=c.mouseEventToContainerPoint(a.touches[0]),f=c.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=c.getSize()._divideBy(2);this._startLatLng=c.containerPointToLatLng(this._centerPoint);"center"!==c.options.touchZoom&&(this._pinchStartLatLng=c.containerPointToLatLng(g.add(f)._divideBy(2)));this._startDist=g.distanceTo(f);this._startZoom=c.getZoom();this._moved=!1;this._zooming=!0;c._stop();b.DomEvent.on(k,"touchmove",this._onTouchMove,this).on(k,"touchend",this._onTouchEnd,this);b.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var c=this._map,g=c.mouseEventToContainerPoint(a.touches[0]),f=c.mouseEventToContainerPoint(a.touches[1]),h=g.distanceTo(f)/this._startDist;this._zoom=c.getScaleZoom(h,this._startZoom);!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&1>h||this._zoom>c.getMaxZoom()&&1<h)&&(this._zoom=c._limitZoom(this._zoom));if("center"===c.options.touchZoom){if(this._center=this._startLatLng,1===h)return}else{g=g._add(f)._divideBy(2)._subtract(this._centerPoint);if(1===h&&0===g.x&&0===g.y)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(g),this._zoom)}this._moved||(c._moveStart(!0),this._moved=!0);b.Util.cancelAnimFrame(this._animRequest);c=b.bind(c._move,c,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=b.Util.requestAnimFrame(c,this,!0);b.DomEvent.preventDefault(a)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,b.Util.cancelAnimFrame(this._animRequest),b.DomEvent.off(k,"touchmove",this._onTouchMove).off(k,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});b.Map.addInitHook("addHandler","touchZoom",b.Map.TouchZoom);b.Map.mergeOptions({tap:!0,tapTolerance:15});b.Map.Tap=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){b.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches)if(b.DomEvent.preventDefault(a),this._fireClick=!0,1<a.touches.length)this._fireClick=!1,clearTimeout(this._holdTimeout);else{var c=a.touches[0];a=c.target;this._startPos=this._newPos=new b.Point(c.clientX,c.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&b.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(b.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c))},this),1E3);this._simulateEvent("mousedown",c);b.DomEvent.on(k,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){clearTimeout(this._holdTimeout);b.DomEvent.off(k,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&a&&a.changedTouches){a=a.changedTouches[0];var c=a.target;c&&c.tagName&&"a"===c.tagName.toLowerCase()&&b.DomUtil.removeClass(c,"leaflet-active");this._simulateEvent("mouseup",a);this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new b.Point(a.clientX,a.clientY);this._simulateEvent("mousemove",a)},_simulateEvent:function(a,b){var c=k.createEvent("MouseEvents");c._simulated=!0;b.target._simulatedClick=!0;c.initMouseEvent(a,!0,!0,e,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(c)}});b.Browser.touch&&!b.Browser.pointer&&b.Map.addInitHook("addHandler","tap",b.Map.Tap);b.Map.mergeOptions({boxZoom:!0});b.Map.BoxZoom=b.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane},addHooks:function(){b.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){b.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(a){if(!a.shiftKey||1!==a.which&&1!==a.button)return!1;this._resetState();b.DomUtil.disableTextSelection();b.DomUtil.disableImageDrag();this._startPoint=this._map.mouseEventToContainerPoint(a);b.DomEvent.on(k,{contextmenu:b.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=b.DomUtil.create("div","leaflet-zoom-box",this._container),b.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(a);a=new b.Bounds(this._point,this._startPoint);var c=a.getSize();b.DomUtil.setPosition(this._box,a.min);this._box.style.width=c.x+"px";this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(b.DomUtil.remove(this._box),b.DomUtil.removeClass(this._container,"leaflet-crosshair"));b.DomUtil.enableTextSelection();b.DomUtil.enableImageDrag();b.DomEvent.off(k,{contextmenu:b.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(1===a.which||1===a.button)this._finish(),this._moved&&(setTimeout(b.bind(this._resetState,this),0),a=new b.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});b.Map.addInitHook("addHandler","boxZoom",b.Map.BoxZoom);b.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80});b.Map.Keyboard=b.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a;this._setPanDelta(a.options.keyboardPanDelta);this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;0>=a.tabIndex&&(a.tabIndex="0");b.DomEvent.on(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();b.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=k.body,b=k.documentElement,c=a.scrollTop||b.scrollTop,a=a.scrollLeft||b.scrollLeft;this._map._container.focus();e.scrollTo(a,c)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(a){var b=this._panKeys={},c=this.keyCodes,f,h;f=0;for(h=c.left.length;f<h;f++)b[c.left[f]]=[-1*a,0];f=0;for(h=c.right.length;f<h;f++)b[c.right[f]]=[a,0];f=0;for(h=c.down.length;f<h;f++)b[c.down[f]]=[0,a];f=0;for(h=c.up.length;f<h;f++)b[c.up[f]]=[0,-1*a]},_setZoomDelta:function(a){var b=this._zoomKeys={},c=this.keyCodes,f,h;f=0;for(h=c.zoomIn.length;f<h;f++)b[c.zoomIn[f]]=a;f=0;for(h=c.zoomOut.length;f<h;f++)b[c.zoomOut[f]]=-a},_addHooks:function(){b.DomEvent.on(k,"keydown",this._onKeyDown,this)},_removeHooks:function(){b.DomEvent.off(k,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var c=a.keyCode,g=this._map;if(c in this._panKeys){if(g._panAnim&&g._panAnim._inProgress)return;c=this._panKeys[c];a.shiftKey&&(c=b.point(c).multiplyBy(3));g.panBy(c);g.options.maxBounds&&g.panInsideBounds(g.options.maxBounds)}else if(c in this._zoomKeys)g.setZoom(g.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[c]);else if(27===c)g.closePopup();else return;b.DomEvent.stop(a)}}});b.Map.addInitHook("addHandler","keyboard",b.Map.Keyboard);b.Handler.MarkerDrag=b.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new b.Draggable(a,a,!0));this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();b.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&b.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var c=this._marker,g=c._shadow,f=b.DomUtil.getPosition(c._icon),h=c._map.layerPointToLatLng(f);g&&b.DomUtil.setPosition(g,f);c._latlng=h;a.latlng=h;a.oldLatLng=this._oldLatLng;c.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",a)}});b.Control=b.Class.extend({options:{position:"topright"},initialize:function(a){b.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;b&&b.removeControl(this);this.options.position=a;b&&b.addControl(this);return this},getContainer:function(){return this._container},addTo:function(a){this.remove();this._map=a;var c=this._container=this.onAdd(a),g=this.getPosition();a=a._controlCorners[g];b.DomUtil.addClass(c,"leaflet-control");-1!==g.indexOf("bottom")?a.insertBefore(c,a.firstChild):a.appendChild(c);return this},remove:function(){if(!this._map)return this;b.DomUtil.remove(this._container);if(this.onRemove)this.onRemove(this._map);this._map=null;return this},_refocusOnMap:function(a){this._map&&a&&0<a.screenX&&0<a.screenY&&this._map.getContainer().focus()}});b.control=function(a){return new b.Control(a)};b.Map.include({addControl:function(a){a.addTo(this);return this},removeControl:function(a){a.remove();return this},_initControlPos:function(){function a(a,d){c[a+d]=b.DomUtil.create("div","leaflet-"+a+" leaflet-"+d,g)}var c=this._controlCorners={},g=this._controlContainer=b.DomUtil.create("div","leaflet-control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){b.DomUtil.remove(this._controlContainer)}});b.Control.Zoom=b.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var c=b.DomUtil.create("div","leaflet-control-zoom leaflet-bar"),g=this.options;this._zoomInButton=this._createButton(g.zoomInText,g.zoomInTitle,"leaflet-control-zoom-in",c,this._zoomIn);this._zoomOutButton=this._createButton(g.zoomOutText,g.zoomOutTitle,"leaflet-control-zoom-out",c,this._zoomOut);this._updateDisabled();a.on("zoomend zoomlevelschange",this._updateDisabled,this);return c},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){this._disabled=!0;this._updateDisabled();return this},enable:function(){this._disabled=!1;this._updateDisabled();return this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,c,g,f,h){g=b.DomUtil.create("a",g,f);g.innerHTML=a;g.href="#";g.title=c;g.setAttribute("role","button");g.setAttribute("aria-label",c);b.DomEvent.on(g,"mousedown dblclick",b.DomEvent.stopPropagation).on(g,"click",b.DomEvent.stop).on(g,"click",h,this).on(g,"click",this._refocusOnMap,this);return g},_updateDisabled:function(){var a=this._map;b.DomUtil.removeClass(this._zoomInButton,"leaflet-disabled");b.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMinZoom())&&b.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMaxZoom())&&b.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});b.Map.mergeOptions({zoomControl:!0});b.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new b.Control.Zoom,this.addControl(this.zoomControl))});b.control.zoom=function(a){return new b.Control.Zoom(a)};b.Control.Attribution=b.Control.extend({options:{position:"bottomright",prefix:'\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e'},initialize:function(a){b.setOptions(this,a);this._attributions={}},onAdd:function(a){a.attributionControl=this;this._container=b.DomUtil.create("div","leaflet-control-attribution");b.DomEvent&&b.DomEvent.disableClickPropagation(this._container);for(var c in a._layers)a._layers[c].getAttribution&&this.addAttribution(a._layers[c].getAttribution());this._update();return this._container},setPrefix:function(a){this.options.prefix=a;this._update();return this},addAttribution:function(a){if(!a)return this;this._attributions[a]||(this._attributions[a]=0);this._attributions[a]++;this._update();return this},removeAttribution:function(a){if(!a)return this;this._attributions[a]&&(this._attributions[a]--,this._update());return this},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions[b]&&a.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);a.length&&b.push(a.join(", "));this._container.innerHTML=b.join(" | ")}}});b.Map.mergeOptions({attributionControl:!0});b.Map.addInitHook(function(){this.options.attributionControl&&(new b.Control.Attribution).addTo(this)});b.control.attribution=function(a){return new b.Control.Attribution(a)};b.Control.Scale=b.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var c=b.DomUtil.create("div","leaflet-control-scale"),g=this.options;this._addScales(g,"leaflet-control-scale-line",c);a.on(g.updateWhenIdle?"moveend":"move",this._update,this);a.whenReady(this._update,this);return c},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,c,g){a.metric&&(this._mScale=b.DomUtil.create("div",c,g));a.imperial&&(this._iScale=b.DomUtil.create("div",c,g))},_update:function(){var a=this._map,b=a.getSize().y/2,a=a.distance(a.containerPointToLatLng([0,b]),a.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(a)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a);this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var b=this._getRoundNum(a);this._updateScale(this._mScale,1E3>b?b+" m":b/1E3+" km",b/a)},_updateImperial:function(a){a*=3.2808399;var b;5280<a?(a/=5280,b=this._getRoundNum(a),this._updateScale(this._iScale,b+" mi",b/a)):(b=this._getRoundNum(a),this._updateScale(this._iScale,b+" ft",b/a))},_updateScale:function(a,b,c){a.style.width=Math.round(this.options.maxWidth*c)+"px";a.innerHTML=b},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1);a/=b;return b*(10<=a?10:5<=a?5:3<=a?3:2<=a?2:1)}});b.control.scale=function(a){return new b.Control.Scale(a)};b.Control.Layers=b.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,b,c,f){return c<f?-1:f<c?1:0}},initialize:function(a,c,g){b.setOptions(this,g);this._layers=[];this._lastZIndex=0;this._handlingClick=!1;for(var d in a)this._addLayer(a[d],d);for(d in c)this._addLayer(c[d],d,!0)},onAdd:function(a){this._initLayout();this._update();this._map=a;a.on("zoomend",this._checkDisabledLayers,this);return this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,b){this._addLayer(a,b);return this._map?this._update():this},addOverlay:function(a,b){this._addLayer(a,b,!0);return this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);(a=this._getLayer(b.stamp(a)))&&this._layers.splice(this._layers.indexOf(a),1);return this._map?this._update():this},expand:function(){b.DomUtil.addClass(this._container,"leaflet-control-layers-expanded");this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);a<this._form.clientHeight?(b.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=a+"px"):b.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar");this._checkDisabledLayers();return this},collapse:function(){b.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded");return this},_initLayout:function(){var a=this._container=b.DomUtil.create("div","leaflet-control-layers"),c=this.options.collapsed;a.setAttribute("aria-haspopup",!0);b.DomEvent.disableClickPropagation(a);b.Browser.touch||b.DomEvent.disableScrollPropagation(a);var g=this._form=b.DomUtil.create("form","leaflet-control-layers-list");if(c&&(this._map.on("click",this.collapse,this),!b.Browser.android))b.DomEvent.on(a,{mouseenter:this.expand,mouseleave:this.collapse},this);var f=this._layersLink=b.DomUtil.create("a","leaflet-control-layers-toggle",a);f.href="#";f.title="Layers";if(b.Browser.touch)b.DomEvent.on(f,"click",b.DomEvent.stop).on(f,"click",this.expand,this);else b.DomEvent.on(f,"focus",this.expand,this);b.DomEvent.on(g,"click",function(){setTimeout(b.bind(this._onInputClick,this),0)},this);c||this.expand();this._baseLayersList=b.DomUtil.create("div","leaflet-control-layers-base",g);this._separator=b.DomUtil.create("div","leaflet-control-layers-separator",g);this._overlaysList=b.DomUtil.create("div","leaflet-control-layers-overlays",g);a.appendChild(g)},_getLayer:function(a){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&b.stamp(this._layers[c].layer)===a)return this._layers[c]},_addLayer:function(a,c,g){a.on("add remove",this._onLayerChange,this);this._layers.push({layer:a,name:c,overlay:g});this.options.sortLayers&&this._layers.sort(b.bind(function(a,b){return this.options.sortFunction(a.layer,b.layer,a.name,b.name)},this));this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;b.DomUtil.empty(this._baseLayersList);b.DomUtil.empty(this._overlaysList);var a,c,g,f,h=0;for(g=0;g<this._layers.length;g++)f=this._layers[g],this._addItem(f),c=c||f.overlay,a=a||!f.overlay,h+=f.overlay?0:1;this.options.hideSingleBase&&(a=a&&1<h,this._baseLayersList.style.display=a?"":"none");this._separator.style.display=c&&a?"":"none";return this},_onLayerChange:function(a){this._handlingClick||this._update();var c=this._getLayer(b.stamp(a.target));(a=c.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null)&&this._map.fire(a,c)},_createRadioElement:function(a,b){var c='\x3cinput type\x3d"radio" class\x3d"leaflet-control-layers-selector" name\x3d"'+a+'"'+(b?' checked\x3d"checked"':"")+"/\x3e",d=k.createElement("div");d.innerHTML=c;return d.firstChild},_addItem:function(a){var c=k.createElement("label"),g=this._map.hasLayer(a.layer),f;a.overlay?(f=k.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=g):f=this._createRadioElement("leaflet-base-layers",g);f.layerId=b.stamp(a.layer);b.DomEvent.on(f,"click",this._onInputClick,this);g=k.createElement("span");g.innerHTML=" "+a.name;var h=k.createElement("div");c.appendChild(h);h.appendChild(f);h.appendChild(g);(a.overlay?this._overlaysList:this._baseLayersList).appendChild(c);this._checkDisabledLayers();return c},_onInputClick:function(){var a=this._form.getElementsByTagName("input"),b,c,f,h=[],e=[];this._handlingClick=!0;for(var k=a.length-1;0<=k;k--)b=a[k],c=this._getLayer(b.layerId).layer,f=this._map.hasLayer(c),b.checked&&!f?h.push(c):!b.checked&&f&&e.push(c);for(k=0;k<e.length;k++)this._map.removeLayer(e[k]);for(k=0;k<h.length;k++)this._map.addLayer(h[k]);this._handlingClick=!1;this._refocusOnMap()},_checkDisabledLayers:function(){for(var a=this._form.getElementsByTagName("input"),b,c,f=this._map.getZoom(),h=a.length-1;0<=h;h--)b=a[h],c=this._getLayer(b.layerId).layer,b.disabled=c.options.minZoom!==l&&f<c.options.minZoom||c.options.maxZoom!==l&&f>c.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}});b.control.layers=function(a,c,g){return new b.Control.Layers(a,c,g)}})(window,document);(function(e){var k,l;if("function"===typeof define&&define.amd)define(["leaflet","proj4"],e);else if("object"===typeof module&&"object"===typeof module.exports)k=require("leaflet"),l=require("proj4"),module.exports=e(k,l);else{if("undefined"===typeof window.L||"undefined"===typeof window.proj4)throw"Leaflet and proj4 must be loaded first";e(window.L,window.proj4)}})(function(e,k){e.Proj={};e.Proj._isProj4Obj=function(e){return"undefined"!==typeof e.inverse&&"undefined"!==typeof e.forward};e.Proj.Projection=e.Class.extend({initialize:function(k,c,b){var h=e.Proj._isProj4Obj(k);this._proj=h?k:this._projFromCodeDef(k,c);this.bounds=h?c:b},project:function(k){k=this._proj.forward([k.lng,k.lat]);return new e.Point(k[0],k[1])},unproject:function(k,c){var b=this._proj.inverse([k.x,k.y]);return new e.LatLng(b[1],b[0],c)},_projFromCodeDef:function(e,c){if(c)k.defs(e,c);else if(void 0===k.defs[e]){var b=e.split(":");3<b.length&&(e=b[b.length-3]+":"+b[b.length-1]);if(void 0===k.defs[e])throw"No projection definition for code "+e;}return k(e)}});e.Proj.CRS=e.Class.extend({includes:e.CRS,options:{transformation:new e.Transformation(1,0,-1,0)},initialize:function(k,c,b){var h;e.Proj._isProj4Obj(k)?(h=k.srsCode,b=c||{},this.projection=new e.Proj.Projection(k,b.bounds)):(h=k,b=b||{},this.projection=new e.Proj.Projection(h,c,b.bounds));e.Util.setOptions(this,b);this.code=h;this.transformation=this.options.transformation;this.options.origin&&(this.transformation=new e.Transformation(1,-this.options.origin[0],-1,this.options.origin[1]));if(this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions)for(this._scales=[],k=this.options.resolutions.length-1;0<=k;k--)this.options.resolutions[k]&&(this._scales[k]=1/this.options.resolutions[k]);this.infinite=!this.options.bounds},scale:function(e){var c=Math.floor(e),b;if(e===c)return this._scales[e];b=this._scales[c];return b+(this._scales[c+1]-b)*(e-c)},zoom:function(e){var c=this._closestElement(this._scales,e),b=this._scales.indexOf(c),h;if(e===c)return b;h=this._scales[b+1];return void 0===h?Infinity:(e-c)/(h-c)+b},distance:e.CRS.Earth.distance,R:e.CRS.Earth.R,_closestElement:function(e,c){for(var b,h=e.length;h--;)e[h]<=c&&(void 0===b||b<e[h])&&(b=e[h]);return b}});e.Proj.GeoJSON=e.GeoJSON.extend({initialize:function(k,c){this._callLevel=0;e.GeoJSON.prototype.initialize.call(this,k,c)},addData:function(k){var c;k&&(k.crs&&"name"===k.crs.type?c=new e.Proj.CRS(k.crs.properties.name):k.crs&&k.crs.type&&(c=new e.Proj.CRS(k.crs.type+":"+k.crs.properties.code)),void 0!==c&&(this.options.coordsToLatLng=function(b){b=e.point(b[0],b[1]);return c.projection.unproject(b)}));this._callLevel++;try{e.GeoJSON.prototype.addData.call(this,k)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}});e.Proj.geoJson=function(k,c){return new e.Proj.GeoJSON(k,c)};e.Proj.ImageOverlay=e.ImageOverlay.extend({initialize:function(k,c,b){e.ImageOverlay.prototype.initialize.call(this,k,null,b);this._projectedBounds=c},_animateZoom:function(k){var c=this._map.getZoomScale(k.zoom),b=e.point(this._projectedBounds.min.x,this._projectedBounds.max.y);k=this._projectedToNewLayerPoint(b,k.zoom,k.center);e.DomUtil.setTransform(this._image,k,c)},_reset:function(){var k=this._map.getZoom(),c=this._map.getPixelOrigin(),k=e.bounds(this._transform(this._projectedBounds.min,k)._subtract(c),this._transform(this._projectedBounds.max,k)._subtract(c)),c=k.getSize();e.DomUtil.setPosition(this._image,k.min);this._image.style.width=c.x+"px";this._image.style.height=c.y+"px"},_projectedToNewLayerPoint:function(e,c,b){var h=this._map.getSize()._divideBy(2);b=this._map.project(b,c)._subtract(h)._round().add(this._map._getMapPanePos());return this._transform(e,c)._subtract(b)},_transform:function(e,c){var b=this._map.options.crs,h=b.transformation,b=b.scale(c);return h.transform(e,b)}});e.Proj.imageOverlay=function(k,c,b){return new e.Proj.ImageOverlay(k,c,b)};return e.Proj});(function(e,k){"object"===typeof exports&&"undefined"!==typeof module?k(exports,require("leaflet")):"function"===typeof define&&define.amd?define(["exports","leaflet"],k):k((e.L=e.L||{},e.L.esri=e.L.esri||{}),e.L)})(this,function(e,k){function l(a){var b="";a.f=a.f||"json";for(var c in a)if(a.hasOwnProperty(c)){var d=a[c],f=Object.prototype.toString.call(d);b.length&&(b+="\x26");d="[object Array]"===f?"[object Object]"===Object.prototype.toString.call(d[0])?JSON.stringify(d):d.join(","):"[object Object]"===f?JSON.stringify(d):"[object Date]"===f?d.valueOf():d;b+=encodeURIComponent(c)+"\x3d"+encodeURIComponent(d)}return b}function c(a,b){var c=new window.XMLHttpRequest;c.onerror=function(d){c.onreadystatechange=k.Util.falseFn;a.call(b,{error:{code:500,message:"XMLHttpRequest error"}},null)};c.onreadystatechange=function(){var d,f;if(4===c.readyState){try{d=JSON.parse(c.responseText)}catch(Ia){d=null,f={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!f&&d.error&&(f=d.error,d=null);c.onerror=k.Util.falseFn;a.call(b,f,d)}};c.ontimeout=function(){this.onerror()};return c}function b(a,b,d,f){d=c(d,f);d.open("POST",a);"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(d.timeout=f.options.timeout);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(l(b));return d}function h(a,b,d,f){d=c(d,f);d.open("GET",a+"?"+l(b),!0);"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(d.timeout=f.options.timeout);d.send(null);return d}function a(a,b,f,g){var h=l(b),n=c(f,g),e=(a+"?"+h).length;2E3>=e&&ba.cors?n.open("GET",a+"?"+h):2E3<e&&ba.cors&&(n.open("POST",a),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));"undefined"!==typeof g&&null!==g&&"undefined"!==typeof g.options&&(n.timeout=g.options.timeout);if(2E3>=e&&ba.cors)n.send(null);else if(2E3<e&&ba.cors)n.send(h);else{if(2E3>=e&&!ba.cors)return d(a,b,f,g);M("a request to "+a+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");return}return n}function d(a,b,c,d){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var f="c"+fa;b.callback="window._EsriLeafletCallbacks."+f;window._EsriLeafletCallbacks[f]=function(a){if(!0!==window._EsriLeafletCallbacks[f]){var b,g=Object.prototype.toString.call(a);"[object Object]"!==g&&"[object Array]"!==g&&(b={error:{code:500,message:"Expected array or object as JSONP response"}},a=null);!b&&a.error&&(b=a,a=null);c.call(d,b,a);window._EsriLeafletCallbacks[f]=!0}};var g=k.DomUtil.create("script",null,document.body);g.type="text/javascript";g.src=a+"?"+l(b);g.id=f;fa++;return{id:f,url:g.src,abort:function(){window._EsriLeafletCallbacks._callback[f]({code:0,message:"Request aborted."})}}}function g(a){var b;a:{b=a[0];for(var c=0;c<b.length;c++)if(b[c]!==a[a.length-1][c]){b=!1;break a}b=!0}b||a.push(a[0]);return a}function f(a){var b=0,c=0,d=a.length,f=a[c],g;for(c;c<d-1;c++)g=a[c+1],b+=(g[0]-f[0])*(g[1]+f[1]),f=g;return 0<=b}function m(a,b){for(var c=0;c<a.length-1;c++)for(var d=0;d<b.length-1;d++){var f;a:{var g=a[c],h=a[c+1],n=b[d],e=b[d+1],k=(e[0]-n[0])*(g[1]-n[1])-(e[1]-n[1])*(g[0]-n[0]);f=(h[0]-g[0])*(g[1]-n[1])-(h[1]-g[1])*(g[0]-n[0]);g=(e[1]-n[1])*(h[0]-g[0])-(e[0]-n[0])*(h[1]-g[1]);if(0!==g&&(k/=g,f/=g,0<=k&&1>=k&&0<=f&&1>=f)){f=!0;break a}f=!1}if(f)return!0}return!1}function x(a){var b=[];a=a.slice(0);var c=g(a.shift().slice(0));if(4<=c.length)for(f(c)||c.reverse(),b.push(c),c=0;c<a.length;c++){var d=g(a[c].slice(0));4<=d.length&&(f(d)&&d.reverse(),b.push(d))}return b}function C(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function v(a,b){var c={};"number"===typeof a.x&&"number"===typeof a.y&&(c.type="Point",c.coordinates=[a.x,a.y]);a.points&&(c.type="MultiPoint",c.coordinates=a.points.slice(0));a.paths&&(1===a.paths.length?(c.type="LineString",c.coordinates=a.paths[0].slice(0)):(c.type="MultiLineString",c.coordinates=a.paths.slice(0)));if(a.rings){var d=a.rings.slice(0),c=[],h=[],n,e;for(e=0;e<d.length;e++){var k=g(d[e].slice(0));4>k.length||(f(k)?c.push([k]):h.push(k))}for(k=[];h.length;){e=h.pop();for(var l=!1,d=c.length-1;0<=d;d--){var K=n=c[d][0],x=e;n=m(K,x);for(var x=x[0],S=!1,q=-1,fa=K.length,W=fa-1;++q<fa;W=q)(K[q][1]<=x[1]&&x[1]<K[W][1]||K[W][1]<=x[1]&&x[1]<K[q][1])&&x[0]<(K[W][0]-K[q][0])*(x[1]-K[q][1])/(K[W][1]-K[q][1])+K[q][0]&&(S=!S);K=S;if(!n&&K){c[d].push(e);l=!0;break}}l||k.push(e)}for(;k.length;){e=k.pop();h=!1;for(d=c.length-1;0<=d;d--)if(n=c[d][0],m(n,e)){c[d].push(e);h=!0;break}h||c.push([e.reverse()])}c=1===c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}if(a.geometry||a.attributes)c.type="Feature",c.geometry=a.geometry?v(a.geometry):null,c.properties=a.attributes?C(a.attributes):null,a.attributes&&(c.id=a.attributes[b]||a.attributes.OBJECTID||a.attributes.FID);return c}function q(a,b){b=b||"OBJECTID";var c={wkid:4326},d={};switch(a.type){case "Point":d.x=a.coordinates[0];d.y=a.coordinates[1];d.spatialReference=c;break;case "MultiPoint":d.points=a.coordinates.slice(0);d.spatialReference=c;break;case "LineString":d.paths=[a.coordinates.slice(0)];d.spatialReference=c;break;case "MultiLineString":d.paths=a.coordinates.slice(0);d.spatialReference=c;break;case "Polygon":d.rings=x(a.coordinates.slice(0));d.spatialReference=c;break;case "MultiPolygon":for(var f=d,g=a.coordinates.slice(0),h=[],n=0;n<g.length;n++)for(var e=x(g[n]),k=e.length-1;0<=k;k--){var m=e[k].slice(0);h.push(m)}f.rings=h;d.spatialReference=c;break;case "Feature":a.geometry&&(d.geometry=q(a.geometry,b));d.attributes=a.properties?C(a.properties):{};a.id&&(d.attributes[b]=a.id);break;case "FeatureCollection":d=[];for(c=0;c<a.features.length;c++)d.push(q(a.features[c],b));break;case "GeometryCollection":for(d=[],c=0;c<a.geometries.length;c++)d.push(q(a.geometries[c],b))}return d}function u(a){if("NaN"!==a.xmin&&"NaN"!==a.ymin&&"NaN"!==a.xmax&&"NaN"!==a.ymax){var b=k.latLng(a.ymin,a.xmin);a=k.latLng(a.ymax,a.xmax);return k.latLngBounds(b,a)}return null}function y(a){a=k.latLngBounds(a);return{xmin:a.getSouthWest().lng,ymin:a.getSouthWest().lat,xmax:a.getNorthEast().lng,ymax:a.getNorthEast().lat,spatialReference:{wkid:4326}}}function z(a,b){var c,d=a.features||a.results,f=d.length;if(b)c=b;else if(a.objectIdFieldName)c=a.objectIdFieldName;else if(a.fields)for(var g=0;g<=a.fields.length-1;g++){if("esriFieldTypeOID"===a.fields[g].type){c=a.fields[g].name;break}}else if(f)for(g in d[0].attributes)if(g.match(/^(OBJECTID|FID|OID|ID)$/i)){c=g;break}g={type:"FeatureCollection",features:[]};if(f)for(f=d.length-1;0<=f;f--){var h=v(d[f],c);g.features.push(h)}return g}function F(a){a=k.Util.trim(a);"/"!==a[a.length-1]&&(a+="/");return a}function D(a){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(a)}function N(a){var b;switch(a){case "Point":b="esriGeometryPoint";break;case "MultiPoint":b="esriGeometryMultipoint";break;case "LineString":b="esriGeometryPolyline";break;case "MultiLineString":b="esriGeometryPolyline";break;case "Polygon":b="esriGeometryPolygon";break;case "MultiPolygon":b="esriGeometryPolygon"}return b}function M(){console&&console.warn&&console.warn.apply(console,arguments)}function U(a){return a.getSize().x-S.attributionWidthOffset+"px"}function A(a){if(a.attributionControl&&!a.attributionControl._esriAttributionAdded){a.attributionControl.setPrefix('\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e | Powered by \x3ca href\x3d"https://www.esri.com"\x3eEsri\x3c/a\x3e');var b=document.createElement("style");b.type="text/css";b.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}";document.getElementsByTagName("head")[0].appendChild(b);k.DomUtil.addClass(a.attributionControl._container,"esri-truncated-attribution:hover");b=document.createElement("style");b.type="text/css";b.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+U(a)+";}";document.getElementsByTagName("head")[0].appendChild(b);k.DomUtil.addClass(a.attributionControl._container,"esri-truncated-attribution");a.on("resize",function(b){a.attributionControl._container.style.maxWidth=U(b.target)});a.attributionControl._esriAttributionAdded=!0}}function G(a,b){d(a,{},k.Util.bind(function(a,c){if(!a){b._esriAttributions=[];for(var d=0;d<c.contributors.length;d++)for(var f=c.contributors[d],g=0;g<f.coverageAreas.length;g++){var h=f.coverageAreas[g],n=k.latLng(h.bbox[0],h.bbox[1]),e=k.latLng(h.bbox[2],h.bbox[3]);b._esriAttributions.push({attribution:f.attribution,score:h.score,bounds:k.latLngBounds(n,e),minZoom:h.zoomMin,maxZoom:h.zoomMax})}b._esriAttributions.sort(function(a,b){return b.score-a.score});J({target:b})}},this))}function J(a){a=a.target;var b=a._esriAttributions;if(a&&a.attributionControl&&b){for(var c="",d=a.getBounds(),d=k.latLngBounds(d.getSouthWest().wrap(),d.getNorthEast().wrap()),f=a.getZoom(),g=0;g<b.length;g++){var h=b[g],n=h.attribution;!c.match(n)&&h.bounds.intersects(d)&&f>=h.minZoom&&f<=h.maxZoom&&(c+=", "+n)}c=c.substr(2);b=a.attributionControl._container.querySelector(".esri-dynamic-attribution");b.innerHTML=c;b.style.maxWidth=U(a);a.fire("attributionupdated",{attribution:c})}}function H(a){return new w(a)}function t(a){return new V(a)}function r(a){return new ya(a)}function P(a){return new ia(a)}function X(a){return new za(a)}function Z(a){return new ma(a)}function aa(a){return new va(a)}function Q(a){this.values=[].concat(a||[])}var I="default"in k?k["default"]:k,B=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,Y=""===document.documentElement.style.pointerEvents,ba={cors:B,pointerEvents:Y},S={attributionWidthOffset:55},fa=0,W=ba.cors?h:d;W.CORS=h;W.JSONP=d;var la={request:a,get:W,post:b},wa={shallowClone:function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},warn:M,cleanUrl:F,isArcgisOnline:D,geojsonTypeToArcGIS:N,responseToFeatureCollection:z,geojsonToArcGIS:function(a,b){return q(a,b)},arcgisToGeoJSON:function(a,b){return v(a,b)},boundsToExtent:y,extentToBounds:u,calcAttributionWidth:U,setEsriAttribution:A,_getAttributionData:G,_updateMapAttribution:J},R=k.Class.extend({options:{proxy:!1,useCors:B},generateSetter:function(a,b){return k.Util.bind(function(b){this.params[a]=b;return this},b)},initialize:function(a){a.request&&a.options?(this._service=a,k.Util.setOptions(this,a.options)):(k.Util.setOptions(this,a),this.options.url=F(a.url));this.params=k.Util.extend({},this.params||{});if(this.setters)for(var b in this.setters)this[b]=this.generateSetter(this.setters[b],this)},token:function(a){this._service?this._service.authenticate(a):this.params.token=a;return this},request:function(a,b){return this._service?this._service.request(this.path,this.params,a,b):this._request("request",this.path,this.params,a,b)},_request:function(a,b,c,d,f){b=this.options.proxy?this.options.proxy+"?"+this.options.url+b:this.options.url+b;return"get"!==a&&"request"!==a||this.options.useCors?la[a](b,c,d,f):la.get.JSONP(b,c,d,f)}}),w=R.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",token:"token"},path:"query",params:{returnGeometry:!0,where:"1\x3d1",outSr:4326,outFields:"*"},within:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelContains";return this},intersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelIntersects";return this},contains:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelWithin";return this},crosses:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelCrosses";return this},touches:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelTouches";return this},overlaps:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelOverlaps";return this},bboxIntersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelEnvelopeIntersects";return this},indexIntersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelIndexIntersects";return this},nearby:function(a,b){a=k.latLng(a);this.params.geometry=[a.lng,a.lat];this.params.geometryType="esriGeometryPoint";this.params.spatialRel="esriSpatialRelIntersects";this.params.units="esriSRUnit_Meter";this.params.distance=b;this.params.inSr=4326;return this},where:function(a){this.params.where=a;return this},between:function(a,b){this.params.time=[a.valueOf(),b.valueOf()];return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},orderBy:function(a,b){this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"";this.params.orderByFields+=[a,b||"ASC"].join(" ");return this},run:function(a,b){this._cleanParams();return this.options.isModern||D(this.options.url)?(this.params.f="geojson",this.request(function(c,d){this._trapSQLerrors(c);a.call(b,c,d,d)},this)):this.request(function(c,d){this._trapSQLerrors(c);a.call(b,c,d&&z(d),d)},this)},count:function(a,b){this._cleanParams();this.params.returnCountOnly=!0;return this.request(function(b,c){a.call(this,b,c&&c.count,c)},b)},ids:function(a,b){this._cleanParams();this.params.returnIdsOnly=!0;return this.request(function(b,c){a.call(this,b,c&&c.objectIds,c)},b)},bounds:function(a,b){this._cleanParams();this.params.returnExtentOnly=!0;return this.request(function(c,d){d&&d.extent&&u(d.extent)?a.call(b,c,u(d.extent),d):(c={message:"Invalid Bounds"},a.call(b,c,null,d))},b)},pixelSize:function(a){a=k.point(a);this.params.pixelSize=[a.x,a.y];return this},layer:function(a){this.path=a+"/query";return this},_trapSQLerrors:function(a){a&&"400"===a.code&&M("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly;delete this.params.returnExtentOnly;delete this.params.returnCountOnly},_setGeometry:function(a){this.params.inSr=4326;a instanceof k.LatLngBounds?(this.params.geometry=y(a),this.params.geometryType="esriGeometryEnvelope"):(a.getLatLng&&(a=a.getLatLng()),a instanceof k.LatLng&&(a={type:"Point",coordinates:[a.lng,a.lat]}),a instanceof k.GeoJSON&&(a=a.getLayers()[0].feature.geometry,this.params.geometry=q(a,void 0),this.params.geometryType=N(a.type)),a.toGeoJSON&&(a=a.toGeoJSON()),"Feature"===a.type&&(a=a.geometry),"Point"===a.type||"LineString"===a.type||"Polygon"===a.type||"MultiPolygon"===a.type?(this.params.geometry=q(a,void 0),this.params.geometryType=N(a.type)):M("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}}),V=R.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(a,b){this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"";this.params.layerDefs+=[a,b].join(":");return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},run:function(a,b){return this.request(function(c,d){a.call(b,c,d&&z(d),d)},b)}}),da=R.extend({path:"identify",between:function(a,b){this.params.time=[a.valueOf(),b.valueOf()];return this}}),ya=da.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(a){var b=y(a.getBounds());a=a.getSize();this.params.imageDisplay=[a.x,a.y,96];this.params.mapExtent=[b.xmin,b.ymin,b.xmax,b.ymax];return this},at:function(a){a=k.latLng(a);this.params.geometry=[a.lng,a.lat];this.params.geometryType="esriGeometryPoint";return this},layerDef:function(a,b){this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"";this.params.layerDefs+=[a,b].join(":");return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},run:function(a,b){return this.request(function(c,d){if(c)a.call(b,c,void 0,d);else{var f=z(d);d.results=d.results.reverse();for(var g=0;g<f.features.length;g++)f.features[g].layerId=d.results[g].layerId;a.call(b,void 0,f,d)}})}}),ia=da.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(a){a=k.latLng(a);this.params.geometry=JSON.stringify({x:a.lng,y:a.lat,spatialReference:{wkid:4326}});this.params.geometryType="esriGeometryPoint";return this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(a,b){return this.request(function(c,d){a.call(b,c,d&&this._responseToGeoJSON(d),d)},this)},_responseToGeoJSON:function(a){var b=a.location,c=a.catalogItems,d=a.catalogItemVisibilities,b={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[b.x,b.y]},crs:{type:"EPSG",properties:{code:b.spatialReference.wkid}},properties:{OBJECTID:a.objectId,name:a.name,value:a.value},id:a.objectId}};a.properties&&a.properties.Values&&(b.pixel.properties.values=a.properties.Values);if(c&&c.features&&(b.catalogItems=z(c),d&&d.length===b.catalogItems.features.length))for(a=d.length-1;0<=a;a--)b.catalogItems.features[a].properties.catalogItemVisibility=d[a];return b}}),ca=k.Evented.extend({options:{proxy:!1,useCors:B,timeout:0},initialize:function(a){a=a||{};this._requestQueue=[];this._authenticating=!1;k.Util.setOptions(this,a);this.options.url=F(this.options.url)},get:function(a,b,c,d){return this._request("get",a,b,c,d)},post:function(a,b,c,d){return this._request("post",a,b,c,d)},request:function(a,b,c,d){return this._request("request",a,b,c,d)},metadata:function(a,b){return this._request("get","",{},a,b)},authenticate:function(a){this._authenticating=!1;this.options.token=a;this._runQueue();return this},getTimeout:function(){return this.options.timeout},setTimeout:function(a){this.options.timeout=a},_request:function(a,b,c,d,f){this.fire("requeststart",{url:this.options.url+b,params:c,method:a},!0);var g=this._createServiceCallback(a,b,c,d,f);this.options.token&&(c.token=this.options.token);if(this._authenticating)this._requestQueue.push([a,b,c,d,f]);else return b=this.options.proxy?this.options.proxy+"?"+this.options.url+b:this.options.url+b,"get"!==a&&"request"!==a||this.options.useCors?la[a](b,c,g,f):la.get.JSONP(b,c,g,f)},_createServiceCallback:function(a,b,c,d,f){return k.Util.bind(function(g,h){!g||499!==g.code&&498!==g.code||(this._authenticating=!0,this._requestQueue.push([a,b,c,d,f]),this.fire("authenticationrequired",{authenticate:k.Util.bind(this.authenticate,this)},!0),g.authenticate=k.Util.bind(this.authenticate,this));d.call(f,g,h);g?this.fire("requesterror",{url:this.options.url+b,params:c,message:g.message,code:g.code,method:a},!0):this.fire("requestsuccess",{url:this.options.url+b,params:c,response:h,method:a},!0);this.fire("requestend",{url:this.options.url+b,params:c,method:a},!0)},this)},_runQueue:function(){for(var a=this._requestQueue.length-1;0<=a;a--){var b=this._requestQueue[a];this[b.shift()].apply(this,b)}this._requestQueue=[]}}),za=ca.extend({identify:function(){return r(this)},find:function(){return t(this)},query:function(){return H(this)}}),ma=ca.extend({query:function(){return H(this)},identify:function(){return P(this)}}),va=ca.extend({options:{idAttribute:"OBJECTID"},query:function(){return H(this)},addFeature:function(a,b,c){delete a.id;a=q(a,void 0);return this.post("addFeatures",{features:[a]},function(a,d){var f=d&&d.addResults?d.addResults[0]:void 0;b&&b.call(c,a||d.addResults[0].error,f)},c)},updateFeature:function(a,b,c){a=q(a,this.options.idAttribute);return this.post("updateFeatures",{features:[a]},function(a,d){var f=d&&d.updateResults?d.updateResults[0]:void 0;b&&b.call(c,a||d.updateResults[0].error,f)},c)},deleteFeature:function(a,b,c){return this.post("deleteFeatures",{objectIds:a},function(a,d){var f=d&&d.deleteResults?d.deleteResults[0]:void 0;b&&b.call(c,a||d.deleteResults[0].error,f)},c)},deleteFeatures:function(a,b,c){return this.post("deleteFeatures",{objectIds:a},function(a,d){var f=d&&d.deleteResults?d.deleteResults:void 0;b&&b.call(c,a||d.deleteResults[0].error,f)},c)}}),O="https:"!==window.location.protocol?"http:":"https:",ja=k.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:O+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:O+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Y?"esri-labels":"tilePane"}},NationalGeographic:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Y?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Y?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"}},ImageryLabels:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Y?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Y?"esri-labels":"tilePane"}},ShadedRelief:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:Y?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:Y?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:O+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}}}},initialize:function(a,b){var c;if("object"===typeof a&&a.urlTemplate&&a.options)c=a;else if("string"===typeof a&&ja.TILES[a])c=ja.TILES[a];else throw Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var d=k.Util.extend(c.options,b);k.Util.setOptions(this,d);this.options.token&&(c.urlTemplate+="?token\x3d"+this.options.token);k.TileLayer.prototype.initialize.call(this,c.urlTemplate,d)},onAdd:function(a){A(a);"esri-labels"===this.options.pane&&this._initPane();this.options.attributionUrl&&G(this.options.attributionUrl,a);a.on("moveend",J);k.TileLayer.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("moveend",J);k.TileLayer.prototype.onRemove.call(this,a)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var a=this._map.createPane(this.options.pane);a.style.pointerEvents="none";a.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var a='\x3cspan class\x3d"esri-dynamic-attribution"\x3e'+this.options.attribution+"\x3c/span\x3e";return a}}),na=k.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg\x3d\x3d"},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(a){a.url=F(a.url);a=k.Util.setOptions(this,a);this.tileUrl=a.url+"tile/{z}/{y}/{x}";this.service=X(a);this.service.addEventParent(this);(new RegExp(/tiles.arcgis(online)?\.com/g)).test(a.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),a.subdomains=["1","2","3","4"]);this.options.token&&(this.tileUrl+="?token\x3d"+this.options.token);k.TileLayer.prototype.initialize.call(this,this.tileUrl,a)},getTileUrl:function(a){var b=this._getZoomForUrl();return k.Util.template(this.tileUrl,k.Util.extend({s:this._getSubdomain(a),x:a.x,y:a.y,z:this._lodMap&&this._lodMap[b]?this._lodMap[b]:b},this.options))},createTile:function(a,b){var c=document.createElement("img");L.DomEvent.on(c,"load",L.bind(this._tileOnLoad,this,b,c));L.DomEvent.on(c,"error",L.bind(this._tileOnError,this,b,c));this.options.crossOrigin&&(c.crossOrigin="");c.alt="";if(!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()])c.src=this.getTileUrl(a);else this.once("lodmap",function(){c.src=this.getTileUrl(a)},this);return c},onAdd:function(a){A(a);this._lodMap||this.metadata(function(b,c){if(!b&&c.spatialReference){var d=c.spatialReference.latestWkid||c.spatialReference.wkid;!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()));if(a.options.crs===L.CRS.EPSG3857&&102100===d||3857===d){this._lodMap={};for(var d=c.tileInfo.lods,f=na.MercatorZoomLevels,g=0;g<d.length;g++){var h=d[g],e;for(e in f)if(this._withinPercentage(h.resolution,f[e],this.options.zoomOffsetAllowance)){this._lodMap[e]=h.level;break}}this.fire("lodmap")}else proj4||M("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this);k.TileLayer.prototype.onAdd.call(this,a)},metadata:function(a,b){this.service.metadata(a,b);return this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(a){var b="?token\x3d"+a;this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,b):this.tileUrl+b;this.options.token=a;this.service.authenticate(a);return this},_withinPercentage:function(a,b,c){return Math.abs(a/b-1)<c}}),xa=k.ImageOverlay.extend({onAdd:function(a){this._topLeft=a.getPixelBounds().min;k.ImageOverlay.prototype.onAdd.call(this,a)},_reset:function(){this._map.options.crs===k.CRS.EPSG3857?k.ImageOverlay.prototype._reset.call(this):k.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),B=k.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:B,attribution:null,interactive:!1,alt:""},onAdd:function(a){A(a);this._update=k.Util.throttle(this._update,this.options.updateInterval,this);a.on("moveend",this._update,this);this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?a.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null);this._update();this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));this.metadata(function(b,c){!b&&!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(a){this._currentImage&&this._map.removeLayer(this._currentImage);this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._map.off("moveend",this._update,this)},bindPopup:function(a,b){this._lastClick=this._shouldRenderPopup=!1;this._popup=k.popup(b);this._popupFunction=a;this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));return this},unbindPopup:function(){this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._popup=!1;return this},bringToFront:function(){this.options.position="front";this._currentImage&&this._currentImage.bringToFront();return this},bringToBack:function(){this.options.position="back";this._currentImage&&this._currentImage.bringToBack();return this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(a){this.options.opacity=a;this._currentImage&&this._currentImage.setOpacity(a);return this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,b){this.options.from=a;this.options.to=b;this._update();return this},metadata:function(a,b){this.service.metadata(a,b);return this},authenticate:function(a){this.service.authenticate(a);return this},redraw:function(){this._update()},_renderImage:function(a,b,c){this._map&&(c&&(a="data:"+c+";base64,"+a),(new xa(a,b,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive})).addTo(this._map).once("load",function(a){if(this._map){a=a.target;var c=this._currentImage;a._bounds.equals(b)&&a._bounds.equals(this._map.getBounds())?(this._currentImage=a,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),c&&this._map&&this._map.removeLayer(c),c&&c._map&&c._map.removeLayer(c)):this._map.removeLayer(a)}this.fire("load",{bounds:b})},this),this.fire("loading",{bounds:b}))},_update:function(){if(this._map){var a=this._map.getZoom(),b=this._map.getBounds();this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress||(a>this.options.maxZoom||a<this.options.minZoom?this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null):(a=this._buildExportParams(),this._requestExport(a,b)))}},_renderPopup:function(a,b,c,d){a=k.latLng(a);this._shouldRenderPopup&&this._lastClick.equals(a)&&(b=this._popupFunction(b,c,d))&&this._popup.setLatLng(a).setContent(b).openOn(this._map)},_resetPopupState:function(a){this._shouldRenderPopup=!1;this._lastClick=a.latlng}}),Aa=B.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"json"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(a){a.url=F(a.url);this.service=Z(a);this.service.addEventParent(this);k.Util.setOptions(this,a)},setPixelType:function(a){this.options.pixelType=a;this._update();return this},getPixelType:function(){return this.options.pixelType},setBandIds:function(a){k.Util.isArray(a)?this.options.bandIds=a.join(","):this.options.bandIds=a.toString();this._update();return this},getBandIds:function(){return this.options.bandIds},setNoData:function(a,b){k.Util.isArray(a)?this.options.noData=a.join(","):this.options.noData=a.toString();b&&(this.options.noDataInterpretation=b);this._update();return this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(a){this.options.renderingRule=a;this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(a){this.options.mosaicRule=a;this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(a){var b=k.Util.bind(function(b,c,d){b||setTimeout(k.Util.bind(function(){this._renderPopup(a.latlng,b,c,d)},this),300)},this),c=this.identify().at(a.latlng);this.options.mosaicRule&&c.setMosaicRule(this.options.mosaicRule);c.run(b);this._shouldRenderPopup=!0;this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),b=this._map.getSize(),c=this._map.options.crs.project(a._northEast),d=this._map.options.crs.project(a._southWest),f=this._map.latLngToLayerPoint(a._northEast),a=this._map.latLngToLayerPoint(a._southWest);if(0<f.y||a.y<b.y)b.y=a.y-f.y;f=parseInt(this._map.options.crs.code.split(":")[1],10);b={bbox:[d.x,d.y,c.x,c.y].join(),size:b.x+","+b.y,format:this.options.format,transparent:this.options.transparent,bboxSR:f,imageSR:f};this.options.from&&this.options.to&&(b.time=this.options.from.valueOf()+","+this.options.to.valueOf());this.options.pixelType&&(b.pixelType=this.options.pixelType);this.options.interpolation&&(b.interpolation=this.options.interpolation);this.options.compressionQuality&&(b.compressionQuality=this.options.compressionQuality);this.options.bandIds&&(b.bandIds=this.options.bandIds);this.options.noData&&(b.noData=this.options.noData);this.options.noDataInterpretation&&(b.noDataInterpretation=this.options.noDataInterpretation);this.service.options.token&&(b.token=this.service.options.token);this.options.renderingRule&&(b.renderingRule=JSON.stringify(this.options.renderingRule));this.options.mosaicRule&&(b.mosaicRule=JSON.stringify(this.options.mosaicRule));return b},_requestExport:function(a,b){"json"===this.options.f?this.service.request("exportImage",a,function(a,c){a||(this.options.token&&(c.href+="?token\x3d"+this.options.token),this._renderImage(c.href,b))},this):(a.f="image",this._renderImage(this.options.url+"exportImage"+k.Util.getParamString(a),b))}}),qa=B.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(a){a.url=F(a.url);this.service=X(a);this.service.addEventParent(this);(a.proxy||a.token)&&"json"!==a.f&&(a.f="json");k.Util.setOptions(this,a)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(a){this.options.dynamicLayers=a;this._update();return this},getLayers:function(){return this.options.layers},setLayers:function(a){this.options.layers=a;this._update();return this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(a){this.options.layerDefs=a;this._update();return this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(a){this.options.timeOptions=a;this._update();return this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(a){var b=k.Util.bind(function(b,c,d){b||setTimeout(k.Util.bind(function(){this._renderPopup(a.latlng,b,c,d)},this),300)},this),c=this.identify().on(this._map).at(a.latlng);c.simplify(this._map,.5);this.options.layers?c.layers("visible:"+this.options.layers.join(",")):c.layers("visible");c.run(b);this._shouldRenderPopup=!0;this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),b=this._map.getSize(),c=this._map.options.crs.project(a.getNorthEast()),d=this._map.options.crs.project(a.getSouthWest()),f=parseInt(this._map.options.crs.code.split(":")[1],10),g=this._map.latLngToLayerPoint(a._northEast),a=this._map.latLngToLayerPoint(a._southWest);if(0<g.y||a.y<b.y)b.y=a.y-g.y;b={bbox:[d.x,d.y,c.x,c.y].join(),size:b.x+","+b.y,dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:f,imageSR:f};this.options.dynamicLayers&&(b.dynamicLayers=this.options.dynamicLayers);this.options.layers&&(b.layers="show:"+this.options.layers.join(","));this.options.layerDefs&&(b.layerDefs="string"===typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs));this.options.timeOptions&&(b.timeOptions=JSON.stringify(this.options.timeOptions));this.options.from&&this.options.to&&(b.time=this.options.from.valueOf()+","+this.options.to.valueOf());this.service.options.token&&(b.token=this.service.options.token);this.options.proxy&&(b.proxy=this.options.proxy);this.options.geokey&&(b.geokey=this.options.geokey);return b},_requestExport:function(a,b){"json"===this.options.f?this.service.request("export",a,function(a,c){a||(this.options.token&&(c.href+="?token\x3d"+this.options.token),this.options.proxy&&(c.href=this.options.proxy+"?"+c.href),c.href?this._renderImage(c.href,b):this._renderImage(c.imageData,b,c.contentType))},this):(a.f="image",this._renderImage(this.options.url+"export"+k.Util.getParamString(a),b))}}),ea=I.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(a){I.setOptions(this,a);this._zooming=!1},onAdd:function(a){this._map=a;this._update=I.Util.throttle(this._update,this.options.updateInterval,this);this._reset();this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this);this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(a){a.addLayer(this);return this},removeFrom:function(a){a.removeLayer(this);return this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells();this._cells={};this._activeCells={};this._cellsTotal=this._cellsToLoad=0;this._cellNumBounds=this._getCellNumBounds();this._resetWrap();this._zooming=!1},_resetWrap:function(){var a=this._map,b=a.options.crs;if(!b.infinite){var c=this._getCellSize();b.wrapLng&&(this._wrapLng=[Math.floor(a.project([0,b.wrapLng[0]]).x/c),Math.ceil(a.project([0,b.wrapLng[1]]).x/c)]);b.wrapLat&&(this._wrapLat=[Math.floor(a.project([b.wrapLat[0],0]).y/c),Math.ceil(a.project([b.wrapLat[1],0]).y/c)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var a=this._map.getPixelBounds(),b=this._getCellSize(),a=I.bounds(a.min.divideBy(b).floor(),a.max.divideBy(b).floor());this._removeOtherCells(a);this._addCells(a);this.fire("cellsupdated")}},_addCells:function(a){var b=[],c=a.getCenter(),d=this._map.getZoom(),f,g,h;for(f=a.min.y;f<=a.max.y;f++)for(g=a.min.x;g<=a.max.x;g++)h=I.point(g,f),h.z=d,this._isValidCell(h)&&b.push(h);a=b.length;if(0!==a)for(this._cellsToLoad+=a,this._cellsTotal+=a,b.sort(function(a,b){return a.distanceTo(c)-b.distanceTo(c)}),g=0;g<a;g++)this._addCell(b[g])},_isValidCell:function(a){var b=this._map.options.crs;if(!b.infinite){var c=this._cellNumBounds;if(!b.wrapLng&&(a.x<c.min.x||a.x>c.max.x)||!b.wrapLat&&(a.y<c.min.y||a.y>c.max.y))return!1}if(!this.options.bounds)return!0;a=this._cellCoordsToBounds(a);return I.latLngBounds(this.options.bounds).intersects(a)},_cellCoordsToBounds:function(a){var b=this._map,c=this.options.cellSize,d=a.multiplyBy(c),c=d.add([c,c]),d=b.wrapLatLng(b.unproject(d,a.z));a=b.wrapLatLng(b.unproject(c,a.z));return I.latLngBounds(d,a)},_cellCoordsToKey:function(a){return a.x+":"+a.y},_keyToCellCoords:function(a){var b=a.split(":");a=parseInt(b[0],10);b=parseInt(b[1],10);return I.point(a,b)},_removeOtherCells:function(a){for(var b in this._cells)a.contains(this._keyToCellCoords(b))||this._removeCell(b)},_removeCell:function(a){var b=this._activeCells[a];b&&(delete this._activeCells[a],this.cellLeave&&this.cellLeave(b.bounds,b.coords),this.fire("cellleave",{bounds:b.bounds,coords:b.coords}))},_removeCells:function(){for(var a in this._cells){var b=this._cells[a].bounds,c=this._cells[a].coords;this.cellLeave&&this.cellLeave(b,c);this.fire("cellleave",{bounds:b,coords:c})}},_addCell:function(a){this._wrapCoords(a);var b=this._cellCoordsToKey(a),c=this._cells[b];c&&!this._activeCells[b]&&(this.cellEnter&&this.cellEnter(c.bounds,a),this.fire("cellenter",{bounds:c.bounds,coords:a}),this._activeCells[b]=c);c||(c={coords:a,bounds:this._cellCoordsToBounds(a)},this._cells[b]=c,this._activeCells[b]=c,this.createCell&&this.createCell(c.bounds,a),this.fire("cellcreate",{bounds:c.bounds,coords:a}))},_wrapCoords:function(a){a.x=this._wrapLng?I.Util.wrapNum(a.x,this._wrapLng):a.x;a.y=this._wrapLat?I.Util.wrapNum(a.y,this._wrapLat):a.y},_getCellNumBounds:function(){var a=this._map.getPixelWorldBounds(),b=this._getCellSize();return a?I.bounds(a.min.divideBy(b).floor(),a.max.divideBy(b).ceil().subtract([1,1])):null}});Q.prototype.query=function(a){a=this.getIndex(a);return this.values[a]};Q.prototype.getIndex=function(a){this.dirty&&this.sort();for(var b=0,c=this.values.length-1,d,f;b<=c;)if(d=(b+c)/2|0,f=this.values[Math.round(d)],+f.value<+a)b=d+1;else if(+f.value>+a)c=d-1;else return d;return Math.abs(~c)};Q.prototype.between=function(a,b){var c=this.getIndex(a),d=this.getIndex(b);if(0===c&&0===d)return[];for(;this.values[c-1]&&this.values[c-1].value===a;)c--;for(;this.values[d+1]&&this.values[d+1].value===b;)d++;this.values[d]&&this.values[d].value===b&&this.values[d+1]&&d++;return this.values.slice(c,d)};Q.prototype.insert=function(a){this.values.splice(this.getIndex(a.value),0,a);return this};Q.prototype.bulkAdd=function(a,b){this.values=this.values.concat([].concat(a||[]));b?this.sort():this.dirty=!0;return this};Q.prototype.sort=function(){this.values.sort(function(a,b){return+b.value-+a.value}).reverse();this.dirty=!1;return this};var ka=ea.extend({options:{attribution:null,where:"1\x3d1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(a){ea.prototype.initialize.call(this,a);a.url=F(a.url);a=k.setOptions(this,a);this.service=aa(a);this.service.addEventParent(this);if("*"!==this.options.fields[0]){a=!1;for(var b=0;b<this.options.fields.length;b++)this.options.fields[b].match(/^(OBJECTID|FID|OID|ID)$/i)&&(a=!0);!1===a&&M("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new Q,this._endTimeIndex=new Q):this.options.timeField&&(this._timeIndex=new Q);this._cache={};this._currentSnapshot=[];this._activeRequests=0},onAdd:function(a){A(a);this.service.metadata(function(b,c){if(!b){var d=c.supportedQueryFormats,f=!1;!1===this.service.options.isModern&&(f=!0);!f&&d&&-1!==d.indexOf("geoJSON")&&(this.service.options.isModern=!0);!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))}},this);a.on("zoomend",this._handleZoomChange,this);return ea.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("zoomend",this._handleZoomChange,this);return ea.prototype.onRemove.call(this,a)},getAttribution:function(){return this.options.attribution},createCell:function(a,b){this._visibleZoom()&&this._requestFeatures(a,b)},_requestFeatures:function(a,b,c){this._activeRequests++;1===this._activeRequests&&this.fire("loading",{bounds:a},!0);return this._buildQuery(a).run(function(d,f,g){g&&g.exceededTransferLimit&&this.fire("drawlimitexceeded");!d&&f&&f.features.length&&k.Util.requestAnimFrame(k.Util.bind(function(){this._addFeatures(f.features,b);this._postProcessFeatures(a)},this));d||!f||f.features.length||this._postProcessFeatures(a);d&&this._postProcessFeatures(a);c&&c.call(this,d,f)},this)},_postProcessFeatures:function(a){this._activeRequests--;0>=this._activeRequests&&this.fire("load",{bounds:a})},_cacheKey:function(a){return a.z+":"+a.x+":"+a.y},_addFeatures:function(a,b){var c=this._cacheKey(b);this._cache[c]=this._cache[c]||[];for(var d=a.length-1;0<=d;d--){var f=a[d].id;-1===this._currentSnapshot.indexOf(f)&&this._currentSnapshot.push(f);-1===this._cache[c].indexOf(f)&&this._cache[c].push(f)}this.options.timeField&&this._buildTimeIndexes(a);this.createLayers(a)},_buildQuery:function(a){a=this.service.query().intersects(a).where(this.options.where).fields(this.options.fields).precision(this.options.precision);this.options.simplifyFactor&&a.simplify(this._map,this.options.simplifyFactor);"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&a.between(this.options.from,this.options.to);return a},setWhere:function(a,b,c){this.options.where=a&&a.length?a:"1\x3d1";var d=[],f=[],g=0,h=null;a=k.Util.bind(function(a,e){a&&(h=a);if(e)for(var m=e.features.length-1;0<=m;m--)f.push(e.features[m].id);g--;0>=g&&(this._currentSnapshot=f,k.Util.requestAnimFrame(k.Util.bind(function(){this.removeLayers(d);this.addLayers(f);b&&b.call(c,h)},this)))},this);for(var e=this._currentSnapshot.length-1;0<=e;e--)d.push(this._currentSnapshot[e]);for(var m in this._activeCells)g++,e=this._keyToCellCoords(m),e=this._cellCoordsToBounds(e),this._requestFeatures(e,m,a);return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,b,c,d){var f=this.options.from,g=this.options.to,h=0,e=null,m=k.Util.bind(function(k){k&&(e=k);this._filterExistingFeatures(f,g,a,b);h--;c&&0>=h&&c.call(d,e)},this);this.options.from=a;this.options.to=b;this._filterExistingFeatures(f,g,a,b);if("server"===this.options.timeFilterMode)for(var l in this._activeCells){h++;var x=this._keyToCellCoords(l),x=this._cellCoordsToBounds(x);this._requestFeatures(x,l,m)}return this},refresh:function(){for(var a in this._activeCells){var b=this._keyToCellCoords(a),b=this._cellCoordsToBounds(b);this._requestFeatures(b,a)}if(this.redraw)this.once("load",function(){this.eachFeature(function(a){this._redraw(a.feature.id)},this)},this)},_filterExistingFeatures:function(a,b,c,d){var f=a&&b?this._getFeaturesInTimeRange(a,b):this._currentSnapshot,g=this._getFeaturesInTimeRange(c,d);if(g.indexOf)for(a=0;a<g.length;a++)b=f.indexOf(g[a]),0<=b&&f.splice(b,1);k.Util.requestAnimFrame(k.Util.bind(function(){this.removeLayers(f);this.addLayers(g)},this))},_getFeaturesInTimeRange:function(a,b){var c=[],d;if(this.options.timeField.start&&this.options.timeField.end){d=this._startTimeIndex.between(a,b);var f=this._endTimeIndex.between(a,b);d=d.concat(f)}else d=this._timeIndex.between(a,b);for(f=d.length-1;0<=f;f--)c.push(d[f].id);return c},_buildTimeIndexes:function(a){var b,c;if(this.options.timeField.start&&this.options.timeField.end){var d=[],f=[];for(b=a.length-1;0<=b;b--)c=a[b],d.push({id:c.id,value:new Date(c.properties[this.options.timeField.start])}),f.push({id:c.id,value:new Date(c.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(d);this._endTimeIndex.bulkAdd(f)}else{d=[];for(b=a.length-1;0<=b;b--)c=a[b],d.push({id:c.id,value:new Date(c.properties[this.options.timeField])});this._timeIndex.bulkAdd(d)}},_featureWithinTimeRange:function(a){if(!this.options.from||!this.options.to)return!0;var b=+this.options.from.valueOf(),c=+this.options.to.valueOf();if("string"===typeof this.options.timeField){var d=+a.properties[this.options.timeField];return d>=b&&d<=c}if(this.options.timeField.start&&this.options.timeField.end)return d=+a.properties[this.options.timeField.start],a=+a.properties[this.options.timeField.end],d>=b&&d<=c||a>=b&&a<=c},_visibleZoom:function(){if(!this._map)return!1;var a=this._map.getZoom();return a>this.options.maxZoom||a<this.options.minZoom?!1:!0},_handleZoomChange:function(){if(this._visibleZoom())for(var a in this._activeCells){var b=this._cacheKey(this._activeCells[a].coords);this._cache[b]&&this.addLayers(this._cache[b])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(a){this.service.authenticate(a);return this},metadata:function(a,b){this.service.metadata(a,b);return this},query:function(){return this.service.query()},_getMetadata:function(a){this._metadata?a(void 0,this._metadata):this.metadata(k.Util.bind(function(b,c){this._metadata=c;a(b,this._metadata)},this))},addFeature:function(a,b,c){this._getMetadata(k.Util.bind(function(d,f){d?b&&b.call(this,d,null):this.service.addFeature(a,k.Util.bind(function(d,g){d||(a.properties[f.objectIdField]=g.objectId,a.id=g.objectId,this.createLayers([a]));b&&b.call(c,d,g)},this))},this))},updateFeature:function(a,b,c){this.service.updateFeature(a,function(d,f){d||(this.removeLayers([a.id],!0),this.createLayers([a]));b&&b.call(c,d,f)},this)},deleteFeature:function(a,b,c){this.service.deleteFeature(a,function(a,d){!a&&d.objectId&&this.removeLayers([d.objectId],!0);b&&b.call(c,a,d)},this)},deleteFeatures:function(a,b,c){return this.service.deleteFeatures(a,function(a,d){if(!a&&0<d.length)for(var f=0;f<d.length;f++)this.removeLayers([d[f].objectId],!0);b&&b.call(c,a,d)},this)}}),Ba=ka.extend({options:{cacheLayers:!0},initialize:function(a){ka.prototype.initialize.call(this,a);this._originalStyle=this.options.style;this._layers={}},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b]),this.fire("removefeature",{feature:this._layers[b].feature,permanent:!1},!0);return ka.prototype.onRemove.call(this,a)},createNewLayer:function(a){a=k.GeoJSON.geometryToLayer(a,this.options);a.defaultOptions=a.options;return a},_updateLayer:function(a,b){var c;c=this.options.coordsToLatLng||k.GeoJSON.coordsToLatLng;b.properties&&(a.feature.properties=b.properties);switch(b.geometry.type){case "Point":c=k.GeoJSON.coordsToLatLng(b.geometry.coordinates);a.setLatLng(c);break;case "LineString":c=k.GeoJSON.coordsToLatLngs(b.geometry.coordinates,0,c);a.setLatLngs(c);break;case "MultiLineString":c=k.GeoJSON.coordsToLatLngs(b.geometry.coordinates,1,c);a.setLatLngs(c);break;case "Polygon":c=k.GeoJSON.coordsToLatLngs(b.geometry.coordinates,1,c);a.setLatLngs(c);break;case "MultiPolygon":c=k.GeoJSON.coordsToLatLngs(b.geometry.coordinates,2,c),a.setLatLngs(c)}},createLayers:function(a){for(var b=a.length-1;0<=b;b--){var c=a[b],d=this._layers[c.id];this._visibleZoom()&&d&&!this._map.hasLayer(d)&&(this._map.addLayer(d),this.fire("addfeature",{feature:d.feature},!0));d&&0<this.options.simplifyFactor&&(d.setLatLngs||d.setLatLng)&&this._updateLayer(d,c);if(!d){d=this.createNewLayer(c);d.feature=c;d.addEventParent(this);if(this.options.onEachFeature)this.options.onEachFeature(d.feature,d);this._layers[d.feature.id]=d;this.setFeatureStyle(d.feature.id,this.options.style);this.fire("createfeature",{feature:d.feature},!0);this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(c))&&this._map.addLayer(d)}}},addLayers:function(a){for(var b=a.length-1;0<=b;b--){var c=this._layers[a[b]];c&&this._map.addLayer(c)}},removeLayers:function(a,b){for(var c=a.length-1;0<=c;c--){var d=a[c],f=this._layers[d];f&&(this.fire("removefeature",{feature:f.feature,permanent:b},!0),this._map.removeLayer(f));f&&b&&delete this._layers[d]}},cellEnter:function(a,b){this._visibleZoom()&&!this._zooming&&this._map&&k.Util.requestAnimFrame(k.Util.bind(function(){var a=this._cacheKey(b),c=this._cellCoordsToKey(b),a=this._cache[a];this._activeCells[c]&&a&&this.addLayers(a)},this))},cellLeave:function(a,b){this._zooming||k.Util.requestAnimFrame(k.Util.bind(function(){if(this._map){var a=this._cacheKey(b),c=this._cellCoordsToKey(b),d=this._cache[a],f=this._map.getBounds();if(!this._activeCells[c]&&d){for(var g=!0,h=0;h<d.length;h++){var e=this._layers[d[h]];e&&e.getBounds&&f.intersects(e.getBounds())&&(g=!1)}g&&this.removeLayers(d,!this.options.cacheLayers);!this.options.cacheLayers&&g&&(delete this._cache[a],delete this._cells[c],delete this._activeCells[c])}}},this))},resetStyle:function(){this.options.style=this._originalStyle;this.eachFeature(function(a){this.resetFeatureStyle(a.feature.id)},this);return this},setStyle:function(a){this.options.style=a;this.eachFeature(function(b){this.setFeatureStyle(b.feature.id,a)},this);return this},resetFeatureStyle:function(a){var b=this._layers[a],c=this._originalStyle||L.Path.prototype.options;b&&(k.Util.extend(b.options,b.defaultOptions),this.setFeatureStyle(a,c));return this},setFeatureStyle:function(a,b){var c=this._layers[a];"function"===typeof b&&(b=b(c.feature));c.setStyle&&c.setStyle(b);return this},eachActiveFeature:function(a,b){if(this._map){var c=this._map.getBounds(),d;for(d in this._layers)c.intersects(this._layers[d].getBounds())&&-1!==this._currentSnapshot.indexOf(this._layers[d].feature.id)&&a.call(b,this._layers[d])}return this},eachFeature:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getFeature:function(a){return this._layers[a]},bringToBack:function(){this.eachFeature(function(a){a.bringToBack&&a.bringToBack()})},bringToFront:function(){this.eachFeature(function(a){a.bringToFront&&a.bringToFront()})},redraw:function(a){a&&this._redraw(a);return this},_redraw:function(a){a=this._layers[a];var b=a.feature;if(a&&a.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var c=this.options.pointToLayer(b,k.latLng(b.geometry.coordinates[1],b.geometry.coordinates[0])).options.icon;a.setIcon(c)}a&&a.setStyle&&this.options.pointToLayer&&(c=this.options.pointToLayer(b,k.latLng(b.geometry.coordinates[1],b.geometry.coordinates[0])).options,this.setFeatureStyle(b.id,c));a&&a.setStyle&&this.options.style&&this.resetStyle(b.id)}});e.VERSION="2.0.8";e.Support=ba;e.options=S;e.Util=wa;e.get=W;e.post=b;e.request=a;e.Task=R;e.task=function(a){return new R(a)};e.Query=w;e.query=H;e.Find=V;e.find=t;e.Identify=da;e.identify=function(a){return new da(a)};e.IdentifyFeatures=ya;e.identifyFeatures=r;e.IdentifyImage=ia;e.identifyImage=P;e.Service=ca;e.service=function(a){return new ca(a)};e.MapService=za;e.mapService=X;e.ImageService=ma;e.imageService=Z;e.FeatureLayerService=va;e.featureLayerService=aa;e.BasemapLayer=ja;e.basemapLayer=function(a,b){return new ja(a,b)};e.TiledMapLayer=na;e.tiledMapLayer=function(a,b){return new na(a,b)};e.RasterLayer=B;e.ImageMapLayer=Aa;e.imageMapLayer=function(a,b){return new Aa(a,b)};e.DynamicMapLayer=qa;e.dynamicMapLayer=function(a,b){return new qa(a,b)};e.FeatureManager=ka;e.FeatureLayer=Ba;e.featureLayer=function(a){return new Ba(a)}});(function(e,k){"object"===typeof module&&"object"===typeof module.exports&&(exports=module.exports=k(require("leaflet")));if("object"===typeof e.navigator){if(!e.L)throw Error("L.Terraformer requires leaflet ");e.L.Terraformer=k(e.L)}})(this,function(){function e(a){return"[object Array]"===Object.prototype.toString.call(a)}function k(){var a=Array.prototype.slice.apply(arguments);console.warn&&console.warn.apply(console,a)}function l(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function c(a){if(a.type)switch(a.type){case "Point":return[a.coordinates[0],a.coordinates[1],a.coordinates[0],a.coordinates[1]];case "MultiPoint":return h(a.coordinates);case "LineString":return h(a.coordinates);case "MultiLineString":return b(a.coordinates);case "Polygon":return b(a.coordinates);case "MultiPolygon":a=a.coordinates;for(var d=null,f=null,g=null,e=null,k=0;k<a.length;k++)for(var m=a[k],l=0;l<m.length;l++)for(var x=m[l],S=0;S<x.length;S++){var q=x[S],C=q[0],q=q[1];null===d?d=C:C<d&&(d=C);null===f?f=C:C>f&&(f=C);null===g?g=q:q<g&&(g=q);null===e?e=q:q>e&&(e=q)}return[d,g,f,e];case "Feature":return a.geometry?c(a.geometry):null;case "FeatureCollection":d=[];for(g=a.features.length-1;0<=g;g--)f=c(a.features[g].geometry),d.push([f[0],f[1]]),d.push([f[2],f[3]]);return h(d);case "GeometryCollection":d=[];for(g=a.geometries.length-1;0<=g;g--)f=c(a.geometries[g]),d.push([f[0],f[1]]),d.push([f[2],f[3]]);return h(d);default:throw Error("Unknown type: "+a.type);}return null}function b(a){for(var b=null,c=null,d=null,f=null,g=0;g<a.length;g++)for(var h=a[g],e=0;e<h.length;e++){var k=h[e],m=k[0],k=k[1];null===b?b=m:m<b&&(b=m);null===c?c=m:m>c&&(c=m);null===d?d=k:k<d&&(d=k);null===f?f=k:k>f&&(f=k)}return[b,d,c,f]}function h(a){for(var b=null,c=null,d=null,f=null,g=0;g<a.length;g++){var h=a[g],e=h[0],h=h[1];null===b?b=e:e<b&&(b=e);null===c?c=e:e>c&&(c=e);null===d?d=h:h<d&&(d=h);null===f?f=h:h>f&&(f=h)}return[b,d,c,f]}function a(a){a=c(a);return{x:a[0],y:a[1],w:Math.abs(a[0]-a[2]),h:Math.abs(a[1]-a[3])}}function d(a,b){for(var c=0;c<a.length;c++)"number"===typeof a[c][0]&&(a[c]=b(a[c])),"object"===typeof a[c]&&(a[c]=d(a[c],b));return a}function g(a){var b=a[0];return[b/6378137*57.29577951308232-360*Math.floor((b/6378137*57.29577951308232+180)/360),57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-1*a[1]/6378137)))]}function f(a){var b=Math.max(Math.min(a[1],89.99999),-89.99999);return[111319.49079327169*a[0],3189068.5*Math.log((1+Math.sin(.017453292519943*b))/(1-Math.sin(.017453292519943*b)))]}function m(a,b,c){if("Point"===a.type)a.coordinates=b(a.coordinates);else if("Feature"===a.type)a.geometry=m(a.geometry,b,!0);else if("FeatureCollection"===a.type)for(var h=0;h<a.features.length;h++)a.features[h]=m(a.features[h],b,!0);else if("GeometryCollection"===a.type)for(h=0;h<a.geometries.length;h++)a.geometries[h]=m(a.geometries[h],b,!0);else a.coordinates=d(a.coordinates,b);c||b!==f||(a.crs=Y);b===g&&delete a.crs;return a}function x(a){return m(a,f)}function C(a){return m(a,g)}function v(a,b){return a[0]>b[0]?-1:a[0]<b[0]?1:a[1]>b[1]?-1:a[1]<b[1]?1:0}function q(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d}function u(a){if(0===a.length)return[];if(1===a.length)return a;for(var b=[a.sort(v)[0]],c=0;c<b.length;c++){var d;d=a;var f=b[c],g=f,h=void 0;for(h in d){var e;e=d[h];e=(g[0]-f[0])*(e[1]-f[1])-(e[0]-f[0])*(g[1]-f[1]);e=0>e?-1:0<e?1:0;if(-1===e||0===e&&q(f,d[h])>q(f,g))g=d[h]}d=g;d!==b[0]&&b.push(d)}return b}function y(a,b){for(var c=!1,d=-1,f=a.length,g=f-1;++d<f;g=d)(a[d][1]<=b[1]&&b[1]<a[g][1]||a[g][1]<=b[1]&&b[1]<a[d][1])&&b[0]<(a[g][0]-a[d][0])*(b[1]-a[d][1])/(a[g][1]-a[d][1])+a[d][0]&&(c=!c);return c}function z(a,b){if(a&&a.length){if(1===a.length)return y(a[0],b);if(y(a[0],b)){for(var c=1;c<a.length;c++)if(y(a[c],b))return!1;return!0}}return!1}function F(a){return!isNaN(parseFloat(a))&&isFinite(a)}function D(a,b){if(F(a[0][0]))if(F(b[0][0]))for(var c=0;c<a.length-1;c++)for(var d=0;d<b.length-1;d++){var f;a:{var g=a[c],h=a[c+1],e=b[d],k=b[d+1],m=(k[0]-e[0])*(g[1]-e[1])-(k[1]-e[1])*(g[0]-e[0]);f=(h[0]-g[0])*(g[1]-e[1])-(h[1]-g[1])*(g[0]-e[0]);g=(k[1]-e[1])*(h[0]-g[0])-(k[0]-e[0])*(h[1]-g[1]);if(0!==g&&(m/=g,f/=g,0<=m&&1>=m&&0<=f&&1>=f)){f=!0;break a}f=!1}if(f)return!0}else for(c=0;c<b.length;c++){if(D(a,b[c]))return!0}else for(c=0;c<a.length;c++)if(D(a[c],b))return!0;return!1}function N(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].slice();!1===M(d[0],d[d.length-1])&&d.push(d[0]);b.push(d)}return b}function M(a,b){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function U(a,b){if(a.length!==b.length)return!1;for(var c=a.slice().sort(v),d=b.slice().sort(v),f=0;f<c.length;f++){if(c[f].length!==d[f].length)return!1;for(var g=0;g<c.length;g++)if(c[f][g]!==d[f][g])return!1}return!0}function A(a){if(a)switch(a.type){case "Point":return new G(a);case "MultiPoint":return new J(a);case "LineString":return new H(a);case "MultiLineString":return new t(a);case "Polygon":return new r(a);case "MultiPolygon":return new P(a);case "Feature":return new X(a);case "FeatureCollection":return new Z(a);case "GeometryCollection":return new aa(a);default:throw Error("Unknown type: "+a.type);}}function G(a){var b=Array.prototype.slice.call(arguments);if(a&&"Point"===a.type&&a.coordinates)l(this,a);else if(a&&e(a))this.coordinates=a;else if(2<=b.length)this.coordinates=b;else throw"Terraformer: invalid input for Terraformer.Point";this.type="Point"}function J(a){if(a&&"MultiPoint"===a.type&&a.coordinates)l(this,a);else if(e(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.MultiPoint";this.type="MultiPoint"}function H(a){if(a&&"LineString"===a.type&&a.coordinates)l(this,a);else if(e(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.LineString";this.type="LineString"}function t(a){if(a&&"MultiLineString"===a.type&&a.coordinates)l(this,a);else if(e(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.MultiLineString";this.type="MultiLineString"}function r(a){if(a&&"Polygon"===a.type&&a.coordinates)l(this,a);else if(e(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.Polygon";this.type="Polygon"}function P(a){if(a&&"MultiPolygon"===a.type&&a.coordinates)l(this,a);else if(e(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.MultiPolygon";this.type="MultiPolygon"}function X(a){if(a&&"Feature"===a.type)l(this,a);else if(a&&a.type&&a.coordinates)this.geometry=a;else throw"Terraformer: invalid input for Terraformer.Feature";this.type="Feature"}function Z(a){if(a&&"FeatureCollection"===a.type&&a.features)l(this,a);else if(e(a))this.features=a;else throw"Terraformer: invalid input for Terraformer.FeatureCollection";this.type="FeatureCollection"}function aa(a){if(a&&"GeometryCollection"===a.type&&a.geometries)l(this,a);else if(e(a))this.geometries=a;else if(a.coordinates&&a.type)this.type="GeometryCollection",this.geometries=[a];else throw"Terraformer: invalid input for Terraformer.GeometryCollection";this.type="GeometryCollection"}function Q(a,b,c){a=f(a);c=c||64;for(var d={type:"Polygon",coordinates:[[]]},g=1;g<=c;g++){var h=360/c*g*Math.PI/180;d.coordinates[0].push([a[0]+b*Math.cos(h),a[1]+b*Math.sin(h)])}d.coordinates=N(d.coordinates);return C(d)}function I(a,b,c){c=c||64;b=b||250;if(!a||2>a.length||!b||!c)throw Error("Terraformer: missing parameter for Terraformer.Circle");l(this,new X({type:"Feature",geometry:Q(a,b,c),properties:{radius:b,center:a,steps:c}}))}var B={},Y={type:"link",properties:{href:"http://spatialreference.org/ref/sr-org/6928/ogcwkt/",type:"ogcwkt"}},ba=["length"];A.prototype.toMercator=function(){return x(this)};A.prototype.toGeographic=function(){return C(this)};A.prototype.envelope=function(){return a(this)};A.prototype.bbox=function(){return c(this)};A.prototype.convexHull=function(){var a=[],b,c;if("Point"===this.type)return null;if("LineString"===this.type||"MultiPoint"===this.type)if(this.coordinates&&3<=this.coordinates.length)a=this.coordinates;else return null;else if("Polygon"===this.type||"MultiLineString"===this.type)if(this.coordinates&&0<this.coordinates.length){for(b=0;b<this.coordinates.length;b++)a=a.concat(this.coordinates[b]);if(3>a.length)return null}else return null;else if("MultiPolygon"===this.type)if(this.coordinates&&0<this.coordinates.length){for(b=0;b<this.coordinates.length;b++)for(c=0;c<this.coordinates[b].length;c++)a=a.concat(this.coordinates[b][c]);if(3>a.length)return null}else return null;else if("Feature"===this.type)return(new A(this.geometry)).convexHull();return new r({type:"Polygon",coordinates:N([u(a)])})};A.prototype.toJSON=function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&-1===ba.indexOf(b)&&(a[b]=this[b]);a.bbox=c(this);return a};A.prototype.contains=function(a){return(new A(a)).within(this)};A.prototype.within=function(a){var b,c;"Feature"===a.type&&(a=a.geometry);if("Point"===a.type&&"Point"===this.type)return M(this.coordinates,a.coordinates);if("MultiLineString"===a.type&&"Point"===this.type)for(c=0;c<a.coordinates.length;c++)if(this.within({type:"LineString",coordinates:a.coordinates[c]}))return!0;if(("LineString"===a.type||"MultiPoint"===a.type)&&"Point"===this.type)for(c=0;c<a.coordinates.length;c++){if(this.coordinates.length!==a.coordinates[c].length)return!1;if(M(this.coordinates,a.coordinates[c]))return!0}if("Polygon"===a.type){if("Polygon"===this.type){if(a.coordinates.length===this.coordinates.length)for(c=0;c<this.coordinates.length;c++)if(U(this.coordinates[c],a.coordinates[c]))return!0;return this.coordinates.length&&z(a.coordinates,this.coordinates[0][0])?!D(N(this.coordinates),N(a.coordinates)):!1}if("Point"===this.type)return z(a.coordinates,this.coordinates);if("LineString"===this.type||"MultiPoint"===this.type){if(!this.coordinates||0===this.coordinates.length)return!1;for(c=0;c<this.coordinates.length;c++)if(!1===z(a.coordinates,this.coordinates[c]))return!1;return!0}if("MultiLineString"===this.type){for(c=0;c<this.coordinates.length;c++)if(!1===(new H(this.coordinates[c])).within(a))return!1;return!0}if("MultiPolygon"===this.type){for(c=0;c<this.coordinates.length;c++)if(!1===(new A({type:"Polygon",coordinates:this.coordinates[c]})).within(a))return!1;return!0}}if("MultiPolygon"===a.type)if("Point"===this.type){if(a.coordinates.length)for(c=0;c<a.coordinates.length;c++)if(b=a.coordinates[c],z(b,this.coordinates)&&!1===D([this.coordinates],a.coordinates))return!0}else if("Polygon"===this.type){for(c=0;c<this.coordinates.length;c++)if(a.coordinates[c].length===this.coordinates.length)for(j=0;j<this.coordinates.length;j++)if(U(this.coordinates[j],a.coordinates[c][j]))return!0;if(!1===D(this.coordinates,a.coordinates)&&a.coordinates.length){for(c=0;c<a.coordinates.length;c++)b=a.coordinates[c],b=!1===z(b,this.coordinates[0][0])?!1:!0;return b}}else if("LineString"===this.type||"MultiPoint"===this.type)for(c=0;c<a.coordinates.length;){if(this.within({type:"Polygon",coordinates:a.coordinates[c]}))return!0;break}else{if("MultiLineString"===this.type){for(c=0;c<this.coordinates.length;c++)if(!1===(new H(this.coordinates[c])).within(a))return!1;return!0}if("MultiPolygon"===this.type){for(c=0;c<a.coordinates.length;c++)if(!1===this.within({type:"Polygon",coordinates:a.coordinates[c]}))return!1;return!0}}return!1};A.prototype.intersects=function(a){"Feature"===a.type&&(a=a.geometry);var b=new A(a);if(this.within(a)||b.within(this))return!0;if("Point"!==this.type&&"MultiPoint"!==this.type&&"Point"!==a.type&&"MultiPoint"!==a.type)return D(this.coordinates,a.coordinates);if("Feature"===this.type)return(new A(this.geometry)).intersects(a);k("Type "+this.type+" to "+a.type+" intersection is not supported by intersects");return!1};G.prototype=new A;G.prototype.constructor=G;J.prototype=new A;J.prototype.constructor=J;J.prototype.forEach=function(a){for(var b=0;b<this.coordinates.length;b++)a.apply(this,[this.coordinates[b],b,this.coordinates]);return this};J.prototype.addPoint=function(a){this.coordinates.push(a);return this};J.prototype.insertPoint=function(a,b){this.coordinates.splice(b,0,a);return this};J.prototype.removePoint=function(a){"number"===typeof a?this.coordinates.splice(a,1):this.coordinates.splice(this.coordinates.indexOf(a),1);return this};J.prototype.get=function(a){return new G(this.coordinates[a])};H.prototype=new A;H.prototype.constructor=H;H.prototype.addVertex=function(a){this.coordinates.push(a);return this};H.prototype.insertVertex=function(a,b){this.coordinates.splice(b,0,a);return this};H.prototype.removeVertex=function(a){this.coordinates.splice(a,1);return this};t.prototype=new A;t.prototype.constructor=t;t.prototype.forEach=function(a){for(var b=0;b<this.coordinates.length;b++)a.apply(this,[this.coordinates[b],b,this.coordinates])};t.prototype.get=function(a){return new H(this.coordinates[a])};r.prototype=new A;r.prototype.constructor=r;r.prototype.addVertex=function(a){this.insertVertex(a,this.coordinates[0].length-1);return this};r.prototype.insertVertex=function(a,b){this.coordinates[0].splice(b,0,a);return this};r.prototype.removeVertex=function(a){this.coordinates[0].splice(a,1);return this};r.prototype.close=function(){this.coordinates=N(this.coordinates)};r.prototype.hasHoles=function(){return 1<this.coordinates.length};r.prototype.holes=function(){holes=[];if(this.hasHoles())for(var a=1;a<this.coordinates.length;a++)holes.push(new r([this.coordinates[a]]));return holes};P.prototype=new A;P.prototype.constructor=P;P.prototype.forEach=function(a){for(var b=0;b<this.coordinates.length;b++)a.apply(this,[this.coordinates[b],b,this.coordinates])};P.prototype.get=function(a){return new r(this.coordinates[a])};P.prototype.close=function(){var a=[];this.forEach(function(b){a.push(N(b))});this.coordinates=a;return this};X.prototype=new A;X.prototype.constructor=X;Z.prototype=new A;Z.prototype.constructor=Z;Z.prototype.forEach=function(a){for(var b=0;b<this.features.length;b++)a.apply(this,[this.features[b],b,this.features])};Z.prototype.get=function(a){var b;this.forEach(function(c){c.id===a&&(b=c)});return new X(b)};aa.prototype=new A;aa.prototype.constructor=aa;aa.prototype.forEach=function(a){for(var b=0;b<this.geometries.length;b++)a.apply(this,[this.geometries[b],b,this.geometries])};aa.prototype.get=function(a){return new A(this.geometries[a])};I.prototype=new A;I.prototype.constructor=I;I.prototype.recalculate=function(){this.geometry=Q(this.properties.center,this.properties.radius,this.properties.steps);return this};I.prototype.center=function(a){a&&(this.properties.center=a,this.recalculate());return this.properties.center};I.prototype.radius=function(a){a&&(this.properties.radius=a,this.recalculate());return this.properties.radius};I.prototype.steps=function(a){a&&(this.properties.steps=a,this.recalculate());return this.properties.steps};I.prototype.toJSON=function(){return A.prototype.toJSON.call(this)};B.Primitive=A;B.Point=G;B.MultiPoint=J;B.LineString=H;B.MultiLineString=t;B.Polygon=r;B.MultiPolygon=P;B.Feature=X;B.FeatureCollection=Z;B.GeometryCollection=aa;B.Circle=I;B.toMercator=x;B.toGeographic=C;B.Tools={};B.Tools.positionToMercator=f;B.Tools.positionToGeographic=g;B.Tools.applyConverter=m;B.Tools.toMercator=x;B.Tools.toGeographic=C;B.Tools.createCircle=Q;B.Tools.calculateBounds=c;B.Tools.calculateEnvelope=a;B.Tools.coordinatesContainPoint=y;B.Tools.polygonContainsPoint=z;B.Tools.arraysIntersectArrays=D;B.Tools.coordinatesContainPoint=y;B.Tools.coordinatesEqual=U;B.Tools.convexHull=u;B.Tools.isConvex=function(a){for(var b,c=0;c<a.length-3;c++){var d=a[c],f=a[c+1],g=a[c+2],f=[f[0]-d[0],f[1]-d[1]],d=g[0]*f[1]-g[1]*f[0]+f[0]*d[1]-f[1]*d[0];if(0===c)b=0>d?!0:!1;else if(b&&0<d||!b&&0>d)return!1}return!0};B.MercatorCRS=Y;B.GeographicCRS={type:"link",properties:{href:"http://spatialreference.org/ref/epsg/4326/ogcwkt/",type:"ogcwkt"}};return B});(function(e,k){"object"===typeof module&&"object"===typeof module.exports&&(exports=module.exports=k(require("L.Terraformer")));if("object"===typeof e.navigator){if(!e.L.Terraformer)throw Error("L.Terraformer.ArcGIS requires the core L.Terraformer library");e.L.Terraformer.ArcGIS=k(e.L.Terraformer)}})(this,function(e){function k(a){var b=0,c=0,d=[],f,g,h;g=a.match(/((\+|\-)[^\+\-]+)/g);h=parseInt(g[0],32);for(var e=1;e<g.length;e+=2)b=a=parseInt(g[e],32)+b,c=f=parseInt(g[e+1],32)+c,d.push([a/h,f/h]);return d}function l(a){var b;a:{b=a[0];for(var c=0;c<b.length;c++)if(b[c]!==a[a.length-1][c]){b=!1;break a}b=!0}b||a.push(a[0]);return a}function c(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function b(a){var b=0,c=0,d=a.length,f=a[c],g;for(c;c<d-1;c++)g=a[c+1],b+=(g[0]-f[0])*(g[1]+f[1]),f=g;return 0<=b}function h(a){var c=[];a=a.slice(0);var d=l(a.shift().slice(0));if(4<=d.length)for(b(d)||d.reverse(),c.push(d),d=0;d<a.length;d++){var f=l(a[d].slice(0));4<=f.length&&(b(f)&&f.reverse(),c.push(f))}return c}function a(d,g){var f={};g=g||{};g.idAttribute=g.idAttribute||void 0;"number"===typeof d.x&&"number"===typeof d.y&&(f.type="Point",f.coordinates=[d.x,d.y],(d.z||d.m)&&f.coordinates.push(d.z),d.m&&f.coordinates.push(d.m));d.points&&(f.type="MultiPoint",f.coordinates=d.points.slice(0));d.paths&&(1===d.paths.length?(f.type="LineString",f.coordinates=d.paths[0].slice(0)):(f.type="MultiLineString",f.coordinates=d.paths.slice(0)));if(d.rings){var h=d.rings.slice(0),f=[],m=[],q,u;for(u=0;u<h.length;u++){var y=l(h[u].slice(0));4>y.length||(b(y)?f.push([y]):m.push(y))}for(y=[];m.length;){u=m.pop();for(var z=!1,h=f.length-1;0<=h;h--){var F=q=f[h][0],D=u;q=e.Tools.arraysIntersectArrays(F,D);F=e.Tools.coordinatesContainPoint(F,D[0]);if(!q&&F){f[h].push(u);z=!0;break}}z||y.push(u)}for(;y.length;){u=y.pop();m=!1;for(h=f.length-1;0<=h;h--)if(q=f[h][0],e.Tools.arraysIntersectArrays(q,u)){f[h].push(u);m=!0;break}m||f.push([u.reverse()])}f=1===f.length?{type:"Polygon",coordinates:f[0]}:{type:"MultiPolygon",coordinates:f}}if(d.compressedGeometry||d.geometry||d.attributes)f.type="Feature",d.compressedGeometry&&(d.geometry={paths:[k(d.compressedGeometry)]}),f.geometry=d.geometry?a(d.geometry):null,f.properties=d.attributes?c(d.attributes):null,d.attributes&&(f.id=d.attributes[g.idAttribute]||d.attributes.OBJECTID||d.attributes.FID);(m=d.geometry?d.geometry.spatialReference:d.spatialReference)&&102100===m.wkid&&(f=e.toGeographic(f));return new e.Primitive(f)}function d(a,b){var f;b=b||{};var g=b.idAttribute||"OBJECTID";f=b.sr?{wkid:b.sr}:a&&a.crs===e.MercatorCRS?{wkid:102100}:{wkid:4326};var k={};switch(a.type){case "Point":k.x=a.coordinates[0];k.y=a.coordinates[1];a.coordinates[2]&&(k.z=a.coordinates[2]);a.coordinates[3]&&(k.m=a.coordinates[3]);k.spatialReference=f;break;case "MultiPoint":k.points=a.coordinates.slice(0);k.spatialReference=f;break;case "LineString":k.paths=[a.coordinates.slice(0)];k.spatialReference=f;break;case "MultiLineString":k.paths=a.coordinates.slice(0);k.spatialReference=f;break;case "Polygon":k.rings=h(a.coordinates.slice(0));k.spatialReference=f;break;case "MultiPolygon":for(var g=k,m=a.coordinates.slice(0),l=[],y=0;y<m.length;y++)for(var z=h(m[y]),F=z.length-1;0<=F;F--){var D=z[F].slice(0);l.push(D)}g.rings=l;k.spatialReference=f;break;case "Feature":a.geometry&&(k.geometry=d(a.geometry,b));k.attributes=a.properties?c(a.properties):{};a.id&&(k.attributes[g]=a.id);break;case "FeatureCollection":k=[];for(f=0;f<a.features.length;f++)k.push(d(a.features[f],b));break;case "GeometryCollection":for(k=[],f=0;f<a.geometries.length;f++)k.push(d(a.geometries[f],b))}return k}var g={};g.parse=a;g.convert=d;g.toGeoJSON=a;g.fromGeoJSON=d;g.parseCompressedGeometry=function(a){return new e.LineString(k(a))};return g});(function(e,k){if("object"===typeof module&&"object"===typeof module.exports)exports=module.exports=k(require("L.Terraformer"));else if("object"===typeof navigator){if(!e.L.Terraformer)throw Error("L.Terraformer.WKT requires the core L.Terraformer library. ");e.L.Terraformer.WKT=k(e.L.Terraformer)}})(this,function(e){function k(a){this.data=[a];this.type="PointArray"}function l(a){this.data=a;this.type="Ring"}function c(a){this.data=[a];this.type="RingList"}function b(a){this.data=[a];this.type="PolygonList"}function h(a){for(var b=[],c="",d=0;d<a.length;d++)b.push(a[d].join(" "));return c+="("+b.join(", ")+")"}var a={},d=function(){function a(){this.yy={}}var d={trace:function(){},yy:{},symbols_:{error:2,expressions:3,point:4,EOF:5,linestring:6,polygon:7,multipoint:8,multilinestring:9,multipolygon:10,coordinate:11,DOUBLE_TOK:12,ptarray:13,COMMA:14,ring_list:15,ring:16,"(":17,")":18,POINT:19,Z:20,ZM:21,M:22,EMPTY:23,point_untagged:24,polygon_list:25,polygon_untagged:26,point_list:27,LINESTRING:28,POLYGON:29,MULTIPOINT:30,MULTILINESTRING:31,MULTIPOLYGON:32,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"DOUBLE_TOK",14:"COMMA",17:"(",18:")",19:"POINT",20:"Z",21:"ZM",22:"M",23:"EMPTY",28:"LINESTRING",29:"POLYGON",30:"MULTIPOINT",31:"MULTILINESTRING",32:"MULTIPOLYGON"},productions_:[0,[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[11,2],[11,3],[11,4],[13,3],[13,1],[15,3],[15,1],[16,3],[4,4],[4,5],[4,5],[4,5],[4,2],[24,1],[24,3],[25,3],[25,1],[26,3],[27,3],[27,1],[6,4],[6,5],[6,5],[6,5],[6,2],[7,4],[7,5],[7,5],[7,5],[7,2],[8,4],[8,5],[8,5],[8,5],[8,2],[9,4],[9,5],[9,5],[9,5],[9,2],[10,4],[10,5],[10,5],[10,5],[10,2]],performAction:function(a,d,f,g,h,e,m){a=e.length-1;switch(h){case 1:return e[a-1];case 2:return e[a-1];case 3:return e[a-1];case 4:return e[a-1];case 5:return e[a-1];case 6:return e[a-1];case 7:this.$=new k([Number(e[a-1]),Number(e[a])]);break;case 8:this.$=new k([Number(e[a-2]),Number(e[a-1]),Number(e[a])]);break;case 9:this.$=new k([Number(e[a-3]),Number(e[a-2]),Number(e[a-1]),Number(e[a])]);break;case 10:this.$=e[a-2].addPoint(e[a]);break;case 11:this.$=e[a];break;case 12:this.$=e[a-2].addRing(e[a]);break;case 13:this.$=new c(e[a]);break;case 14:this.$=new l(e[a-1]);break;case 15:this.$={type:"Point",coordinates:e[a-1].data[0]};break;case 16:this.$={type:"Point",coordinates:e[a-1].data[0],properties:{z:!0}};break;case 17:this.$={type:"Point",coordinates:e[a-1].data[0],properties:{z:!0,m:!0}};break;case 18:this.$={type:"Point",coordinates:e[a-1].data[0],properties:{m:!0}};break;case 19:this.$={type:"Point",coordinates:[]};break;case 20:this.$=e[a];break;case 21:this.$=e[a-1];break;case 22:this.$=e[a-2].addPolygon(e[a]);break;case 23:this.$=new b(e[a]);break;case 24:this.$=e[a-1];break;case 25:this.$=e[a-2].addPoint(e[a]);break;case 26:this.$=e[a];break;case 27:this.$={type:"LineString",coordinates:e[a-1].data};break;case 28:this.$={type:"LineString",coordinates:e[a-1].data,properties:{z:!0}};break;case 29:this.$={type:"LineString",coordinates:e[a-1].data,properties:{m:!0}};break;case 30:this.$={type:"LineString",coordinates:e[a-1].data,properties:{z:!0,m:!0}};break;case 31:this.$={type:"LineString",coordinates:[]};break;case 32:this.$={type:"Polygon",coordinates:e[a-1].toJSON()};break;case 33:this.$={type:"Polygon",coordinates:e[a-1].toJSON(),properties:{z:!0}};break;case 34:this.$={type:"Polygon",coordinates:e[a-1].toJSON(),properties:{m:!0}};break;case 35:this.$={type:"Polygon",coordinates:e[a-1].toJSON(),properties:{z:!0,m:!0}};break;case 36:this.$={type:"Polygon",coordinates:[]};break;case 37:this.$={type:"MultiPoint",coordinates:e[a-1].data};break;case 38:this.$={type:"MultiPoint",coordinates:e[a-1].data,properties:{z:!0}};break;case 39:this.$={type:"MultiPoint",coordinates:e[a-1].data,properties:{m:!0}};break;case 40:this.$={type:"MultiPoint",coordinates:e[a-1].data,properties:{z:!0,m:!0}};break;case 41:this.$={type:"MultiPoint",coordinates:[]};break;case 42:this.$={type:"MultiLineString",coordinates:e[a-1].toJSON()};break;case 43:this.$={type:"MultiLineString",coordinates:e[a-1].toJSON(),properties:{z:!0}};break;case 44:this.$={type:"MultiLineString",coordinates:e[a-1].toJSON(),properties:{m:!0}};break;case 45:this.$={type:"MultiLineString",coordinates:e[a-1].toJSON(),properties:{z:!0,m:!0}};break;case 46:this.$={type:"MultiLineString",coordinates:[]};break;case 47:this.$={type:"MultiPolygon",coordinates:e[a-1].toJSON()};break;case 48:this.$={type:"MultiPolygon",coordinates:e[a-1].toJSON(),properties:{z:!0}};break;case 49:this.$={type:"MultiPolygon",coordinates:e[a-1].toJSON(),properties:{m:!0}};break;case 50:this.$={type:"MultiPolygon",coordinates:e[a-1].toJSON(),properties:{z:!0,m:!0}};break;case 51:this.$={type:"MultiPolygon",coordinates:[]}}},table:[{3:1,4:2,6:3,7:4,8:5,9:6,10:7,19:[1,8],28:[1,9],29:[1,10],30:[1,11],31:[1,12],32:[1,13]},{1:[3]},{5:[1,14]},{5:[1,15]},{5:[1,16]},{5:[1,17]},{5:[1,18]},{5:[1,19]},{17:[1,20],20:[1,21],21:[1,22],22:[1,23],23:[1,24]},{17:[1,25],20:[1,26],21:[1,28],22:[1,27],23:[1,29]},{17:[1,30],20:[1,31],21:[1,33],22:[1,32],23:[1,34]},{17:[1,35],20:[1,36],21:[1,38],22:[1,37],23:[1,39]},{17:[1,40],20:[1,41],21:[1,43],22:[1,42],23:[1,44]},{17:[1,45],20:[1,46],21:[1,48],22:[1,47],23:[1,49]},{1:[2,1]},{1:[2,2]},{1:[2,3]},{1:[2,4]},{1:[2,5]},{1:[2,6]},{11:51,12:[1,52],13:50},{17:[1,53]},{17:[1,54]},{17:[1,55]},{5:[2,19]},{11:58,12:[1,52],17:[1,59],24:57,27:56},{17:[1,60]},{17:[1,61]},{17:[1,62]},{5:[2,31]},{15:63,16:64,17:[1,65]},{17:[1,66]},{17:[1,67]},{17:[1,68]},{5:[2,36]},{11:58,12:[1,52],17:[1,59],24:57,27:69},{17:[1,70]},{17:[1,71]},{17:[1,72]},{5:[2,41]},{15:73,16:64,17:[1,65]},{17:[1,74]},{17:[1,75]},{17:[1,76]},{5:[2,46]},{17:[1,79],25:77,26:78},{17:[1,80]},{17:[1,81]},{17:[1,82]},{5:[2,51]},{14:[1,84],18:[1,83]},{14:[2,11],18:[2,11]},{12:[1,85]},{11:51,12:[1,52],13:86},{11:51,12:[1,52],13:87},{11:51,12:[1,52],13:88},{14:[1,90],18:[1,89]},{14:[2,26],18:[2,26]},{14:[2,20],18:[2,20]},{11:91,12:[1,52]},{11:58,12:[1,52],17:[1,59],24:57,27:92},{11:58,12:[1,52],17:[1,59],24:57,27:93},{11:58,12:[1,52],17:[1,59],24:57,27:94},{14:[1,96],18:[1,95]},{14:[2,13],18:[2,13]},{11:51,12:[1,52],13:97},{15:98,16:64,17:[1,65]},{15:99,16:64,17:[1,65]},{15:100,16:64,17:[1,65]},{14:[1,90],18:[1,101]},{11:58,12:[1,52],17:[1,59],24:57,27:102},{11:58,12:[1,52],17:[1,59],24:57,27:103},{11:58,12:[1,52],17:[1,59],24:57,27:104},{14:[1,96],18:[1,105]},{15:106,16:64,17:[1,65]},{15:107,16:64,17:[1,65]},{15:108,16:64,17:[1,65]},{14:[1,110],18:[1,109]},{14:[2,23],18:[2,23]},{15:111,16:64,17:[1,65]},{17:[1,79],25:112,26:78},{17:[1,79],25:113,26:78},{17:[1,79],25:114,26:78},{5:[2,15]},{11:115,12:[1,52]},{12:[1,116],14:[2,7],18:[2,7]},{14:[1,84],18:[1,117]},{14:[1,84],18:[1,118]},{14:[1,84],18:[1,119]},{5:[2,27]},{11:58,12:[1,52],17:[1,59],24:120},{18:[1,121]},{14:[1,90],18:[1,122]},{14:[1,90],18:[1,123]},{14:[1,90],18:[1,124]},{5:[2,32]},{16:125,17:[1,65]},{14:[1,84],18:[1,126]},{14:[1,96],18:[1,127]},{14:[1,96],18:[1,128]},{14:[1,96],18:[1,129]},{5:[2,37]},{14:[1,90],18:[1,130]},{14:[1,90],18:[1,131]},{14:[1,90],18:[1,132]},{5:[2,42]},{14:[1,96],18:[1,133]},{14:[1,96],18:[1,134]},{14:[1,96],18:[1,135]},{5:[2,47]},{17:[1,79],26:136},{14:[1,96],18:[1,137]},{14:[1,110],18:[1,138]},{14:[1,110],18:[1,139]},{14:[1,110],18:[1,140]},{14:[2,10],18:[2,10]},{12:[1,141],14:[2,8],18:[2,8]},{5:[2,16]},{5:[2,17]},{5:[2,18]},{14:[2,25],18:[2,25]},{14:[2,21],18:[2,21]},{5:[2,28]},{5:[2,29]},{5:[2,30]},{14:[2,12],18:[2,12]},{14:[2,14],18:[2,14]},{5:[2,33]},{5:[2,34]},{5:[2,35]},{5:[2,38]},{5:[2,39]},{5:[2,40]},{5:[2,43]},{5:[2,44]},{5:[2,45]},{14:[2,22],18:[2,22]},{14:[2,24],18:[2,24]},{5:[2,48]},{5:[2,49]},{5:[2,50]},{14:[2,9],18:[2,9]}],defaultActions:{14:[2,1],15:[2,2],16:[2,3],17:[2,4],18:[2,5],19:[2,6],24:[2,19],29:[2,31],34:[2,36],39:[2,41],44:[2,46],49:[2,51],83:[2,15],89:[2,27],95:[2,32],101:[2,37],105:[2,42],109:[2,47],117:[2,16],118:[2,17],119:[2,18],122:[2,28],123:[2,29],124:[2,30],127:[2,33],128:[2,34],129:[2,35],130:[2,38],131:[2,39],132:[2,40],133:[2,43],134:[2,44],135:[2,45],138:[2,48],139:[2,49],140:[2,50]},parseError:function(a,b){throw Error(a);},parse:function(a){var b=[0],c=[null],d=[],f=this.table,g="",h=0,e=0,k=0;this.lexer.setInput(a);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});a=this.lexer.yylloc;d.push(a);var m=this.lexer.options&&this.lexer.options.ranges;"function"===typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var l,x,A,G,J={},H,t;;){A=b[b.length-1];if(this.defaultActions[A])G=this.defaultActions[A];else{if(null===l||"undefined"==typeof l)l=this.lexer.lex()||1,"number"!==typeof l&&(l=this.symbols_[l]||l);G=f[A]&&f[A][l]}if("undefined"===typeof G||!G.length||!G[0]){var r;if(!k){t=[];for(H in f[A])this.terminals_[H]&&2<H&&t.push("'"+this.terminals_[H]+"'");r=this.lexer.showPosition?"Parse error on line "+(h+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+t.join(", ")+", got '"+(this.terminals_[l]||l)+"'":"Parse error on line "+(h+1)+": Unexpected "+(1==l?"end of input":"'"+(this.terminals_[l]||l)+"'");this.parseError(r,{text:this.lexer.match,token:this.terminals_[l]||l,line:this.lexer.yylineno,loc:a,expected:t})}}if(G[0]instanceof Array&&1<G.length)throw Error("Parse Error: multiple actions possible at state: "+A+", token: "+l);switch(G[0]){case 1:b.push(l);c.push(this.lexer.yytext);d.push(this.lexer.yylloc);b.push(G[1]);l=null;x?(l=x,x=null):(e=this.lexer.yyleng,g=this.lexer.yytext,h=this.lexer.yylineno,a=this.lexer.yylloc,0<k&&k--);break;case 2:t=this.productions_[G[1]][1];J.$=c[c.length-t];J._$={first_line:d[d.length-(t||1)].first_line,last_line:d[d.length-1].last_line,first_column:d[d.length-(t||1)].first_column,last_column:d[d.length-1].last_column};m&&(J._$.range=[d[d.length-(t||1)].range[0],d[d.length-1].range[1]]);A=this.performAction.call(J,g,e,h,this.yy,G[1],c,d);if("undefined"!==typeof A)return A;t&&(b=b.slice(0,-2*t),c=c.slice(0,-1*t),d=d.slice(0,-1*t));b.push(this.productions_[G[1]][0]);c.push(J.$);d.push(J._$);G=f[b[b.length-2]][b[b.length-1]];b.push(G);break;case 3:return!0}}}};void 0;var h=function(){return{EOF:1,parseError:function(a,b){if(this.yy.parser)this.yy.parser.parseError(a,b);else throw Error(a);},setInput:function(a){this._input=a;this._more=this._less=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var a=this._input[0];this.yytext+=a;this.yyleng++;this.offset++;this.match+=a;this.matched+=a;a.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-b-1);this.offset-=b;a=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);c.length-1&&(this.yylineno-=c.length-1);var d=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===a.length?this.yylloc.first_column:0)+a[a.length-c.length].length-c[0].length:this.yylloc.first_column-b};this.options.ranges&&(this.yylloc.range=[d[0],d[0]+this.yyleng-b]);return this},more:function(){this._more=!0;return this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(20<a.length?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;20>a.length&&(a+=this._input.substr(0,20-a.length));return(a.substr(0,20)+(20<a.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c;this._more||(this.match=this.yytext="");for(var d=this._currentRules(),f=0;f<d.length&&(!(b=this._input.match(this.rules[d[f]]))||a&&!(b[0].length>a[0].length)||(a=b,c=f,this.options.flex));f++);if(a){if(b=a[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=b.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:b?b[b.length-1].length-b[b.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length};this.yytext+=a[0];this.match+=a[0];this.matches=a;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._more=!1;this._input=this._input.slice(a[0].length);this.matched+=a[0];a=this.performAction.call(this,this.yy,this,d[c],this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if(a)return a}else return""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return"undefined"!==typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)},options:{},performAction:function(a,b,c,d){switch(c){case 1:return 17;case 2:return 18;case 3:return 12;case 4:return 19;case 5:return 28;case 6:return 29;case 7:return 30;case 8:return 31;case 9:return 32;case 10:return 14;case 11:return 23;case 12:return 22;case 13:return 20;case 14:return 21;case 15:return 5;case 16:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:\()/,/^(?:\))/,/^(?:-?[0-9]+(\.[0-9]+)?([eE][\-\+]?[0-9]+)?)/,/^(?:POINT\b)/,/^(?:LINESTRING\b)/,/^(?:POLYGON\b)/,/^(?:MULTIPOINT\b)/,/^(?:MULTILINESTRING\b)/,/^(?:MULTIPOLYGON\b)/,/^(?:,)/,/^(?:EMPTY\b)/,/^(?:M\b)/,/^(?:Z\b)/,/^(?:ZM\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],inclusive:!0}}}}();d.lexer=h;a.prototype=d;d.Parser=a;return new a}();k.prototype.addPoint=function(a){"PointArray"===a.type?this.data=this.data.concat(a.data):this.data.push(a);return this};k.prototype.toJSON=function(){return this.data};l.prototype.toJSON=function(){for(var a=[],b=0;b<this.data.data.length;b++)a.push(this.data.data[b]);return a};c.prototype.addRing=function(a){this.data.push(a);return this};c.prototype.toJSON=function(){for(var a=[],b=0;b<this.data.length;b++)a.push(this.data[b].toJSON());return a};b.prototype.addPolygon=function(a){this.data.push(a);return this};b.prototype.toJSON=function(){for(var a=[],b=0;b<this.data.length;b++)a=a.concat([this.data[b].toJSON()]);return a};a.parser=d;a.Parser=d.Parser;a.parse=function(a){var b;try{b=d.parse(a)}catch(m){throw Error("Unable to parse: "+m);}return e.Primitive(b)};a.convert=function(a){switch(a.type){case "Point":var b="POINT ";void 0===a.coordinates||0===a.coordinates.length?a=b+"EMPTY":(3===a.coordinates.length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates.length&&(b+="ZM "),a=b+="("+a.coordinates.join(" ")+")");return a;case "LineString":return b="LINESTRING ",void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length?a=b+"EMPTY":(3===a.coordinates[0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0].length&&(b+="ZM "),a=b+=h(a.coordinates)),a;case "Polygon":b="POLYGON ";if(void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length)a=b+"EMPTY";else{3===a.coordinates[0][0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0][0].length&&(b+="ZM ");for(var b=b+"(",c=[],d=0;d<a.coordinates.length;d++)c.push(h(a.coordinates[d]));b+=c.join(", ");a=b+")"}return a;case "MultiPoint":return b="MULTIPOINT ",void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length?a=b+"EMPTY":(3===a.coordinates[0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0].length&&(b+="ZM "),a=b+=h(a.coordinates)),a;case "MultiLineString":b="MULTILINESTRING ";if(void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length)a=b+"EMPTY";else{3===a.coordinates[0][0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0][0].length&&(b+="ZM ");b+="(";c=[];for(d=0;d<a.coordinates.length;d++)c.push(h(a.coordinates[d]));b+=c.join(", ");a=b+")"}return a;case "MultiPolygon":b="MULTIPOLYGON ";if(void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length)a=b+"EMPTY";else{3===a.coordinates[0][0][0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0][0][0].length&&(b+="ZM ");b+="(";c=[];for(d=0;d<a.coordinates.length;d++){for(var g="(",e=[],k=0;k<a.coordinates[d].length;k++)e.push(h(a.coordinates[d][k]));g+=e.join(", ");g+=")";c.push(g)}b+=c.join(", ");a=b+")"}return a;default:throw Error("Unknown Type: "+a.type);}};return a});(function(e){var k;if("function"===typeof define&&define.amd)define(["leaflet"],e);else if("undefined"!==typeof module)k=require("leaflet"),module.exports=e(k);else{if("undefined"===typeof window.L)throw Error("Leaflet must be loaded first");e(window.L)}})(function(e){e.Control.Zoomslider=function(){var k=e.Draggable.extend({initialize:function(k,c,b){e.Draggable.prototype.initialize.call(this,k,k);this._element=k;this._stepHeight=c;this._knobHeight=b;this.on("predrag",function(){this._newPos.x=0;this._newPos.y=this._adjust(this._newPos.y)},this)},_adjust:function(e){e=Math.round(this._toValue(e));e=Math.max(0,Math.min(this._maxValue,e));return this._toY(e)},_toY:function(e){return this._k*e+this._m},_toValue:function(e){return(e-this._m)/this._k},setSteps:function(e){var c=e*this._stepHeight;this._maxValue=e-1;this._k=-this._stepHeight;this._m=c-(this._stepHeight+this._knobHeight)/2},setPosition:function(k){e.DomUtil.setPosition(this._element,e.point(0,this._adjust(k)))},setValue:function(e){this.setPosition(this._toY(e))},getValue:function(){return this._toValue(e.DomUtil.getPosition(this._element).y)}});return e.Control.extend({options:{position:"bottomright",stepHeight:8,knobHeight:6,styleNS:"leaflet-control-zoomslider"},onAdd:function(e){this._map=e;this._ui=this._createUI();this._knob=new k(this._ui.knob,this.options.stepHeight,this.options.knobHeight);e.whenReady(this._initKnob,this).whenReady(this._initEvents,this).whenReady(this._updateSize,this).whenReady(this._updateKnobValue,this).whenReady(this._updateDisabled,this);return this._ui.bar},onRemove:function(e){e.off("zoomlevelschange",this._updateSize,this).off("zoomend zoomlevelschange",this._updateKnobValue,this).off("zoomend zoomlevelschange",this._updateDisabled,this)},_createUI:function(){var k={},c=this.options.styleNS;k.bar=e.DomUtil.create("div",c+" leaflet-bar");k.zoomIn=this._createZoomBtn("in","top",k.bar);k.wrap=e.DomUtil.create("div",c+"-wrap leaflet-bar-part",k.bar);k.tip=e.DomUtil.create("div","leaflet-bar-tip",k.bar);k.zoomOut=this._createZoomBtn("out","bottom",k.bar);k.body=e.DomUtil.create("div",c+"-body",k.wrap);k.knob=e.DomUtil.create("div",c+"-knob");k.tip1=e.DomUtil.create("div",c+"-tip1",k.tip);k.tip2=e.DomUtil.create("div",c+"-tip2",k.tip);k.tip3=e.DomUtil.create("div",c+"-tip3",k.tip);k.tip4=e.DomUtil.create("div",c+"-tip4",k.tip);e.DomEvent.disableClickPropagation(k.bar);e.DomEvent.disableClickPropagation(k.knob);return k},_createZoomBtn:function(k,c,b){c=e.DomUtil.create("a",this.options.styleNS+"-"+k+" leaflet-bar-part leaflet-bar-part-"+c,b);c.href="#";c.title="Zoom "+k;e.DomEvent.on(c,"click",e.DomEvent.preventDefault);return c},_initKnob:function(){this._knob.enable();this._ui.body.appendChild(this._ui.knob)},_initEvents:function(){this._map.on("zoomlevelschange",this._updateSize,this).on("zoomend zoomlevelschange",this._updateKnobValue,this).on("zoomend zoomlevelschange",this._updateDisabled,this);e.DomEvent.on(this._ui.body,"click",this._onSliderClick,this);e.DomEvent.on(this._ui.wrap,"mouseover",this._onSliderHover,this);e.DomEvent.on(this._ui.tip,"mouseover",this._onSliderHover,this);e.DomEvent.on(this._ui.wrap,"mouseout",this._onSliderMouseOut,this);e.DomEvent.on(this._ui.zoomIn,"click",this._zoomIn,this);e.DomEvent.on(this._ui.zoomOut,"click",this._zoomOut,this);e.DomEvent.on(this._ui.tip1,"click",this._zoom1,this);e.DomEvent.on(this._ui.tip2,"click",this._zoom2,this);e.DomEvent.on(this._ui.tip3,"click",this._zoom3,this);e.DomEvent.on(this._ui.tip4,"click",this._zoom4,this);this._knob.on("dragend",this._updateMapZoom,this)},_onSliderHover:function(e){this._ui.tip.style.display="inline"},_onSliderMouseOut:function(e){this._ui.tip.style.display="none"},_onSliderClick:function(k){k=e.DomEvent.getMousePosition(k.touches&&1===k.touches.length?k.touches[0]:k,this._ui.body).y;this._knob.setPosition(k);this._updateMapZoom()},_zoom1:function(e){this._map.setView([29.8627,121.556],16)},_zoom2:function(e){this._map.setView([29.8627,121.556],11)},_zoom3:function(e){this._map.setView([29.8627,121.556],7)},_zoom4:function(e){this._map.setView([29.8627,104.556],4)},_zoomIn:function(e){this._map.zoomIn(e.shiftKey?3:1)},_zoomOut:function(e){this._map.zoomOut(e.shiftKey?3:1)},_zoomLevels:function(){var e=this._map.getMaxZoom()-this._map.getMinZoom()+1;return Infinity>e?e:0},_toZoomLevel:function(e){return e+this._map.getMinZoom()},_toValue:function(e){return e-this._map.getMinZoom()},_updateSize:function(){var e=this._zoomLevels();this._ui.body.style.height=this.options.stepHeight*e+"px";this._knob.setSteps(e)},_updateMapZoom:function(){this._map.setZoom(this._toZoomLevel(this._knob.getValue()))},_updateKnobValue:function(){this._knob.setValue(this._toValue(this._map.getZoom()))},_updateDisabled:function(){var k=this._map.getZoom(),c=this.options.styleNS+"-disabled";e.DomUtil.removeClass(this._ui.zoomIn,c);e.DomUtil.removeClass(this._ui.zoomOut,c);k===this._map.getMinZoom()&&e.DomUtil.addClass(this._ui.zoomOut,c);k===this._map.getMaxZoom()&&e.DomUtil.addClass(this._ui.zoomIn,c)}})}();e.Map.addInitHook(function(){this.options.zoomsliderControl&&(this.zoomsliderControl=new e.Control.Zoomslider,this.addControl(this.zoomsliderControl))});e.control.zoomslider=function(k){return new e.Control.Zoomslider(k)}});(function(e){var k;if("function"===typeof define&&define.amd)define(["leaflet"],e);else if("object"===typeof module&&"object"===typeof module.exports)k=require("leaflet"),module.exports=e(k);else{if("undefined"===typeof window.L)throw Error("Leaflet must be loaded first");e(window.L)}})(function(e){e.Map.mergeOptions({contextmenuItems:[]});e.Map.ContextMenu=e.Handler.extend({_touchstart:e.Browser.msPointer?"MSPointerDown":e.Browser.pointer?"pointerdown":"touchstart",statics:{BASE_CLS:"leaflet-contextmenu"},initialize:function(a){e.Handler.prototype.initialize.call(this,a);this._items=[];this._visible=!1;var b=this._container=e.DomUtil.create("div",e.Map.ContextMenu.BASE_CLS,a._container);b.style.zIndex=1E4;b.style.position="absolute";a.options.contextmenuWidth&&(b.style.width=a.options.contextmenuWidth+"px");this._createItems();e.DomEvent.on(b,"click",e.DomEvent.stop).on(b,"mousedown",e.DomEvent.stop).on(b,"dblclick",e.DomEvent.stop).on(b,"contextmenu",e.DomEvent.stop)},addHooks:function(){var a=this._map.getContainer();e.DomEvent.on(a,"mouseleave",this._hide,this).on(document,"keydown",this._onKeyDown,this);if(e.Browser.touch)e.DomEvent.on(document,this._touchstart,this._hide,this);this._map.on({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},removeHooks:function(){var a=this._map.getContainer();e.DomEvent.off(a,"mouseleave",this._hide,this).off(document,"keydown",this._onKeyDown,this);e.Browser.touch&&e.DomEvent.off(document,this._touchstart,this._hide,this);this._map.off({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},showAt:function(a,b){a instanceof e.LatLng&&(a=this._map.latLngToContainerPoint(a));this._showAtPoint(a,b)},hide:function(){this._hide()},addItem:function(a){return this.insertItem(a)},insertItem:function(a,b){b=void 0!==b?b:this._items.length;var c=this._createItem(this._container,a,b);this._items.push(c);this._sizeChanged=!0;this._map.fire("contextmenu.additem",{contextmenu:this,el:c.el,index:b});return c.el},removeItem:function(a){var b=this._container;isNaN(a)||(a=b.children[a]);return a?(this._removeItem(e.Util.stamp(a)),this._sizeChanged=!0,this._map.fire("contextmenu.removeitem",{contextmenu:this,el:a}),a):null},removeAllItems:function(){for(var a=this._container.children,b;a.length;)b=a[0],this._removeItem(e.Util.stamp(b));return a},hideAllItems:function(){var a,b,c;b=0;for(c=this._items.length;b<c;b++)a=this._items[b],a.el.style.display="none"},showAllItems:function(){var a,b,c;b=0;for(c=this._items.length;b<c;b++)a=this._items[b],a.el.style.display=""},setDisabled:function(a,b){var c=this._container,d=e.Map.ContextMenu.BASE_CLS+"-item";isNaN(a)||(a=c.children[a]);a&&e.DomUtil.hasClass(a,d)&&(b?(e.DomUtil.addClass(a,d+"-disabled"),this._map.fire("contextmenu.disableitem",{contextmenu:this,el:a})):(e.DomUtil.removeClass(a,d+"-disabled"),this._map.fire("contextmenu.enableitem",{contextmenu:this,el:a})))},isVisible:function(){return this._visible},_createItems:function(){var a=this._map.options.contextmenuItems,b,c;b=0;for(c=a.length;b<c;b++)this._items.push(this._createItem(this._container,a[b]))},_createItem:function(a,b,c){if(b.separator||"-"===b)return this._createSeparator(a,c);var d=e.Map.ContextMenu.BASE_CLS+"-item";a=this._insertElementAt("a",b.disabled?d+" "+d+"-disabled":d,a,c);c=this._createEventHandler(a,b.callback,b.context,b.hideOnSelect);var d=this._getIcon(b),g=this._getIconCls(b),h="";d?h='\x3cimg class\x3d"'+e.Map.ContextMenu.BASE_CLS+'-icon" src\x3d"'+d+'"/\x3e':g&&(h='\x3cspan class\x3d"'+e.Map.ContextMenu.BASE_CLS+"-icon "+g+'"\x3e\x3c/span\x3e');a.innerHTML=h+b.text;a.href="#";e.DomEvent.on(a,"mouseover",this._onItemMouseOver,this).on(a,"mouseout",this._onItemMouseOut,this).on(a,"mousedown",e.DomEvent.stopPropagation).on(a,"click",c);if(e.Browser.touch)e.DomEvent.on(a,this._touchstart,e.DomEvent.stopPropagation);if(!e.Browser.pointer)e.DomEvent.on(a,"click",this._onItemMouseOut,this);return{id:e.Util.stamp(a),el:a,callback:c}},_removeItem:function(a){var b,c,f;c=0;for(f=this._items.length;c<f;c++)if(b=this._items[c],b.id===a){a=b.el;if(f=b.callback)if(e.DomEvent.off(a,"mouseover",this._onItemMouseOver,this).off(a,"mouseover",this._onItemMouseOut,this).off(a,"mousedown",e.DomEvent.stopPropagation).off(a,"click",f),e.Browser.touch&&e.DomEvent.off(a,this._touchstart,e.DomEvent.stopPropagation),!e.Browser.pointer)e.DomEvent.on(a,"click",this._onItemMouseOut,this);this._container.removeChild(a);this._items.splice(c,1);return b}return null},_createSeparator:function(a,b){var c=this._insertElementAt("div",e.Map.ContextMenu.BASE_CLS+"-separator",a,b);return{id:e.Util.stamp(c),el:c}},_createEventHandler:function(a,b,c,f){var d=this,g=this._map,h=e.Map.ContextMenu.BASE_CLS+"-item-disabled";f=void 0!==f?f:!0;return function(k){e.DomUtil.hasClass(a,h)||(f&&d._hide(),b&&b.call(c||g,d._showLocation),d._map.fire("contextmenu.select",{contextmenu:d,el:a}))}},_insertElementAt:function(a,b,c,f){var d;a=document.createElement(a);a.className=b;void 0!==f&&(d=c.children[f]);d?c.insertBefore(a,d):c.appendChild(a);return a},_show:function(a){this._showAtPoint(a.containerPoint,a)},_showAtPoint:function(a,b){if(this._items.length){var c=this._map,d=c.containerPointToLayerPoint(a),c=c.layerPointToLatLng(d),h=e.extend(b||{},{contextmenu:this});this._showLocation={latlng:c,layerPoint:d,containerPoint:a};b&&b.relatedTarget&&(this._showLocation.relatedTarget=b.relatedTarget);this._setPosition(a);this._visible||(this._container.style.display="block",this._visible=!0);this._map.fire("contextmenu.show",h)}},_hide:function(){this._visible&&(this._visible=!1,this._container.style.display="none",this._map.fire("contextmenu.hide",{contextmenu:this}))},_getIcon:function(a){return e.Browser.retina&&a.retinaIcon||a.icon},_getIconCls:function(a){return e.Browser.retina&&a.retinaIconCls||a.iconCls},_setPosition:function(a){var b=this._map.getSize(),c=this._container,f=this._getElementSize(c),h;this._map.options.contextmenuAnchor&&(h=e.point(this._map.options.contextmenuAnchor),a=a.add(h));c._leaflet_pos=a;a.x+f.x>b.x?(c.style.left="auto",c.style.right=Math.min(Math.max(b.x-a.x,0),b.x-f.x-1)+"px"):(c.style.left=Math.max(a.x,0)+"px",c.style.right="auto");a.y+f.y>b.y?(c.style.top="auto",c.style.bottom=Math.min(Math.max(b.y-a.y,0),b.y-f.y-1)+"px"):(c.style.top=Math.max(a.y,0)+"px",c.style.bottom="auto")},_getElementSize:function(a){var b=this._size,c=a.style.display;if(!b||this._sizeChanged)b={},a.style.right="auto",b.x=a.offsetWidth,b.y=a.offsetHeight,a.style.left="auto",a.style.display=c,this._sizeChanged=!1;return b},_onKeyDown:function(a){27===a.keyCode&&this._hide()},_onItemMouseOver:function(a){e.DomUtil.addClass(a.target||a.srcElement,"over")},_onItemMouseOut:function(a){e.DomUtil.removeClass(a.target||a.srcElement,"over")}});e.Map.addInitHook("addHandler","contextmenu",e.Map.ContextMenu);e.Mixin.ContextMenu={bindContextMenu:function(a){e.setOptions(this,a);this._initContextMenu();return this},unbindContextMenu:function(){this.off("contextmenu",this._showContextMenu,this);return this},addContextMenuItem:function(a){this.options.contextmenuItems.push(a)},removeContextMenuItemWithIndex:function(a){for(var b=[],c=0;c<this.options.contextmenuItems.length;c++)this.options.contextmenuItems[c].index==a&&b.push(c);for(a=b.pop();void 0!==a;)this.options.contextmenuItems.splice(a,1),a=b.pop()},replaceContextMenuItem:function(a){this.removeContextMenuItemWithIndex(a.index);this.addContextMenuItem(a)},_initContextMenu:function(){this._items=[];this.on("contextmenu",this._showContextMenu,this)},_showContextMenu:function(a){var b,c,f,h;if(this._map.contextmenu){b=e.extend({relatedTarget:this},a);c=this._map.mouseEventToContainerPoint(a.originalEvent);this.options.contextmenuInheritItems||this._map.contextmenu.hideAllItems();f=0;for(h=this.options.contextmenuItems.length;f<h;f++)a=this.options.contextmenuItems[f],this._items.push(this._map.contextmenu.insertItem(a,a.index));this._map.once("contextmenu.hide",this._hideContextMenu,this);this._map.contextmenu.showAt(c,b)}},_hideContextMenu:function(){var a,b;a=0;for(b=this._items.length;a<b;a++)this._map.contextmenu.removeItem(this._items[a]);this._items.length=0;this.options.contextmenuInheritItems||this._map.contextmenu.showAllItems()}};var k=[e.Marker,e.Path],l={contextmenu:!1,contextmenuItems:[],contextmenuInheritItems:!0},c,b,h;b=0;for(h=k.length;b<h;b++)c=k[b],c.prototype.options?c.mergeOptions(l):c.prototype.options=l,c.addInitHook(function(){this.options.contextmenu&&this._initContextMenu()}),c.include(e.Mixin.ContextMenu);return e.Map.ContextMenu});(function(e,k,l){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(c){L.Util.setOptions(this,c);this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction);this._featureGroup=L.featureGroup();this._featureGroup.addEventParent(this);this._nonPointGroup=L.featureGroup();this._nonPointGroup.addEventParent(this);this._inZoomAnimation=0;this._needsClustering=[];this._needsRemoving=[];this._currentShownBounds=null;this._queue=[];this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};c=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,c?this._withAnimation:this._noAnimation);this._markerCluster=c?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(c){if(c instanceof L.LayerGroup)return this.addLayers([c]);if(!c.getLatLng)return this._nonPointGroup.addLayer(c),this.fire("layeradd",{layer:c}),this;if(!this._map)return this._needsClustering.push(c),this.fire("layeradd",{layer:c}),this;if(this.hasLayer(c))return this;this._unspiderfy&&this._unspiderfy();this._addLayer(c,this._maxZoom);this.fire("layeradd",{layer:c});this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();var b=c,h=this._zoom;if(c.__parent)for(;b.__parent._zoom>=h;)b=b.__parent;this._currentShownBounds.contains(b.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(c,b):this._animationAddLayerNonAnimated(c,b));return this},removeLayer:function(c){if(c instanceof L.LayerGroup)return this.removeLayers([c]);if(!c.getLatLng)return this._nonPointGroup.removeLayer(c),this.fire("layerremove",{layer:c}),this;if(!this._map)return!this._arraySplice(this._needsClustering,c)&&this.hasLayer(c)&&this._needsRemoving.push({layer:c,latlng:c._latlng}),this.fire("layerremove",{layer:c}),this;if(!c.__parent)return this;this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(c));this._removeLayer(c,!0);this.fire("layerremove",{layer:c});this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();c.off(this._childMarkerEventHandlers,this);this._featureGroup.hasLayer(c)&&(this._featureGroup.removeLayer(c),c.clusterShow&&c.clusterShow());return this},addLayers:function(c,b){if(!L.Util.isArray(c))return this.addLayer(c);var h=this._featureGroup,a=this._nonPointGroup,d=this.options.chunkedLoading,g=this.options.chunkInterval,f=this.options.chunkProgress,e=c.length,k=0,l=!0,v;if(this._map){var q=(new Date).getTime(),u=L.bind(function(){for(var m=(new Date).getTime();k<e&&!(d&&0===k%200&&(new Date).getTime()-m>g);k++)if(v=c[k],v instanceof L.LayerGroup)l&&(c=c.slice(),l=!1),this._extractNonGroupLayers(v,c),e=c.length;else if(!v.getLatLng)a.addLayer(v),b||this.fire("layeradd",{layer:v});else if(!this.hasLayer(v)&&(this._addLayer(v,this._maxZoom),b||this.fire("layeradd",{layer:v}),v.__parent&&2===v.__parent.getChildCount())){var x=v.__parent.getAllChildMarkers();h.removeLayer(x[0]===v?x[1]:x[0])}f&&f(k,e,(new Date).getTime()-q);k===e?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(u,this.options.chunkDelay)},this);u()}else for(var y=this._needsClustering;k<e;k++)v=c[k],v instanceof L.LayerGroup?(l&&(c=c.slice(),l=!1),this._extractNonGroupLayers(v,c),e=c.length):v.getLatLng?this.hasLayer(v)||y.push(v):a.addLayer(v);return this},removeLayers:function(c){var b,h,a=c.length,d=this._featureGroup,g=this._nonPointGroup,f=!0;if(!this._map){for(b=0;b<a;b++)h=c[b],h instanceof L.LayerGroup?(f&&(c=c.slice(),f=!1),this._extractNonGroupLayers(h,c),a=c.length):(this._arraySplice(this._needsClustering,h),g.removeLayer(h),this.hasLayer(h)&&this._needsRemoving.push({layer:h,latlng:h._latlng}),this.fire("layerremove",{layer:h}));return this}if(this._unspiderfy){this._unspiderfy();var e=c.slice(),k=a;for(b=0;b<k;b++)h=e[b],h instanceof L.LayerGroup?(this._extractNonGroupLayers(h,e),k=e.length):this._unspiderfyLayer(h)}for(b=0;b<a;b++)h=c[b],h instanceof L.LayerGroup?(f&&(c=c.slice(),f=!1),this._extractNonGroupLayers(h,c),a=c.length):h.__parent?(this._removeLayer(h,!0,!0),this.fire("layerremove",{layer:h}),d.hasLayer(h)&&(d.removeLayer(h),h.clusterShow&&h.clusterShow())):(g.removeLayer(h),this.fire("layerremove",{layer:h}));this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds);return this},clearLayers:function(){this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered);this._noanimationUnspiderfy&&this._noanimationUnspiderfy();this._featureGroup.clearLayers();this._nonPointGroup.clearLayers();this.eachLayer(function(c){c.off(this._childMarkerEventHandlers,this);delete c.__parent},this);this._map&&this._generateInitialClusters();return this},getBounds:function(){var c=new L.LatLngBounds;this._topClusterLevel&&c.extend(this._topClusterLevel._bounds);for(var b=this._needsClustering.length-1;0<=b;b--)c.extend(this._needsClustering[b].getLatLng());c.extend(this._nonPointGroup.getBounds());return c},eachLayer:function(c,b){var h=this._needsClustering.slice(),a=this._needsRemoving,d,g,f;this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(h);for(g=h.length-1;0<=g;g--){d=!0;for(f=a.length-1;0<=f;f--)if(a[f].layer===h[g]){d=!1;break}d&&c.call(b,h[g])}this._nonPointGroup.eachLayer(c,b)},getLayers:function(){var c=[];this.eachLayer(function(b){c.push(b)});return c},getLayer:function(c){var b=null;c=parseInt(c,10);this.eachLayer(function(h){L.stamp(h)===c&&(b=h)});return b},hasLayer:function(c){if(!c)return!1;var b,h=this._needsClustering;for(b=h.length-1;0<=b;b--)if(h[b]===c)return!0;h=this._needsRemoving;for(b=h.length-1;0<=b;b--)if(h[b].layer===c)return!1;return!(!c.__parent||c.__parent._group!==this)||this._nonPointGroup.hasLayer(c)},zoomToShowLayer:function(c,b){"function"!==typeof b&&(b=function(){});var h=function(){!c._icon&&!c.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",h,this),this.off("animationend",h,this),c._icon?b():c.__parent._icon&&(this.once("spiderfied",b,this),c.__parent.spiderfy()))};c._icon&&this._map.getBounds().contains(c.getLatLng())?b():c.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",h,this),this._map.panTo(c.getLatLng())):(this._map.on("moveend",h,this),this.on("animationend",h,this),c.__parent.zoomToBounds())},onAdd:function(c){this._map=c;var b,h;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.addTo(c);this._nonPointGroup.addTo(c);this._gridClusters||this._generateInitialClusters();this._maxLat=c.options.crs.projection.MAX_LATITUDE;c=0;for(b=this._needsRemoving.length;c<b;c++)h=this._needsRemoving[c],h.newlatlng=h.layer._latlng,h.layer._latlng=h.latlng;c=0;for(b=this._needsRemoving.length;c<b;c++)h=this._needsRemoving[c],this._removeLayer(h.layer,!0),h.layer._latlng=h.newlatlng;this._needsRemoving=[];this._zoom=Math.round(this._map._zoom);this._currentShownBounds=this._getExpandedVisibleBounds();this._map.on("zoomend",this._zoomEnd,this);this._map.on("moveend",this._moveEnd,this);this._spiderfierOnAdd&&this._spiderfierOnAdd();this._bindEvents();b=this._needsClustering;this._needsClustering=[];this.addLayers(b,!0)},onRemove:function(c){c.off("zoomend",this._zoomEnd,this);c.off("moveend",this._moveEnd,this);this._unbindEvents();this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","");this._spiderfierOnRemove&&this._spiderfierOnRemove();delete this._maxLat;this._hideCoverage();this._featureGroup.remove();this._nonPointGroup.remove();this._featureGroup.clearLayers();this._map=null},getVisibleParent:function(c){for(;c&&!c._icon;)c=c.__parent;return c||null},_arraySplice:function(c,b){for(var h=c.length-1;0<=h;h--)if(c[h]===b)return c.splice(h,1),!0},_removeFromGridUnclustered:function(c,b){for(var h=this._map,a=this._gridUnclustered,d=this._map.getMinZoom();b>=d&&a[b].removeObject(c,h.project(c.getLatLng(),b));b--);},_childMarkerDragStart:function(c){c.target.__dragStart=c.target._latlng},_childMarkerMoved:function(c){if(!this._ignoreMove&&!c.target.__dragStart){var b=c.target._popup&&c.target._popup.isOpen();this._moveChild(c.target,c.oldLatLng,c.latlng);b&&c.target.openPopup()}},_moveChild:function(c,b,h){c._latlng=b;this.removeLayer(c);c._latlng=h;this.addLayer(c)},_childMarkerDragEnd:function(c){c.target.__dragStart&&this._moveChild(c.target,c.target.__dragStart,c.target._latlng);delete c.target.__dragStart},_removeLayer:function(c,b,h){var a=this._gridClusters,d=this._gridUnclustered,g=this._featureGroup,f=this._map,e=this._map.getMinZoom();b&&this._removeFromGridUnclustered(c,this._maxZoom);var k=c.__parent,l;for(this._arraySplice(k._markers,c);k;){k._childCount--;k._boundsNeedUpdate=!0;if(k._zoom<e)break;else b&&1>=k._childCount?(l=k._markers[0]===c?k._markers[1]:k._markers[0],a[k._zoom].removeObject(k,f.project(k._cLatLng,k._zoom)),d[k._zoom].addObject(l,f.project(l.getLatLng(),k._zoom)),this._arraySplice(k.__parent._childClusters,k),k.__parent._markers.push(l),l.__parent=k.__parent,k._icon&&(g.removeLayer(k),h||g.addLayer(l))):k._iconNeedsUpdate=!0;k=k.__parent}delete c.__parent},_isOrIsParent:function(c,b){for(;b;){if(c===b)return!0;b=b.parentNode}return!1},fire:function(c,b,h){if(b&&b.layer instanceof L.MarkerCluster){if(b.originalEvent&&this._isOrIsParent(b.layer._icon,b.originalEvent.relatedTarget))return;c="cluster"+c}L.FeatureGroup.prototype.fire.call(this,c,b,h)},listens:function(c,b){return L.FeatureGroup.prototype.listens.call(this,c,b)||L.FeatureGroup.prototype.listens.call(this,"cluster"+c,b)},_defaultIconCreateFunction:function(c){c=c.getChildCount();var b=" marker-cluster-";return new L.DivIcon({html:"\x3cdiv\x3e\x3cspan\x3e"+c+"\x3c/span\x3e\x3c/div\x3e",className:"marker-cluster"+(10>c?b+"small":100>c?b+"medium":b+"large"),iconSize:new L.Point(40,40)})},_bindEvents:function(){var c=this._map,b=this.options.showCoverageOnHover,h=this.options.zoomToBoundsOnClick;if(this.options.spiderfyOnMaxZoom||h)this.on("clusterclick",this._zoomOrSpiderfy,this);b&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),c.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(c){for(var b=c.layer,h=b;1===h._childClusters.length;)h=h._childClusters[0];h._zoom===this._maxZoom&&h._childCount===b._childCount&&this.options.spiderfyOnMaxZoom?b.spiderfy():this.options.zoomToBoundsOnClick&&b.zoomToBounds();c.originalEvent&&13===c.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(c){var b=this._map;this._inZoomAnimation||(this._shownPolygon&&b.removeLayer(this._shownPolygon),2<c.layer.getChildCount()&&c.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(c.layer.getConvexHull(),this.options.polygonOptions),b.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var c=this.options.showCoverageOnHover,b=this.options.zoomToBoundsOnClick,h=this._map;(this.options.spiderfyOnMaxZoom||b)&&this.off("clusterclick",this._zoomOrSpiderfy,this);c&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),h.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var c=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,c);this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),c);this._currentShownBounds=c}},_generateInitialClusters:function(){var c=this._map.getMaxZoom(),b=this._map.getMinZoom(),h=this.options.maxClusterRadius,a=h;"function"!==typeof h&&(a=function(){return h});this.options.disableClusteringAtZoom&&(c=this.options.disableClusteringAtZoom-1);this._maxZoom=c;this._gridClusters={};for(this._gridUnclustered={};c>=b;c--)this._gridClusters[c]=new L.DistanceGrid(a(c)),this._gridUnclustered[c]=new L.DistanceGrid(a(c));this._topClusterLevel=new this._markerCluster(this,b-1)},_addLayer:function(c,b){var h=this._gridClusters,a=this._gridUnclustered,d=this._map.getMinZoom(),g;this.options.singleMarkerMode&&this._overrideMarkerIcon(c);for(c.on(this._childMarkerEventHandlers,this);b>=d;b--){g=this._map.project(c.getLatLng(),b);var f=h[b].getNearObject(g);if(f){f._addChild(c);c.__parent=f;return}if(f=a[b].getNearObject(g)){(a=f.__parent)&&this._removeLayer(f,!1);d=new this._markerCluster(this,b,f,c);h[b].addObject(d,this._map.project(d._cLatLng,b));f.__parent=d;g=c.__parent=d;for(d=b-1;d>a._zoom;d--)g=new this._markerCluster(this,d,g),h[d].addObject(g,this._map.project(f.getLatLng(),d));a._addChild(g);this._removeFromGridUnclustered(f,b);return}a[b].addObject(c,g)}this._topClusterLevel._addChild(c);c.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(c){c instanceof L.MarkerCluster&&c._iconNeedsUpdate&&c._updateIcon()})},_enqueue:function(c){this._queue.push(c);this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var c=0;c<this._queue.length;c++)this._queue[c].call(this);this._queue.length=0;clearTimeout(this._queueTimeout);this._queueTimeout=null},_mergeSplitClusters:function(){var c=Math.round(this._map._zoom);this._processQueue();this._zoom<c&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,c)):this._zoom>c?(this._animationStart(),this._animationZoomOut(this._zoom,c)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(c){var b=this._maxLat;b!==l&&(c.getNorth()>=b&&(c._northEast.lat=Infinity),c.getSouth()<=-b&&(c._southWest.lat=-Infinity));return c},_animationAddLayerNonAnimated:function(c,b){if(b===c)this._featureGroup.addLayer(c);else if(2===b._childCount){b._addToMap();var h=b.getAllChildMarkers();this._featureGroup.removeLayer(h[0]);this._featureGroup.removeLayer(h[1])}else b._updateIcon()},_extractNonGroupLayers:function(c,b){var h=c.getLayers(),a=0,d;for(b=b||[];a<h.length;a++)d=h[a],d instanceof L.LayerGroup?this._extractNonGroupLayers(d,b):b.push(d);return b},_overrideMarkerIcon:function(c){return c.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[c]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-Infinity,-Infinity),new L.LatLng(Infinity,Infinity))});L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(c,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,c);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());this.fire("animationend")},_animationZoomOut:function(c,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,c);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());this.fire("animationend")},_animationAddLayer:function(c,b){this._animationAddLayerNonAnimated(c,b)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim";this._inZoomAnimation++},_animationZoomIn:function(c,b){var h=this._getExpandedVisibleBounds(),a=this._featureGroup,d=this._map.getMinZoom(),g;this._ignoreMove=!0;this._topClusterLevel._recursively(h,c,d,function(d){var f=d._latlng,e=d._markers;h.contains(f)||(f=null);d._isSingleParent()&&c+1===b?(a.removeLayer(d),d._recursivelyAddChildrenToMap(null,b,h)):(d.clusterHide(),d._recursivelyAddChildrenToMap(f,b,h));for(g=e.length-1;0<=g;g--)d=e[g],h.contains(d._latlng)||a.removeLayer(d)});this._forceLayout();this._topClusterLevel._recursivelyBecomeVisible(h,b);a.eachLayer(function(a){a instanceof L.MarkerCluster||!a._icon||a.clusterShow()});this._topClusterLevel._recursively(h,c,b,function(a){a._recursivelyRestoreChildPositions(b)});this._ignoreMove=!1;this._enqueue(function(){this._topClusterLevel._recursively(h,c,d,function(b){a.removeLayer(b);b.clusterShow()});this._animationEnd()})},_animationZoomOut:function(c,b){this._animationZoomOutSingle(this._topClusterLevel,c-1,b);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,c,this._getExpandedVisibleBounds())},_animationAddLayer:function(c,b){var h=this,a=this._featureGroup;a.addLayer(c);b!==c&&(2<b._childCount?(b._updateIcon(),this._forceLayout(),this._animationStart(),c._setPos(this._map.latLngToLayerPoint(b.getLatLng())),c.clusterHide(),this._enqueue(function(){a.removeLayer(c);c.clusterShow();h._animationEnd()})):(this._forceLayout(),h._animationStart(),h._animationZoomOutSingle(b,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(c,b,h){var a=this._getExpandedVisibleBounds(),d=this._map.getMinZoom();c._recursivelyAnimateChildrenInAndAddSelfToMap(a,b+1,h);var g=this;this._forceLayout();c._recursivelyBecomeVisible(a,h);this._enqueue(function(){if(1===c._childCount){var f=c._markers[0];this._ignoreMove=!0;f.setLatLng(f.getLatLng());this._ignoreMove=!1;f.clusterShow&&f.clusterShow()}else c._recursively(a,h,d,function(c){c._recursivelyRemoveChildrenFromMap(a,b+1)});g._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""));this._inZoomAnimation--;this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(k.body.offsetWidth)}});L.markerClusterGroup=function(c){return new L.MarkerClusterGroup(c)};L.MarkerCluster=L.Marker.extend({initialize:function(c,b,h,a){L.Marker.prototype.initialize.call(this,h?h._cLatLng||h.getLatLng():new L.LatLng(0,0),{icon:this});this._group=c;this._zoom=b;this._markers=[];this._childClusters=[];this._childCount=0;this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._bounds=new L.LatLngBounds;h&&this._addChild(h);a&&this._addChild(a)},getAllChildMarkers:function(c){c=c||[];for(var b=this._childClusters.length-1;0<=b;b--)this._childClusters[b].getAllChildMarkers(c);for(b=this._markers.length-1;0<=b;b--)c.push(this._markers[b]);return c},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var c=this._childClusters.slice(),b=this._group._map,h=b.getBoundsZoom(this._bounds),a=this._zoom+1,b=b.getZoom(),d;0<c.length&&h>a;){a++;var g=[];for(d=0;d<c.length;d++)g=g.concat(c[d]._childClusters);c=g}h>a?this._group._map.setView(this._latlng,a):h<=b?this._group._map.setView(this._latlng,b+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var c=new L.LatLngBounds;c.extend(this._bounds);return c},_updateIcon:function(){this._iconNeedsUpdate=!0;this._icon&&this.setIcon(this)},createIcon:function(){this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1);return this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(c,b){this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._setClusterCenter(c);c instanceof L.MarkerCluster?(b||(this._childClusters.push(c),c.__parent=this),this._childCount+=c._childCount):(b||this._markers.push(c),this._childCount++);this.__parent&&this.__parent._addChild(c,!0)},_setClusterCenter:function(c){this._cLatLng||(this._cLatLng=c._cLatLng||c._latlng)},_resetBounds:function(){var c=this._bounds;c._southWest&&(c._southWest.lat=Infinity,c._southWest.lng=Infinity);c._northEast&&(c._northEast.lat=-Infinity,c._northEast.lng=-Infinity)},_recalculateBounds:function(){var c=this._markers,b=this._childClusters,h=0,a=0,d=this._childCount,g,f;if(0!==d){this._resetBounds();for(g=0;g<c.length;g++)f=c[g]._latlng,this._bounds.extend(f),h+=f.lat,a+=f.lng;for(g=0;g<b.length;g++)c=b[g],c._boundsNeedUpdate&&c._recalculateBounds(),this._bounds.extend(c._bounds),f=c._wLatLng,c=c._childCount,h+=f.lat*c,a+=f.lng*c;this._latlng=this._wLatLng=new L.LatLng(h/d,a/d);this._boundsNeedUpdate=!1}},_addToMap:function(c){c&&(this._backupLatlng=this._latlng,this.setLatLng(c));this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(c,b,h){this._recursively(c,this._group._map.getMinZoom(),h-1,function(a){a=a._markers;var c,g;for(c=a.length-1;0<=c;c--)g=a[c],g._icon&&(g._setPos(b),g.clusterHide())},function(a){a=a._childClusters;var c,g;for(c=a.length-1;0<=c;c--)g=a[c],g._icon&&(g._setPos(b),g.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(c,b,h){this._recursively(c,h,this._group._map.getMinZoom(),function(a){a._recursivelyAnimateChildrenIn(c,a._group._map.latLngToLayerPoint(a.getLatLng()).round(),b);a._isSingleParent()&&b-1===h?(a.clusterShow(),a._recursivelyRemoveChildrenFromMap(c,b)):a.clusterHide();a._addToMap()})},_recursivelyBecomeVisible:function(c,b){this._recursively(c,this._group._map.getMinZoom(),b,null,function(b){b.clusterShow()})},_recursivelyAddChildrenToMap:function(c,b,h){this._recursively(h,this._group._map.getMinZoom()-1,b,function(a){if(b!==a._zoom)for(var d=a._markers.length-1;0<=d;d--){var g=a._markers[d];h.contains(g._latlng)&&(c&&(g._backupLatlng=g.getLatLng(),g.setLatLng(c),g.clusterHide&&g.clusterHide()),a._group._featureGroup.addLayer(g))}},function(a){a._addToMap(c)})},_recursivelyRestoreChildPositions:function(c){for(var b=this._markers.length-1;0<=b;b--){var h=this._markers[b];h._backupLatlng&&(h.setLatLng(h._backupLatlng),delete h._backupLatlng)}if(c-1===this._zoom)for(c=this._childClusters.length-1;0<=c;c--)this._childClusters[c]._restorePosition();else for(b=this._childClusters.length-1;0<=b;b--)this._childClusters[b]._recursivelyRestoreChildPositions(c)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(c,b,h){var a,d;this._recursively(c,this._group._map.getMinZoom()-1,b-1,function(b){for(d=b._markers.length-1;0<=d;d--)a=b._markers[d],h&&h.contains(a._latlng)||(b._group._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow())},function(b){for(d=b._childClusters.length-1;0<=d;d--)a=b._childClusters[d],h&&h.contains(a._latlng)||(b._group._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow())})},_recursively:function(c,b,h,a,d){var g=this._childClusters,f=this._zoom,e;b<=f&&(a&&a(this),d&&f===h&&d(this));if(f<b||f<h)for(f=g.length-1;0<=f;f--)e=g[f],c.intersects(e._bounds)&&e._recursively(c,b,h,a,d)},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){this.options.opacityWhenUnclustered=this.options.opacity||1;return this.setOpacity(0)},clusterShow:function(){var c=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);delete this.options.opacityWhenUnclustered;return c}});L.DistanceGrid=function(c){this._cellSize=c;this._sqCellSize=c*c;this._grid={};this._objectPoint={}};L.DistanceGrid.prototype={addObject:function(c,b){var h=this._getCoord(b.x),a=this._getCoord(b.y),d=this._grid,a=d[a]=d[a]||{},h=a[h]=a[h]||[],a=L.Util.stamp(c);this._objectPoint[a]=b;h.push(c)},updateObject:function(c,b){this.removeObject(c);this.addObject(c,b)},removeObject:function(c,b){var h=this._getCoord(b.x),a=this._getCoord(b.y),d=this._grid,a=d[a]=d[a]||{},d=a[h]=a[h]||[],g,f;delete this._objectPoint[L.Util.stamp(c)];g=0;for(f=d.length;g<f;g++)if(d[g]===c)return d.splice(g,1),1===f&&delete a[h],!0},eachObject:function(c,b){var h,a,d,g,f,e,k,l=this._grid;for(h in l)for(a in f=l[h],f)for(e=f[a],d=0,g=e.length;d<g;d++)if(k=c.call(b,e[d]))d--,g--},getNearObject:function(c){var b=this._getCoord(c.x),h=this._getCoord(c.y),a,d,g,f,e,k,l,v,q=this._objectPoint,u=this._sqCellSize,y=null;for(a=h-1;a<=h+1;a++)if(f=this._grid[a])for(d=b-1;d<=b+1;d++)if(e=f[d])for(g=0,k=e.length;g<k;g++)l=e[g],v=this._sqDist(q[L.Util.stamp(l)],c),v<u&&(u=v,y=l);return y},_getCoord:function(c){return Math.floor(c/this._cellSize)},_sqDist:function(c,b){var h=b.x-c.x,a=b.y-c.y;return h*h+a*a}};(function(){L.QuickHull={getDistant:function(c,b){return(b[0].lng-b[1].lng)*(c.lat-b[0].lat)+(b[1].lat-b[0].lat)*(c.lng-b[0].lng)},findMostDistantPointFromBaseLine:function(c,b){var h=0,a=null,d=[],g,f,e;for(g=b.length-1;0<=g;g--)f=b[g],e=this.getDistant(f,c),0<e&&(d.push(f),e>h&&(h=e,a=f));return{maxPoint:a,newPoints:d}},buildConvexHull:function(c,b){var h=[],a=this.findMostDistantPointFromBaseLine(c,b);return a.maxPoint?(h=h.concat(this.buildConvexHull([c[0],a.maxPoint],a.newPoints)),h=h.concat(this.buildConvexHull([a.maxPoint,c[1]],a.newPoints))):[c[0]]},getConvexHull:function(c){var b=!1,h=!1,a=!1,d=!1,g=null,f=null,e=null,k=null,l;for(l=c.length-1;0<=l;l--){var v=c[l];if(!1===b||v.lat>b)g=v,b=v.lat;if(!1===h||v.lat<h)f=v,h=v.lat;if(!1===a||v.lng>a)e=v,a=v.lng;if(!1===d||v.lng<d)k=v,d=v.lng}h!==b?b=f:(b=k,g=e);return[].concat(this.buildConvexHull([b,g],c),this.buildConvexHull([g,b],c))}}})();L.MarkerCluster.include({getConvexHull:function(){var c=this.getAllChildMarkers(),b=[],h,a;for(a=c.length-1;0<=a;a--)h=c[a].getLatLng(),b.push(h);return L.QuickHull.getConvexHull(b)}});L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var c=this.getAllChildMarkers(),b=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy();this._group._spiderfied=this;c.length>=this._circleSpiralSwitchover?b=this._generatePointsSpiral(c.length,b):(b.y+=10,b=this._generatePointsCircle(c.length,b));this._animationSpiderfy(c,b)}},unspiderfy:function(c){this._group._inZoomAnimation||(this._animationUnspiderfy(c),this._group._spiderfied=null)},_generatePointsCircle:function(c,b){var h=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+c)/this._2PI,a=this._2PI/c,d=[],g,f;d.length=c;for(g=c-1;0<=g;g--)f=this._circleStartAngle+g*a,d[g]=(new L.Point(b.x+h*Math.cos(f),b.y+h*Math.sin(f)))._round();return d},_generatePointsSpiral:function(c,b){var h=this._group.options.spiderfyDistanceMultiplier,a=h*this._spiralLengthStart,d=h*this._spiralFootSeparation,h=h*this._spiralLengthFactor*this._2PI,g=0,f=[],e;f.length=c;for(e=c-1;0<=e;e--)g+=d/a+5E-4*e,f[e]=(new L.Point(b.x+a*Math.cos(g),b.y+a*Math.sin(g)))._round(),a+=h/g;return f},_noanimationUnspiderfy:function(){var c=this._group,b=c._map,h=c._featureGroup,a=this.getAllChildMarkers(),d,g;c._ignoreMove=!0;this.setOpacity(1);for(g=a.length-1;0<=g;g--)d=a[g],h.removeLayer(d),d._preSpiderfyLatlng&&(d.setLatLng(d._preSpiderfyLatlng),delete d._preSpiderfyLatlng),d.setZIndexOffset&&d.setZIndexOffset(0),d._spiderLeg&&(b.removeLayer(d._spiderLeg),delete d._spiderLeg);c.fire("unspiderfied",{cluster:this,markers:a});c._ignoreMove=!1;c._spiderfied=null}});L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(c,b){var h=this._group,a=h._map,d=h._featureGroup,g=this._group.options.spiderLegPolylineOptions,f,e,k,l;h._ignoreMove=!0;for(f=0;f<c.length;f++)l=a.layerPointToLatLng(b[f]),e=c[f],k=new L.Polyline([this._latlng,l],g),a.addLayer(k),e._spiderLeg=k,e._preSpiderfyLatlng=e._latlng,e.setLatLng(l),e.setZIndexOffset&&e.setZIndexOffset(1E6),d.addLayer(e);this.setOpacity(.3);h._ignoreMove=!1;h.fire("spiderfied",{cluster:this,markers:c})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}});L.MarkerCluster.include({_animationSpiderfy:function(c,b){var h=this,a=this._group,d=a._map,g=a._featureGroup,f=this._latlng,e=d.latLngToLayerPoint(f),k=L.Path.SVG,C=L.extend({},this._group.options.spiderLegPolylineOptions),v=C.opacity,q,u,y,z;v===l&&(v=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity);k?(C.opacity=0,C.className=(C.className||"")+" leaflet-cluster-spider-leg"):C.opacity=v;a._ignoreMove=!0;for(q=0;q<c.length;q++)u=c[q],z=d.layerPointToLatLng(b[q]),y=new L.Polyline([f,z],C),d.addLayer(y),u._spiderLeg=y,k&&(z=y._path,y=z.getTotalLength()+.1,z.style.strokeDasharray=y,z.style.strokeDashoffset=y),u.setZIndexOffset&&u.setZIndexOffset(1E6),u.clusterHide&&u.clusterHide(),g.addLayer(u),u._setPos&&u._setPos(e);a._forceLayout();a._animationStart();for(q=c.length-1;0<=q;q--)z=d.layerPointToLatLng(b[q]),u=c[q],u._preSpiderfyLatlng=u._latlng,u.setLatLng(z),u.clusterShow&&u.clusterShow(),k&&(y=u._spiderLeg,z=y._path,z.style.strokeDashoffset=0,y.setStyle({opacity:v}));this.setOpacity(.3);a._ignoreMove=!1;setTimeout(function(){a._animationEnd();a.fire("spiderfied",{cluster:h,markers:c})},200)},_animationUnspiderfy:function(c){var b=this,h=this._group,a=h._map,d=h._featureGroup;c=c?a._latLngToNewLayerPoint(this._latlng,c.zoom,c.center):a.latLngToLayerPoint(this._latlng);var g=this.getAllChildMarkers(),f=L.Path.SVG,e,k,l,v,q;h._ignoreMove=!0;h._animationStart();this.setOpacity(1);for(k=g.length-1;0<=k;k--)e=g[k],e._preSpiderfyLatlng&&(e.closePopup(),e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,l=!0,e._setPos&&(e._setPos(c),l=!1),e.clusterHide&&(e.clusterHide(),l=!1),l&&d.removeLayer(e),f&&(l=e._spiderLeg,v=l._path,q=v.getTotalLength()+.1,v.style.strokeDashoffset=q,l.setStyle({opacity:0})));h._ignoreMove=!1;setTimeout(function(){var c=0;for(k=g.length-1;0<=k;k--)e=g[k],e._spiderLeg&&c++;for(k=g.length-1;0<=k;k--)e=g[k],e._spiderLeg&&(e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),1<c&&d.removeLayer(e),a.removeLayer(e._spiderLeg),delete e._spiderLeg);h._animationEnd();h.fire("unspiderfied",{cluster:b,markers:g})},200)}});L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this);if(this._map.options.zoomAnimation)this._map.on("zoomstart",this._unspiderfyZoomStart,this);this._map.on("zoomend",this._noanimationUnspiderfy,this);L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this);this._map.off("zoomstart",this._unspiderfyZoomStart,this);this._map.off("zoomanim",this._unspiderfyZoomAnim,this);this._map.off("zoomend",this._noanimationUnspiderfy,this);this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){if(this._map)this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(c){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(c))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(c){this._spiderfied&&this._spiderfied.unspiderfy(c)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(c){c._spiderLeg&&(this._featureGroup.removeLayer(c),c.clusterShow&&c.clusterShow(),c.setZIndexOffset&&c.setZIndexOffset(0),this._map.removeLayer(c._spiderLeg),delete c._spiderLeg)}});L.MarkerClusterGroup.include({refreshClusters:function(c){c?c instanceof L.MarkerClusterGroup?c=c._topClusterLevel.getAllChildMarkers():c instanceof L.LayerGroup?c=c._layers:c instanceof L.MarkerCluster?c=c.getAllChildMarkers():c instanceof L.Marker&&(c=[c]):c=this._topClusterLevel.getAllChildMarkers();this._flagParentsIconsNeedUpdate(c);this._refreshClustersIcons();this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(c);return this},_flagParentsIconsNeedUpdate:function(c){var b,h;for(b in c)for(h=c[b].__parent;h;)h._iconNeedsUpdate=!0,h=h.__parent},_refreshSingleMarkerModeMarkers:function(c){var b,h;for(b in c)h=c[b],this.hasLayer(h)&&h.setIcon(this._overrideMarkerIcon(h))}});L.Marker.include({refreshIconOptions:function(c,b){var h=this.options.icon;L.setOptions(h,c);this.setIcon(h);b&&this.__parent&&this.__parent._group.refreshClusters(this);return this}})})(window,document);(function(){L.miniMapLayerSwitcherVersion="0.1-dev";L.Control.MiniMapLayerSwitcher=L.Control.extend({_className:"leaflet-mini-map-control-layers",options:{miniMapLabelHeight:22,miniMapHeight:80,miniMapWidth:90,miniMapMargin:10,miniMapZoomOffset:-2,position:"bottomleft",autoZIndex:!0},initialize:function(e,k){L.setOptions(this,k);this._layers=[];this._miniMaps={};this._lastZIndex=0;for(var l in e)this._addLayer(e[l],l)},addTo:function(e){var k=this;L.Control.prototype.addTo.call(this,e);this._updateMiniMaps();this._forEachLayer(function(e){k._miniMaps[e.id].invalidateSize()});return this},onAdd:function(){this._map.on("move",this._updateMiniMaps,this).whenReady(this._onMapReady,this);this._render();return this._container},onRemove:function(){this._map.off("move",this._updateMiniMaps,this)},_render:function(){var e=this._container=L.DomUtil.create("div",this._className),k=this._inner=L.DomUtil.create("div",this._className+"-inner");e.setAttribute("aria-haspopup",!0);L.DomEvent.disableClickPropagation(e);if(L.Browser.touch)L.DomEvent.on(e,"click",this._toggleMiniMaps,this);else L.DomEvent.on(e,"mousewheel",L.DomEvent.stopPropagation).on(e,"mouseenter",this._expand,this).on(e,"mouseleave",this._contract,this);e.style.height=this.options.miniMapHeight+this.options.miniMapLabelHeight+"px";e.appendChild(k);this._forEachLayer(function(e){this._renderMiniMap(e,k)},this);this._hasMultipleLayers()?(e=this._getInitialMainMapLayerId(),this._activeLayerId=this._getInitialMiniMapLayerId(e),this._switchLayer(e)):this._container.style.display="none"},_toggleMiniMaps:function(){var e=L.DomUtil.hasClass(this._container,"expanded");this._animateMiniMaps(!e)},_expand:function(){this._animateMiniMaps(!0)},_contract:function(){this._animateMiniMaps(!1)},_renderMiniMap:function(e,k){var l=this._mapContainer=L.DomUtil.create("div","map-container"),c=L.DomUtil.create("div","map-container-inner"),b=this._mapContainer=L.DomUtil.create("div","minmap"),h=L.DomUtil.create("div","map-label"),a=e.id,d=this._findLayer(a);L.DomEvent.on(l,"click",this._onMiniMapClicked,this);b.style.height=this.options.miniMapHeight+"px";b.style.width=this.options.miniMapWidth+"px";h.innerHTML=e.name;c.appendChild(b);c.appendChild(h);l.layerId=a;l.style.width=this.options.miniMapWidth+"px";l.appendChild(c);k.appendChild(l);this._addMiniMap(a,d.miniMapLayer,b)},_addMiniMap:function(e,k,l){var c=this.options.miniMapZoomOffset,b=this._map.getMinZoom(),h=this._map.getMaxZoom();k=new L.GeoMap(l,{dragging:!1,touchZoom:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,trackResize:!1,attributionControl:!1,zoomControl:!1,inertia:!1,worldCopyJump:!1,basetileLayer:[k],minZoom:b+c,maxZoom:h+c});this._miniMaps[e]=k},_addLayer:function(e,k){var l=L.stamp(e),c,b,h;if(e instanceof L.LayerGroup)for(c in b=new L.LayerGroup,e._layers)h=e._layers[c],h instanceof L.GeoWMTSLayer&&b.addLayer(new L.GeoWMTSLayer(h._url,h.options));else b=new L.GeoWMTSLayer(e._url,e.options);this._layers.push({id:l,name:k,mainMapLayer:e,miniMapLayer:b});this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_findLayer:function(e){var k=this._layers,l=k.length,c,b;for(c=0;c<l;c++)if(b=k[c],b.id===e)return b;return null},_getCurrentTarget:function(e){return e.currentTarget?e.currentTarget:this._getFirstElementWithClass(e.srcElement,"map-container")},_getFirstElementWithClass:function(e,k){var l=L.DomUtil.hasClass(e,k),c=e.parentNode;return l?e:this._getFirstElementWithClass(c,k)},_onMiniMapClicked:function(e){var k=this._container;e=this._getCurrentTarget(e);var l=e.layerId,c;L.DomUtil.hasClass(this._container,"expanded")&&l!==this._activeLayerId&&(c=this._findLayer(l),L.DomUtil.addClass(k,"notransition"),this._switchLayer(l),this._map.fire("baselayerchanged",c.mainMapLayer),L.Util.falseFn(e.offsetWidth),L.DomUtil.removeClass(k,"notransition"))},_switchLayer:function(e){var k=this._findLayer(this._activeLayerId),l=this._findLayer(e),c=this._getMiniMapContainer(e),b,h,a;this._moveLayerToBack(l);h=this._layers[0].id;a=this._getMiniMapContainer(h);this._suggestedLayerId=h;this._activeLayerId=e;this._forEachLayer(function(a){b=this._getMiniMapContainer(a.id);L.DomUtil.removeClass(b,"active-map");L.DomUtil.removeClass(b,"suggested-map")});L.DomUtil.addClass(c,"active-map");L.DomUtil.addClass(a,"suggested-map");this._map.removeLayer(k.mainMapLayer);this._map.addLayer(l.mainMapLayer)},_moveLayerToBack:function(e){e=e.id;var k=this._layers,l=k.length,c;for(c=0;c<l;c++)if(k[c].id===e){e=k.splice(c,1)[0];k.push(e);break}},_animateMiniMaps:function(e){var k=0,l=this.options.miniMapWidth,c=this.options.miniMapMargin,b=this._container,h,a;L.DomUtil.hasClass(b,"expanded")!==e&&(this._forEachLayer(function(b){a=b.id;h=this._getMiniMapContainer(a);this._updateMiniMapPosition(a);e?(h.style.right=k*(l+c)+"px",k++):h.style.right="0"}),e?(b.style.width=k*(l+c)-c+"px",L.DomUtil.addClass(b,"expanded")):(b.style.width="0",L.DomUtil.removeClass(b,"expanded")))},_getInitialMainMapLayerId:function(){var e,k;this._forEachLayer(function(l){e=l.mainMapLayer;if(this._map.hasLayer(e))return k=l.id,!1});if(k)return k;this._forEachLayer(function(e){k=e.id;return!1});return k},_getInitialMiniMapLayerId:function(e){var k,l;this._forEachLayer(function(c){k=c.id;if(k!==e)return l=k,!1});return l},_forEachLayer:function(e){var k=this._layers,l=k.length,c,b;for(b=0;b<l&&(c=k[b],!1!==e.call(this,c));b++);},_getMiniMapContainer:function(e){return this._miniMaps[e].getContainer().parentNode.parentNode},_updateMiniMaps:function(){var e=this._suggestedLayerId;L.DomUtil.hasClass(this._container,"expanded")?this._forEachLayer(function(e){this._updateMiniMapPosition(e.id)},this):this._updateMiniMapPosition(e)},_updateMiniMapPosition:function(e){var k,l;this._mainMapReady&&this._hasMultipleLayers()&&(k=this._map,l=k.getCenter(),k=k.getZoom()+this.options.miniMapZoomOffset,this._miniMaps[e].setView(l,k,{pan:{animate:!1},zoom:{animate:!0}}))},_onMapReady:function(){this._mainMapReady=!0},_hasMultipleLayers:function(){return 0<this._layers.length}});L.control.miniMapLayerSwitcher=function(e,k){return new L.Control.MiniMapLayerSwitcher(e,k)}})();(function(e,k,l){L.CToolbar=(L.Layer||L.Class).extend({statics:{baseClass:"leaflet-toolbar"},includes:L.Mixin.Events,options:{className:"",filter:function(){return!0},actions:[]},initialize:function(b){L.setOptions(this,b);this._toolbar_type=this.constructor._toolbar_class_id},addTo:function(b){this._arguments=[].slice.call(arguments);b.addLayer(this);return this},onAdd:function(b){var c=b._toolbars[this._toolbar_type];0===this._calculateDepth()&&(c&&b.removeLayer(c),b._toolbars[this._toolbar_type]=this)},onRemove:function(b){0===this._calculateDepth()&&delete b._toolbars[this._toolbar_type]},appendToContainer:function(b){var c=this.constructor.baseClass+"-"+this._calculateDepth()+" "+this.options.className,a;this._container=b;this._ul=L.DomUtil.create("ul",c,b);this._disabledEvents=["click","mousemove","dblclick"];b=0;for(c=this._disabledEvents.length;b<c;b++)L.DomEvent.on(this._ul,this._disabledEvents[b],L.DomEvent.stopPropagation);b=0;for(c=this.options.actions.length;b<c;b++)a=this._getActionConstructor(this.options.actions[b]),a=new a,a._createIcon(this,this._ul,this._arguments)},_getActionConstructor:function(b){var c=this._arguments,a=this;return b.extend({initialize:function(){b.prototype.initialize.apply(this,c)},enable:function(c){a._active&&a._active.disable();a._active=this;b.prototype.enable.call(this,c)}})},_hide:function(){this._ul.style.display="none"},_show:function(){this._ul.style.display="block"},_calculateDepth:function(){for(var b=0,c=this.parentToolbar;c;)b+=1,c=c.parentToolbar;return b}});L.toolbar={};var c=0;L.CToolbar.extend=function(b){var h=L.extend({},b.statics,{_toolbar_class_id:c});c+=1;L.extend(b,{statics:h});return L.Class.extend.call(this,b)};L.Map.addInitHook(function(){this._toolbars={}});L.ToolbarAction=L.Handler.extend({statics:{baseClass:"leaflet-toolbar-icon"},options:{toolbarIcon:{html:"",className:"",tooltip:""},subToolbar:new L.CToolbar},initialize:function(b){var c=L.ToolbarAction.prototype.options.toolbarIcon;L.setOptions(this,b);this.options.toolbarIcon=L.extend({},c,this.options.toolbarIcon)},enable:function(){this._enabled||(this._enabled=!0,L.DomUtil.addClass(this._link,"enable"),this.addHooks&&this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,L.DomUtil.removeClass(this._link,"enable"),this.removeHooks&&this.removeHooks())},_createIcon:function(b,c,a){var d=this.options.toolbarIcon;this.toolbar=b;this._icon=L.DomUtil.create("li","",c);this._link=L.DomUtil.create("a","",this._icon);this._link.innerHTML=d.html;this._link.setAttribute("href","#");this._link.setAttribute("title",d.tooltip);L.DomUtil.addClass(this._link,this.constructor.baseClass);d.className&&L.DomUtil.addClass(this._link,d.className);L.DomEvent.on(this._link,"click",this._click,this);this._addSubToolbar(b,this._icon,a)},_click:function(){this._enabled?this.disable():this.enable()},_addSubToolbar:function(b,c,a){var d=this.options.subToolbar,g=this.addHooks,f=this.removeHooks;d.parentToolbar=b;0<d.options.actions.length&&(a=[].slice.call(a),a.push(this),d.addTo.apply(d,a),d.appendToContainer(c),this.addHooks=function(a){"function"===typeof g&&g.call(this,a);d._show()},this.removeHooks=function(a){"function"===typeof f&&f.call(this,a);d._hide()})}});L.toolbarAction=function(b){return new L.ToolbarAction(b)};L.ToolbarAction.extendOptions=function(b){return this.extend({options:b})};L.ToolbarClickAction=L.Handler.extend({statics:{baseClass:"leaflet-toolbar-icon"},options:{toolbarIcon:{html:"",className:"",tooltip:""},subToolbar:new L.CToolbar},initialize:function(b){var c=L.ToolbarClickAction.prototype.options.toolbarIcon;L.setOptions(this,b);this.options.toolbarIcon=L.extend({},c,this.options.toolbarIcon)},enable:function(){this._enabled||(this._enabled=!0,L.DomUtil.addClass(this._link,"enable"))},disable:function(){this._enabled&&(this._enabled=!1,L.DomUtil.removeClass(this._link,"enable"))},_createIcon:function(b,c,a){var d=this.options.toolbarIcon;this.toolbar=b;this._icon=L.DomUtil.create("li","",c);this._link=L.DomUtil.create("a","",this._icon);this._link.innerHTML=d.html;this._link.setAttribute("href","#");this._link.setAttribute("title",d.tooltip);L.DomUtil.addClass(this._link,this.constructor.baseClass);d.className&&L.DomUtil.addClass(this._link,d.className);L.DomEvent.on(this._link,"click",this._click,this);this._addSubToolbar(b,this._icon,a)},_click:function(){this._enabled?this.disable():this.enable();this.addHooks&&this.addHooks()},_addSubToolbar:function(b,c,a){var d=this.options.subToolbar,g=this.addHooks,f=this.removeHooks;d.parentToolbar=b;0<d.options.actions.length&&(a=[].slice.call(a),a.push(this),d.addTo.apply(d,a),d.appendToContainer(c),this.addHooks=function(a){"function"===typeof g&&g.call(this,a);d._show()},this.removeHooks=function(a){"function"===typeof f&&f.call(this,a);d._hide()})}});L.toolbarClickAction=function(b){return new L.ToolbarClickAction(b)};L.ToolbarClickAction.extendOptions=function(b){return this.extend({options:b})};L.CToolbar.Control=L.CToolbar.extend({statics:{baseClass:"leaflet-control-toolbar "+L.CToolbar.baseClass},initialize:function(b){L.CToolbar.prototype.initialize.call(this,b);this._control=new L.Control.CToolbar(this.options)},onAdd:function(b){this._control.addTo(b);L.CToolbar.prototype.onAdd.call(this,b);this.appendToContainer(this._control.getContainer())},onRemove:function(b){L.CToolbar.prototype.onRemove.call(this,b);this._control.remove?this._control.remove():this._control.removeFrom(b)}});L.Control.CToolbar=L.Control.extend({options:{position:"bottomright"},onAdd:function(){return L.DomUtil.create("div","leaflet-toolbar")}});L.toolbar.control=function(b){return new L.CToolbar.Control(b)};L.CToolbar.Popup=L.CToolbar.extend({statics:{baseClass:"leaflet-popup-toolbar "+L.CToolbar.baseClass},options:{anchor:[0,0]},initialize:function(b,c){L.CToolbar.prototype.initialize.call(this,c);this._marker=new L.Marker(b,{icon:new L.DivIcon({className:this.options.className,iconAnchor:[0,0]})})},onAdd:function(b){this._map=b;this._marker.addTo(b);L.CToolbar.prototype.onAdd.call(this,b);this.appendToContainer(this._marker._icon);this._setStyles()},onRemove:function(b){b.removeLayer(this._marker);L.CToolbar.prototype.onRemove.call(this,b);delete this._map},setLatLng:function(b){this._marker.setLatLng(b);return this},_setStyles:function(){for(var b=this._container,c=this._ul,a=L.point(this.options.anchor),d=c.querySelectorAll(".leaflet-toolbar-icon"),g=[],f=0,e=0,k=d.length;e<k;e++)d[e].parentNode.parentNode===c&&(g.push(parseInt(L.DomUtil.getStyle(d[e],"height"),10)),f+=Math.ceil(parseFloat(L.DomUtil.getStyle(d[e],"width"))));c.style.width=f+"px";this._tipContainer=L.DomUtil.create("div","leaflet-toolbar-tip-container",b);this._tipContainer.style.width=f+"px";this._tip=L.DomUtil.create("div","leaflet-toolbar-tip",this._tipContainer);c=Math.max.apply(l,g);d=parseInt(L.DomUtil.getStyle(this._tip,"width"),10);f=new L.Point(f/2,c+.7071*d);b.style.marginLeft=a.x-f.x+"px";b.style.marginTop=a.y-f.y+"px"}});L.toolbar.popup=function(b){return new L.CToolbar.Popup(b)};L.Text=L.Layer.extend({includes:L.Mixin.Events,options:{autoPan:!0,offset:new L.Point(0,30),autoPanPadding:new L.Point(5,5),latlng:null,content:"",className:""},layerType:"textLayer",initialize:function(b){L.Util.setOptions(this,b)},onAdd:function(b){this._map=b;this._container||this._initLayout();b._panes.popupPane.appendChild(this._container);b.on("viewreset",this._updatePosition,this);if(L.Browser.any3d)b.on("zoomanim",this._zoomAnimation,this);this._update()},addTo:function(b){b.addLayer(this);return this},onRemove:function(b){b._panes.popupPane.removeChild(this._container);b.off({viewreset:this._updatePosition,zoomanim:this._zoomAnimation},this);this._map=null},setLatLng:function(b){this.options.latlng=L.latLng(b);this._updatePosition();return this},setContent:function(b){this.options.content=b;this._updateContent();return this},_initLayout:function(){this._container=L.DomUtil.create("lable","imap-text "+this.options.className+" imap-zoom-animated");this._contentNode=L.DomUtil.create("span","imap-text-content",this._container)},_update:function(){this._map&&(this._updateContent(),this._updatePosition())},_updateContent:function(){this.options.content&&("string"==typeof this.options.content?this._contentNode.innerHTML=this.options.content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this.options.content)))},_updatePosition:function(){var b=this._map.latLngToLayerPoint(this.options.latlng),c=L.Browser.any3d,a=this.options.offset;c&&L.DomUtil.setPosition(this._container,b);this._containerBottom=-a.y-(c?0:b.y);this._containerLeft=a.x+(c?0:b.x);this._container.style.bottom=this._containerBottom+"px";this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(b){b=this._map._latLngToNewLayerPoint(this.options.latlng,b.zoom,b.center);L.DomUtil.setPosition(this._container,b)}});L.ComputeDist=L.ToolbarClickAction.extend({options:{toolbarIcon:{className:"leaflet-ComputeDist"}},_rad:Math.PI/180,initialize:function(b,c){this._map=b;this._map._distControl=this;L.setOptions(this,c);L.ToolbarClickAction.prototype.initialize.call(this,b,c)},_onMouseClick:function(){this._map._areaControl._startCompute&&this._map._areaControl._finishCompute();this._startCompute?this._finishCompute():this._enableCompute()},_setPath:function(b){b=b.latlng||this._map.mouseEventToLatLng(b);if(this._startPath){if(!b.equals(this._lastPoint)){var c=this._currentDist._latlngs;c.push(b);var a=c.length;this._totalDist+=this._getDistance(c[a-2],c[a-1]);this._addMarker(b);this._addLable(b,this._getDistanceString(this._totalDist),"dist-point")}}else this._currentDist={_layers:[],_latlngs:[]},this._addPath(b),this._totalDist=0,this._startPath=!0,this._addMarker(b),this._addLable(b,"\u8d77\u70b9","dist-start"),this._currentDist._latlngs.push(b);this._lastPoint=b;this._startMove=!1},_onMove:function(b){var c=b.latlng;b=b.containerPoint;var a=this._map._cursorTip;a.style.left=b.x+7+"px";a.style.top=b.y+23+"px";a.style.display="";this._startPath&&(this._startMove?this._currentPath.setLatLngs(this._currentDist._latlngs.concat(c)):(this._currentPath.addLatLng(c),this._startMove=!0))},_finishCompute:function(b){this._startPath&&(1<this._currentDist._latlngs.length?((!b||"contextmenu"===b.type)&&this._currentPath.setLatLngs(this._currentDist._latlngs),this._addReomveMarker(this._lastPoint),this._currentDist.lastLable._container.style.display="none",this._addLable(this._lastPoint,this._getDistanceString(this._totalDist),"dist-end")):this._clearLayers.call(this._currentDist));this._disableCompute()},_enableCompute:function(){var b=this._map;b.contextMenu&&b.contextMenu.disable();this._startCompute=!0;b.on("click",this._setPath,this);b.on("dblclick contextmenu",this._finishCompute,this);b.doubleClickZoom.disable();var c=b._cursorTip=L.DomUtil.create("div","imap-cursorTip",b._container);c.style.cssText=" z-index: 1000;position:absolute;background-color:#fff;border:1px solid #f00;display:none;padding:2px;white-space:nowrap;";c.innerHTML="\u5355\u51fb\u786e\u5b9a\u5730\u70b9\uff0c\u53cc\u51fb\u7ed3\u675f";b.on("mousemove",this._onMove,this)},_disableCompute:function(){var b=this._map;b.contextMenu&&b.contextMenu.enable();b._cursorTip.style.display="none";b.off("click",this._setPath,this);b.off("dblclick contextmenu",this._finishCompute,this);b.off("mousemove",this._onMove,this);b.doubleClickZoom.enable();this._startCompute=this._startMove=this._startPath=!1},_addMarker:function(b){var c=new L.Icon({iconUrl:"../src/Control/images/transparent.png",iconSize:[11,11],iconAnchor:[6,6],className:"md-icon"});b=new L.Marker(b,{icon:c,clickable:!1});this._map.addLayer(b);this._currentDist._layers.push(b)},_addPath:function(b){b=this._currentPath=new L.Polyline([b],{weight:2});this._map.addLayer(b);this._currentDist._layers.push(b);this._currentDist._map=this._map},_addLable:function(b,c,a){b=this._currentDist.lastLable=new L.Text({latlng:b,content:c,className:a});this._map.addLayer(b);this._currentDist._layers.push(b)},_addReomveMarker:function(b){var c=new L.Icon({iconUrl:"../src/Control/images/transparent.png",iconSize:[12,12],iconAnchor:[-10,7],className:"md-remove-icon"});b=new L.Marker(b,{icon:c});b.on("click",this._clearLayers,this._currentDist);this._map.addLayer(b);this._currentDist._layers.push(b)},_clearLayers:function(){var b,c=this._layers,a;b=0;for(a=c.length;b<a;b++)this._map.removeLayer(c[b])},_getDistanceString:function(b){return 1E3>b?b+"\u7c73":(b/1E3).toFixed(1)+"\u516c\u91cc"},_getDistance:function(b,c){var a=this._rad,d=a*b.lat,g=a*c.lat,a=2*Math.asin(Math.sqrt(Math.pow(Math.sin((d-g)/2),2)+Math.cos(d)*Math.cos(g)*Math.pow(Math.sin((a*b.lng-a*c.lng)/2),2)));return Math.round(6378137*a)}});L.ComputeArea=L.ToolbarClickAction.extend({options:{toolbarIcon:{className:"leaflet-ComputeDist"}},_rad:Math.PI/180,_deg:180/Math.PI,initialize:function(b,c){this._map=b;this._map._areaControl=this;L.setOptions(this,c);L.ToolbarClickAction.prototype.initialize.call(this,b,c)},addHooks:function(){this._onMouseClick()},_onMouseClick:function(){this._map._distControl._startCompute&&this._map._distControl._finishCompute();this._startCompute?this._finishCompute():this._enableCompute()},_setArea:function(b){b=b.latlng||this._map.mouseEventToLatLng(b);this._startArea?b.equals(this._lastPoint)||(this._addMarker(b),this._compute._latlngs.push(b)):(this._compute={_layers:[],_latlngs:[]},this._addArea(b),this._map.on("mousemove",this._onMove,this),this._startArea=!0,this._addMarker(b),this._compute._latlngs.push(b));this._lastPoint=b;this._startMove=!1},_onMove:function(b){var c=b.latlng;b=b.containerPoint;var a=this._map._cursorTip;a.style.left=b.x+7+"px";a.style.top=b.y+23+"px";a.style.display="";this._startArea&&(this._startMove?this._area.setLatLngs(this._compute._latlngs.concat(c)):(this._area.addLatLng(c),this._startMove=!0))},_finishCompute:function(b){this._startArea&&(2<this._compute._latlngs.length?((!b||"contextmenu"===b.type)&&this._area.setLatLngs(this._compute._latlngs),this._addReomveMarker(this._lastPoint),this._addLable(this._lastPoint,this._getAreaString(this._compute._latlngs),"area-result")):this._clearLayers.call(this._compute));this._disableCompute()},_enableCompute:function(){var b=this._map;b.contextMenu&&b.contextMenu.disable();this._startCompute=!0;b.on("click",this._setArea,this);b.on("dblclick contextmenu",this._finishCompute,this);b.doubleClickZoom.disable();var c=b._cursorTip=L.DomUtil.create("div","imap-cursorTip",b._container);c.style.cssText=" z-index: 1000;position:absolute;background-color:#fff;border:1px solid #f00;display:none;padding:2px;white-space:nowrap;";c.innerHTML="\u5355\u51fb\u786e\u5b9a\u5730\u70b9\uff0c\u53cc\u51fb\u7ed3\u675f";b.on("mousemove",this._onMove,this)},_disableCompute:function(){var b=this._map;b.contextMenu&&b.contextMenu.enable();b._cursorTip.style.display="none";b.off("click",this._setArea,this);b.off("dblclick contextmenu",this._finishCompute,this);b.off("mousemove",this._onMove,this);b.doubleClickZoom.enable();this._startCompute=this._startMove=this._startArea=!1},_addMarker:function(b){var c=new L.Icon({iconUrl:"../src/Control/images/transparent.png",iconSize:[11,11],iconAnchor:[6,6],className:"md-icon"});b=new L.Marker(b,{icon:c,clickable:!1});this._map.addLayer(b);this._compute._layers.push(b)},_addArea:function(b){b=this._area=new L.Polygon([b],{weight:2,clickable:!1});this._map.addLayer(b);this._compute._layers.push(b);this._compute._map=this._map},_addLable:function(b,c,a){b=this._compute.lastLable=new L.Text({latlng:b,content:c,className:a});this._map.addLayer(b);this._compute._layers.push(b)},_addReomveMarker:function(b){var c=new L.Icon({iconUrl:"../src/Control/images/transparent.png",iconSize:[12,12],iconAnchor:[-10,7],className:"md-remove-icon"});b=new L.Marker(b,{icon:c});b.on("click",this._clearLayers,this._compute);this._map.addLayer(b);this._compute._layers.push(b)},_clearLayers:function(){var b,c=this._layers,a;b=0;for(a=c.length;b<a;b++)this._map.removeLayer(c[b])},_getAreaString:function(b){b=Math.round(this._computeArea(b));return 1E6>b?b+"\u5e73\u65b9\u7c73":(b/1E6).toFixed(2)+"\u5e73\u65b9\u516c\u91cc"},_computeArea:function(b){var c=0,a,d,g,f=b.length;for(a=0;a<f;++a)d=(a+1)%f,g=(a+2)%f,c+=this._angle(b[a],b[d],b[g]);b=180*(f-2);a=c-b;420<a?a=360*f-c-b:300<a&&420>a&&(a=Math.abs(360-a));return a*this._rad*40680631590769},_angle:function(b,c,a){b=this._bearing(c,b);c=this._bearing(c,a);c=b-c;0>c&&(c+=360);return c},_bearing:function(b,c){var a=this._rad,d=b.lat*a,g=b.lng*a,f=c.lat*a,a=a*c.lng,d=-Math.atan2(Math.sin(g-a)*Math.cos(f),Math.cos(d)*Math.sin(f)-Math.sin(d)*Math.cos(f)*Math.cos(g-a));0>d&&(d+=2*Math.PI);return d*=this._deg}})})(window,document);(function(e,k,l){L.drawVersion="0.4.9";L.Draw={};L.drawLocal={draw:{toolbar:{actions:{title:"\u53d6\u6d88\u7ed8\u5236",text:"\u53d6\u6d88"},finish:{title:"\u5b8c\u6210\u7ed8\u5236",text:"\u5b8c\u6210"},undo:{title:"\u5220\u9664\u6700\u540e\u4e00\u4e2a\u5df2\u7ed8\u5236\u7684\u70b9",text:"\u5220\u9664\u6700\u540e\u7ed8\u5236\u70b9"},buttons:{polyline:"\u7ed8\u5236\u591a\u6bb5\u7ebf",polygon:"\u7ed8\u5236\u591a\u8fb9\u5f62",rectangle:"\u7ed8\u5236\u957f\u65b9\u5f62",circle:"\u7ed8\u5236\u5706",marker:"\u7ed8\u5236\u6807\u8bb0"}},handlers:{circle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706"},radius:"\u534a\u5f84"},marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u653e\u7f6e"}},polygon:{tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u9762",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u9762"}},polyline:{error:"\x3cstrong\x3e\u9519\u8bef:\x3c/strong\x3e \u4e0d\u53ef\u81ea\u4ea4\u53c9!",tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u7ebf"}},rectangle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706\u77e9\u5f62"}},simpleshape:{tooltip:{end:"\u653e\u5f00\u9f20\u6807\u5b8c\u6210\u7ed8\u5236"}}}},edit:{toolbar:{actions:{save:{title:"\u4fdd\u5b58\u4fee\u6539",text:"\u4fdd\u5b58"},cancel:{title:"\u53d6\u6d88\u7f16\u8f91\uff0c\u653e\u5f03\u4fee\u6539",text:"\u53d6\u6d88"}},buttons:{edit:"\u7f16\u8f91\u56fe\u5c42",editDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u7f16\u8f91",remove:"\u5220\u9664\u56fe\u5c42",removeDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u5220\u9664"}},handlers:{edit:{tooltip:{text:"\u62d6\u52a8\u63a7\u5236\u70b9\u6216\u6807\u8bb0\u4ee5\u4fee\u6539\u8981\u7d20",subtext:"\u70b9\u51fb\u53d6\u6d88\u653e\u5f03\u4fee\u6539"}},remove:{tooltip:{text:"\u70b9\u51fb\u4e00\u4e2a\u8981\u7d20\u4ee5\u5220\u9664"}}}}};L.Draw.Event={};L.Draw.Event.CREATED="draw:created";L.Draw.Event.EDITED="draw:edited";L.Draw.Event.DELETED="draw:deleted";L.Draw.Event.DRAWSTART="draw:drawstart";L.Draw.Event.DRAWSTOP="draw:drawstop";L.Draw.Event.DRAWVERTEX="draw:drawvertex";L.Draw.Event.EDITSTART="draw:editstart";L.Draw.Event.EDITMOVE="draw:editmove";L.Draw.Event.EDITRESIZE="draw:editresize";L.Draw.Event.EDITVERTEX="draw:editvertex";L.Draw.Event.EDITSTOP="draw:editstop";L.Draw.Event.DELETESTART="draw:deletestart";L.Draw.Event.DELETESTOP="draw:deletestop";L.Draw=L.Draw||{};L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(c,b){this._map=c;this._container=c._container;this._overlayPane=c._panes.overlayPane;this._popupPane=c._panes.popupPane;b&&b.shapeOptions&&(b.shapeOptions=L.Util.extend({},this.options.shapeOptions,b.shapeOptions));L.setOptions(this,b)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(L.DomUtil.disableTextSelection(),c.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(c){L.setOptions(this,c)},_fireCreatedEvent:function(c){this._map.fire(L.Draw.Event.CREATED,{layer:c,layerType:this.type})},_cancelDrawing:function(c){this._map.fire("draw:canceled",{layerType:this.type});27===c.keyCode&&this.disable()}});L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4E3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2E3},initialize:function(c,b){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error;b&&b.drawError&&(b.drawError=L.Util.extend({},this.options.drawError,b.drawError));this.type=L.Draw.Polyline.TYPE;L.Draw.Feature.prototype.initialize.call(this,c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._clearGuides();this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(1>=this._markers.length)){var c=this._markers.pop(),b=this._poly,e=b.getLatLngs(),a=e.splice(-1,1)[0];this._poly.setLatLngs(e);this._markerGroup.removeLayer(c);2>b.getLatLngs().length&&this._map.removeLayer(b);this._vertexChanged(a,!1)}},addVertex:function(c){2<=this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(c)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(c)),this._poly.addLatLng(c),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(c,!0))},completeShape:function(){1>=this._markers.length||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var c=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),c=this._poly.newLatLngIntersects(c[c.length-1]);!this.options.allowIntersection&&c||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent),e=this._map.layerPointToLatLng(b);this._currentLatLng=e;this._updateTooltip(e);this._updateGuide(b);this._mouseMarker.setLatLng(e);L.DomEvent.preventDefault(c.originalEvent)},_vertexChanged:function(c,b){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup});this._updateFinishHandler();this._updateRunningMeasure(c,b);this._clearGuides();this._updateTooltip()},_onMouseDown:function(c){this._clickHandled||this._touchHandled||this._disableMarkers||(this._onMouseMove(c),this._clickHandled=!0,this._disableNewMarkers(),c=c.originalEvent,this._startPoint.call(this,c.clientX,c.clientY))},_startPoint:function(c,b){this._mouseDownOrigin=L.point(c,b)},_onMouseUp:function(c){var b=c.originalEvent;this._endPoint.call(this,b.clientX,b.clientY,c);this._clickHandled=null},_endPoint:function(c,b,h){this._mouseDownOrigin&&(c=L.point(c,b).distanceTo(this._mouseDownOrigin),10>this._calculateFinishDistance(h.latlng)&&L.Browser.touch?this._finishShape():Math.abs(c)<9*(e.devicePixelRatio||1)&&this.addVertex(h.latlng),this._enableNewMarkers());this._mouseDownOrigin=null},_onTouch:function(c){var b=c.originalEvent,e;!b.touches||!b.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=b.touches[0].clientX,b=b.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,b),this._endPoint.call(this,e,b,c),this._touchHandled=null);this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(c){var b;if(0<this._markers.length){if(this.type===L.Draw.Polyline.TYPE)b=this._markers[this._markers.length-1];else if(this.type===L.Draw.Polygon.TYPE)b=this._markers[0];else return Infinity;b=this._map.latLngToContainerPoint(b.getLatLng());c=new L.Marker(c,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});c=this._map.latLngToContainerPoint(c.getLatLng());b=b.distanceTo(c)}else b=Infinity;return b},_updateFinishHandler:function(){var c=this._markers.length;if(1<c)this._markers[c-1].on("click",this._finishShape,this);2<c&&this._markers[c-2].off("click",this._finishShape,this)},_createMarker:function(c){c=new L.Marker(c,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});this._markerGroup.addLayer(c);return c},_updateGuide:function(c){var b=this._markers?this._markers.length:0;0<b&&(c=c||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[b-1].getLatLng()),c))},_updateTooltip:function(c){var b=this._getTooltipText();c&&this._tooltip.updatePosition(c);this._errorShown||this._tooltip.updateContent(b)},_drawGuide:function(c,b){var e=Math.floor(Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2))),a=this.options.guidelineDistance,d=this.options.maxGuideLineLength,a=e>d?e-d:a,g;this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));for(;a<e;a+=this.options.guidelineDistance)d=a/e,d={x:Math.floor(c.x*(1-d)+d*b.x),y:Math.floor(c.y*(1-d)+d*b.y)},g=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),g.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(g,d)},_updateGuideColor:function(c){if(this._guidesContainer)for(var b=0,e=this._guidesContainer.childNodes.length;b<e;b++)this._guidesContainer.childNodes[b].style.backgroundColor=c},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var c=this.options.showLength;L.Browser.touch&&(c=!1);0===this._markers.length?c={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(c=c?this._getMeasurementString():"",c=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:c}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:c});return c},_updateRunningMeasure:function(c,b){var e=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(e=c.distanceTo(this._markers[e-(b?2:1)].getLatLng()),this._measurementRunningTotal+=e*(b?1:-1))},_getMeasurementString:function(){var c=this._currentLatLng,b=this._markers[this._markers.length-1].getLatLng(),c=this._measurementRunningTotal+c.distanceTo(b);return L.GeometryUtil.readableDistance(c,this.options.metric,this.options.feet,this.options.nautic)},_showErrorTooltip:function(){this._errorShown=!0;this._tooltip.showAsError().updateContent({text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1;this._clearHideErrorTimeout();this._tooltip.removeError().updateContent(this._getTooltipText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var c=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,c)}});L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(c,b){L.Draw.Polyline.prototype.initialize.call(this,c,b);this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var c=this._markers.length;if(1===c)this._markers[0].on("click",this._finishShape,this);2<c&&(this._markers[c-1].on("dblclick",this._finishShape,this),3<c&&this._markers[c-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var c,b;0===this._markers.length?c=L.drawLocal.draw.handlers.polygon.tooltip.start:3>this._markers.length?c=L.drawLocal.draw.handlers.polygon.tooltip.cont:(c=L.drawLocal.draw.handlers.polygon.tooltip.end,b=this._getMeasurementString());return{text:c,subtext:b}},_getMeasurementString:function(){var c=this._area;return c?L.GeometryUtil.readableArea(c,this.options.metric):null},_shapeIsValid:function(){return 3<=this._markers.length},_vertexChanged:function(c,b){var e;!this.options.allowIntersection&&this.options.showArea&&(e=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(e));L.Draw.Polyline.prototype._vertexChanged.call(this,c,b)},_cleanUpShape:function(){var c=this._markers.length;0<c&&(this._markers[0].off("click",this._finishShape,this),2<c&&this._markers[c-1].off("dblclick",this._finishShape,this))}});L.SimpleShape={};L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(c,b){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end;L.Draw.Feature.prototype.initialize.call(this,c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&((this._mapDraggable=this._map.dragging.enabled())&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(k,"mouseup",this._onMouseUp,this),L.DomEvent.off(k,"touchend",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape));this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(c){this._isDrawing=!0;this._startLatLng=c.latlng;L.DomEvent.on(k,"mouseup",this._onMouseUp,this).on(k,"touchend",this._onMouseUp,this).preventDefault(c.originalEvent)},_onMouseMove:function(c){c=c.latlng;this._tooltip.updatePosition(c);this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(c))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()}});L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,showArea:!0,clickable:!0},metric:!0},initialize:function(c,b){this.type=L.Draw.Rectangle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,c,b)},_drawShape:function(c){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,c)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,c),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var c=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,c)},_getTooltipText:function(){var c=L.Draw.SimpleShape.prototype._getTooltipText.call(this),b=this.options.showArea,e;this._shape&&(e=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(e),e=b?L.GeometryUtil.readableArea(e,this.options.metric):"");return{text:c.text,subtext:e}}});L.Draw.Textbox=L.Draw.Rectangle.extend({statics:{TYPE:"textbox"},options:{shapeOptions:{},textOptions:{borderColor:"#4387fd",borderWidth:2}},initialize:function(c,b){this.options.textOptions=L.extend({},this.options.textOptions,b);this._setShapeOptions();L.Draw.Rectangle.prototype.initialize.call(this,c,b);this.type=L.Draw.Textbox.TYPE},_fireCreatedEvent:function(){var c=this._shape.getLatLngs()[0],b=(new L.LatLngBounds(c)).getCenter(),e=c[3],c=this._map.latLngToLayerPoint(c[1]).round(),a=this._map.latLngToLayerPoint(e).round(),e=a.x-c.x+2,c=a.y-c.y+2,b=(new L.Textbox(b,this.options.textOptions)).setSize(new L.Point(e,c));L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,b)},_setShapeOptions:function(){this.options.shapeOptions=L.extend({},this.options.shapeOptions,{weight:this.options.textOptions.borderWidth?this.options.textOptions.borderWidth:2,color:this.options.textOptions.borderColor?this.options.textOptions.borderColor:"#4387fd",fill:!1,opacity:1})}});L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(c,b){this.type=L.Draw.Circle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,c,b)},_drawShape:function(c){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(c)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(c),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var c=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,c)},_onMouseMove:function(c){var b=c.latlng;c=this.options.showRadius;var e=this.options.metric;this._tooltip.updatePosition(b);if(this._isDrawing){this._drawShape(b);var b=this._shape.getRadius().toFixed(1),a="";c&&(a=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(b,e,this.options.feet,this.options.nautic));this._tooltip.updateContent({text:this._endLabelText,subtext:a})}}});L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2E3},initialize:function(c,b){this.type=L.Draw.Marker.TYPE;L.Draw.Feature.prototype.initialize.call(this,c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(c){c=c.latlng;this._tooltip.updatePosition(c);this._mouseMarker.setLatLng(c);this._marker?(c=this._mouseMarker.getLatLng(),this._marker.setLatLng(c)):(this._marker=new L.Marker(c,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()},_onTouch:function(c){this._onMouseMove(c);this._onClick()},_fireCreatedEvent:function(){var c=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,c)}});L.Edit=L.Edit||{};L.Edit.Marker=L.Handler.extend({initialize:function(c,b){this._marker=c;L.setOptions(this,b)},addHooks:function(){var c=this._marker;c.dragging.enable();c.on("dragend",this._onDragEnd,c);this._toggleMarkerHighlight()},removeHooks:function(){var c=this._marker;c.dragging.disable();c.off("dragend",this._onDragEnd,c);this._toggleMarkerHighlight()},_onDragEnd:function(c){c=c.target;c.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:c})},_toggleMarkerHighlight:function(){var c=this._marker._icon;c&&(c.style.display="none",L.DomUtil.hasClass(c,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(c,"leaflet-edit-marker-selected"),this._offsetMarker(c,-4)):(L.DomUtil.addClass(c,"leaflet-edit-marker-selected"),this._offsetMarker(c,4)),c.style.display="")},_offsetMarker:function(c,b){var e=parseInt(c.style.marginTop,10)-b,a=parseInt(c.style.marginLeft,10)-b;c.style.marginTop=e+"px";c.style.marginLeft=a+"px"}});L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Poly=L.Handler.extend({options:{},initialize:function(c,b){this.latlngs=[c._latlngs];c._holes&&(this.latlngs=this.latlngs.concat(c._holes));this._poly=c;L.setOptions(this,b);this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(c){for(var b=0;b<this._verticesHandlers.length;b++)c(this._verticesHandlers[b])},addHooks:function(){this._initHandlers();this._eachVertexHandler(function(c){c.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(c){c.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(c){c.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var c=0;c<this.latlngs.length;c++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[c],this.options))},_updateLatLngs:function(c){this.latlngs=[c.layer._latlngs];c.layer._holes&&(this.latlngs=this.latlngs.concat(c.layer._holes))}});L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1E3}},initialize:function(c,b,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this._poly=c;e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError));this._latlngs=b;L.setOptions(this,e)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var c=this._poly;c instanceof L.Polygon||(c.options.fill=!1,c.options.editing&&(c.options.editing.fill=!1));c.setStyle(c.options.editing);this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var c=this._poly;c.setStyle(c.options.original);c._map&&(c._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._markers=[];var c=this._defaultShape(),b,e,a;b=0;for(e=c.length;b<e;b++)a=this._createMarker(c[b],b),a.on("click",this._onMarkerClick,this),this._markers.push(a);b=0;for(c=e-1;b<e;c=b++)if(0!==b||L.Polygon&&this._poly instanceof L.Polygon)c=this._markers[c],a=this._markers[b],this._createMiddleMarker(c,a),this._updatePrevNext(c,a)},_createMarker:function(c,b){var e=new L.Marker.Touch(c,{draggable:!0,icon:this.options.icon});e._origLatLng=c;e._index=b;e.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this);this._markerGroup.addLayer(e);return e},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var c=this._defaultShape(),b=[].splice.apply(c,arguments);this._poly._convertLatLngs(c,!0);this._poly.redraw();return b},_removeMarker:function(c){var b=c._index;this._markerGroup.removeLayer(c);this._markers.splice(b,1);this._spliceLatLngs(b,1);this._updateIndexes(b,-1);c.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0;this._poly.fire("edit");this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(c){var b=c.target,e=this._poly;L.extend(b._origLatLng,b._latlng);b._middleLeft&&b._middleLeft.setLatLng(this._getMiddleLatLng(b._prev,b));b._middleRight&&b._middleRight.setLatLng(this._getMiddleLatLng(b,b._next));if(e.options.poly){var a=e._map._editTooltip;if(!e.options.poly.allowIntersection&&e.intersects()){var d=e.options.color;e.setStyle({color:this.options.drawError.color});0!==L.version.indexOf("0.7")&&b.dragging._draggable._onUp(c);this._onMarkerClick(c);a&&a.updateContent({text:L.drawLocal.draw.handlers.polyline.error});setTimeout(function(){e.setStyle({color:d});a&&a.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1E3)}}this._poly.redraw();this._poly.fire("editdrag")},_onMarkerClick:function(c){var b=L.Polygon&&this._poly instanceof L.Polygon?4:3;c=c.target;this._defaultShape().length<b||(this._removeMarker(c),this._updatePrevNext(c._prev,c._next),c._middleLeft&&this._markerGroup.removeLayer(c._middleLeft),c._middleRight&&this._markerGroup.removeLayer(c._middleRight),c._prev&&c._next?this._createMiddleMarker(c._prev,c._next):c._prev?c._next||(c._prev._middleRight=null):c._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.touches[0]),b=this._map.layerPointToLatLng(b);c=c.target;L.extend(c._origLatLng,b);c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c));c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next));this._poly.redraw();this.updateMarkers()},_updateIndexes:function(c,b){this._markerGroup.eachLayer(function(e){e._index>c&&(e._index+=b)})},_createMiddleMarker:function(c,b){var e=this._getMiddleLatLng(c,b),a=this._createMarker(e),d,g,f;a.setOpacity(.6);c._middleRight=b._middleLeft=a;g=function(){a.off("touchmove",g,this);var f=b._index;a._index=f;a.off("click",d,this).on("click",this._onMarkerClick,this);e.lat=a.getLatLng().lat;e.lng=a.getLatLng().lng;this._spliceLatLngs(f,0,e);this._markers.splice(f,0,a);a.setOpacity(1);this._updateIndexes(f,1);b._index++;this._updatePrevNext(c,a);this._updatePrevNext(a,b);this._poly.fire("editstart")};f=function(){a.off("dragstart",g,this);a.off("dragend",f,this);a.off("touchmove",g,this);this._createMiddleMarker(c,a);this._createMiddleMarker(a,b)};d=function(){g.call(this);f.call(this);this._fireEdit()};a.on("click",d,this).on("dragstart",g,this).on("dragend",f,this).on("touchmove",g,this);this._markerGroup.addLayer(a)},_updatePrevNext:function(c,b){c&&(c._next=b);b&&(b._prev=c)},_getMiddleLatLng:function(c,b){var e=this._poly._map,a=e.project(c.getLatLng()),d=e.project(b.getLatLng());return e.unproject(a._add(d)._divideBy(2))}});L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this,this.options.poly),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))});L.RotatableMarker=L.Marker.extend({options:{rotation:0},initialize:function(c,b){L.Marker.prototype.initialize.call(this,c,b);this.setRotation(this.options.rotation)},setRotation:function(c){this._rotation=c;this.update();this.fire("rotate",{rotation:this._rotation});return this},getRotation:function(){return this._rotation},_setPos:function(c){L.DomUtil.setTransform(this._icon,c,this._rotation);this._shadow&&L.DomUtil.setTransform(this._shadow,c,this._rotation);this._zIndex=c.y+this.options.zIndexOffset;this._resetZIndex()}});L.rotatableMarker=function(c,b){return new L.RotatableMarker(c,b)};L.Pointer=L.Path.extend({options:{noClip:!1},initialize:function(c,b,e){L.setOptions(this,e);this._coordinates=b;this._latlng=c},onAdd:function(c){this._map=c;this._container||this._initElements();this._updatePath();this._container&&this._pathRoot.appendChild(this._container);this.fire("add");c.on({viewreset:this._updatePath,moveend:this._updatePath},this)},onRemove:function(c){this._unbindPathRoot();this._pathRoot.parentNode.removeChild(this._pathRoot);c.off({viewreset:this._updatePath,moveend:this._updatePath},this);this.fire("remove");this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(c){this._latlng=c;this._updatePath();return this},getPoints:function(){return this._coordinates},setPoints:function(c){this._coordinates=c;this._updatePath();return this},getPathString:function(){return L.Polyline.prototype.getPathString.call(this)},_getPathPartStr:function(c){return L.Polyline.prototype._getPathPartStr.call(this,c)},_getLatLngs:function(){for(var c=this._map.latLngToLayerPoint(this._latlng),b=[],e=0,a=this._coordinates.length;e<a;e++)b[e]=this._map.layerPointToLatLng(this._coordinates[e].add(c));return b},_projectCoordinatesToLayerPoints:function(){var c=this._map.latLngToLayerPoint(this._latlng),b;this._layerPoints=[];for(var e=0,a=this._coordinates.length;e<a;e++)b=this._coordinates[e].add(c),this._layerPoints[e]=b},_clipPoints:function(){var c=this._layerPoints,b=c.length,e,a,d;if(this.options.noClip)this._parts=[c];else{var g=this._parts=[],f=this._pathViewport,k=L.LineUtil;for(a=e=0;e<b-1;e++)if(d=k.clipSegment(c[e],c[e+1],f,e))if(g[a]=g[a]||[],g[a].push(d[0]),d[1]!==c[e+1]||e===b-2)g[a].push(d[1]),a++}},_updatePath:function(){this._map&&(this._projectCoordinatesToLayerPoints(),this._clipPoints(),this._renderer._updatePath.call(this))}});L.Pointer=L.Pointer.extend({_initElements:function(){this._initPathRoot()},_animateZoom:function(c){var b=this._map.latLngToLayerPoint(this._latlng);c=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).subtract(b);this._pathRoot.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(this._pathViewport.min.add(c));this._pathZooming=!0},_endZoom:function(){this._pathZooming=!1},_initPathRoot:function(){this._pathRoot||(this._pathRoot=L.SVG.create("svg"),this._map._panes.overlayPane.appendChild(this._pathRoot));this._map.options.zoomAnimation&&L.Browser.any3d?(L.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this._map.on({zoomanim:this._animateZoom,zoomend:this._endZoom},this)):L.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide");this._map.on("moveend",this._updateSvgViewport,this);this._updateSvgViewport()},_unbindPathRoot:function(){this._map.off({zoomanim:this._animateZoom,zoomend:this._endZoom,moveend:this._updateSvgViewport},this)},_getPanePos:function(){return L.DomUtil.getPosition(this._pathRoot)},_updatePathViewport:function(){var c=L.Path.CLIP_PADDING,b=this._map.getSize(),e=this._map._getMapPanePos().multiplyBy(-1)._subtract(b.multiplyBy(c)._round()),c=e.add(b.multiplyBy(1+2*c)._round());this._pathViewport=new L.Bounds(e,c)},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var c=this._pathViewport,b=c.min,e=c.max,c=e.x-b.x,e=e.y-b.y,a=this._map._panes.overlayPane;L.Browser.mobileWebkit&&a.removeChild(this._pathRoot);L.DomUtil.setPosition(this._pathRoot,b);this._pathRoot.setAttribute("width",c);this._pathRoot.setAttribute("height",e);this._pathRoot.setAttribute("viewBox",[b.x,b.y,c,e].join(" "));L.Browser.mobileWebkit&&a.appendChild(this._pathRoot)}}});L.Textbox=L.RotatableMarker.extend({statics:{TYPE:"textbox",TEXTEDIT_EVENTS:["change","keyup","paste","cut"]},includes:[L.Mixin.Events],options:{minSize:new L.Point(10,10),textEditable:!0,textContent:""},initialize:function(c,b){b.icon=new L.DivIcon({className:"leaflet-textbox-container",html:'\x3ctextarea style\x3d"width: 100%; height: 100%"\x3e'+this.options.textContent+"\x3c/textarea\x3e",iconAnchor:new L.Point(0,0)});L.RotatableMarker.prototype.initialize.call(this,c,b);this._textContent=this.options.textContent;this._minSize=this.options.minSize;this.setSize(this.options.size||this._minSize)},onAdd:function(c){var b;L.RotatableMarker.prototype.onAdd.call(this,c);c=this.getTextarea();this.setContent(this._textContent);this.setLatLng(this._latlng);this._updateSize();this._enableTyping();this.options.textEditable||c.setAttribute("readonly","readonly");this._addClasses();for(var e=0;e<L.Textbox.TEXTEDIT_EVENTS.length;e++)b=L.Textbox.TEXTEDIT_EVENTS[e],L.DomEvent.on(c,b,this._showIfEmpty,this);this._showIfEmpty({target:c})},addTo:function(c){c.addLayer(this);return this},onRemove:function(c){this._map.dragging.enable();this.getContent();L.RotatableMarker.prototype.onRemove.call(this,c)},getSize:function(){return this._size},setSize:function(c){this._minSize=new L.Point(c.x<this._minSize.x?c.x:this._minSize.x,c.y<this._minSize.y?c.y:this._minSize.y);this._size=c;this._map&&this._updateSize();this.fire("resize",{size:this._size});return this},setContent:function(c){this.getTextarea().innerHTML=c;return this},getContent:function(){this._map&&(this._textContent=this.getTextarea().value);return this._textContent},_updateCenter:function(){this.setLatLng(this._latlng)},setStyle:function(){return this},getTextarea:function(){return this._icon.children[0]},_updateSize:function(){var c=this.getSize();this._icon&&(this._icon.style.marginTop=-Math.round(c.y/2)+"px",this._icon.style.marginLeft=-Math.round(c.x/2)+"px",this._icon.style.width=c.x+"px",this._icon.style.height=c.y+"px")},_onTextEdit:function(){this._text_edited&&(this.fire("textedit",{textContent:this.getContent()}),this._text_edited=!1)},_enableTyping:function(){var c=this._map,b=this.getTextarea(),e=function(){this._text_edited=!0},a;this._selecting=new L.Selectable(b);L.DomEvent.on(b,"click",function(a){a.target.focus()},this);L.DomEvent.on(b,"mouseover",function(){c.dragging.disable();this._selecting.enable()},this);L.DomEvent.on(b,"mouseout",function(){c.dragging.enable();this._selecting.disable()},this);for(var d=0;d<L.Textbox.TEXTEDIT_EVENTS.length;d++)a=L.Textbox.TEXTEDIT_EVENTS[d],L.DomEvent.on(b,a,e,this);L.DomEvent.on(b,"blur",this._onTextEdit,this)},_showIfEmpty:function(c){c=c.target;""===c.value?L.DomUtil.addClass(c,"leaflet-textbox-empty"):L.DomUtil.removeClass(c,"leaflet-textbox-empty")},_addClasses:function(){var c=this.getTextarea();L.DomUtil.addClass(c,"leaflet-textbox");this.options.className&&L.Domutil.addClass(c,this.options.className)}});L.Textbox.prototype.toGeoJSON=function(){var c=this.getSize(),c={textContent:this.getContent(),style:{width:c.x,height:c.y,rotation:this.getRotation()}},b=L.GeoJSON.getFeature(this,{type:"Point",coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())});b.properties=c;return b};L.textbox=function(c,b){return new L.Textbox(c,b)};L.Edit=L.Edit||{};L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(c,b){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon);this._shape=c;L.Util.setOptions(this,b)},addHooks:function(){var c=this._shape;this._shape._map&&(this._map=this._shape._map,c.setStyle(c.options.editing),c._map&&(this._map=c._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var c=this._shape;c.setStyle(c.options.original);if(c._map){this._unbindMarker(this._moveMarker);for(var c=0,b=this._resizeMarkers.length;c<b;c++)this._unbindMarker(this._resizeMarkers[c]);this._resizeMarkers=null;this._map.removeLayer(this._markerGroup);delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._createMoveMarker();this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(c,b){var e=new L.Marker.Touch(c,{draggable:!0,icon:b,zIndexOffset:10});this._bindMarker(e);this._markerGroup.addLayer(e);return e},_bindMarker:function(c){c.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(c){c.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(c){c.target.setOpacity(0);this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0;this._shape.fire("edit")},_onMarkerDrag:function(c){c=c.target;var b=c.getLatLng();c===this._moveMarker?this._move(b):this._resize(b);this._shape.redraw();this._shape.fire("editdrag")},_onMarkerDragEnd:function(c){c.target.setOpacity(1);this._fireEdit()},_onTouchStart:function(c){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,c);if("function"===typeof this._getCorners){var b=this._getCorners();c=c.target;var e=c._cornerIndex;c.setOpacity(0);this._oppositeCorner=b[(e+2)%4];this._toggleCornerMarkers(0,e)}this._shape.fire("editstart")},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.touches[0]),b=this._map.layerPointToLatLng(b);c.target===this._moveMarker?this._move(b):this._resize(b);this._shape.redraw();return!1},_onTouchEnd:function(c){c.target.setOpacity(1);this.updateMarkers();this._fireEdit()},_move:function(){},_resize:function(){}});L.Edit.Textbox=L.Edit.SimpleShape.extend({addHooks:function(){this._shape.dragging.disable();this._shape._map&&(this._map=this._shape._map,this._initHandles(),this._initEvents())},removeHooks:function(){this._shape._map&&(this._map.removeLayer(this._handles),delete this._handles);this._map=null},_initHandles:function(){this._handles||(this._handles=new L.LayerGroup,this._map.addLayer(this._handles),this._addRotateHandle(),this._addResizeHandles(),this._addMoveHandle())},_initEvents:function(){for(var c=function(){this._shape.fire("edit")},b=["resize","rotate","textedit","move"],e=0;e<b.length;e++)this._shape.on(b[e],c,this)},_addRotateHandle:function(){this._rotateHandle=new L.RotateHandle(this._shape,{offset:new L.Point(0,-this._shape.getSize().y)});this._handles.addLayer(this._rotateHandle)},_addMoveHandle:function(){this._moveHandle=new L.MoveHandle(this._shape,{offset:new L.Point(0,0)});this._handles.addLayer(this._moveHandle)},_addResizeHandles:function(){var c=this._shape.getSize(),b=Math.round(c.y/2),e=Math.round(c.x/2),c=new L.ResizeHandle(this._shape,{offset:new L.Point(-e,-b),corner:"upper-left"}),a=new L.ResizeHandle(this._shape,{offset:new L.Point(e,-b),corner:"upper-right"}),d=new L.ResizeHandle(this._shape,{offset:new L.Point(-e,b),corner:"lower-left"}),b=new L.ResizeHandle(this._shape,{offset:new L.Point(e,b),corner:"lower-right"});this._resizeHandles=[c,a,d,b];for(b=0;b<this._resizeHandles.length;b++)this._handles.addLayer(this._resizeHandles[b])}});L.Textbox.addInitHook(function(){});L.Selectable=L.Handler.extend({includes:[L.Mixin.Events],statics:{START:L.Draggable.START,END:L.Draggable.END,MOVE:L.Draggable.MOVE},initialize:function(c,b){this._element=c;this._selectStartTarget=b||c},addHooks:function(){L.DomEvent.on(this._selectStartTarget,L.Selectable.START.join(" "),this._onDown,this)},removeHooks:function(){L.DomEvent.off(this._selectStartTarget,L.Selectable.START.join(" "),this._onDown,this)},_onDown:function(c){L.DomEvent.stopPropagation(c)}});L.EditHandle=L.RotatableMarker.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"})},initialize:function(c,b){L.setOptions(this,b);this._handleOffset=new L.Point(b.offset.x||0,b.offset.y||0);this._handled=c;var e=this._handled._map.layerPointToLatLng(this._textboxCoordsToLayerPoint(this._handleOffset)),a={draggable:!0,icon:this.options.resizeIcon,zIndexOffset:10};this._handled.getRotation&&(a.rotation=this._handled.getRotation());L.RotatableMarker.prototype.initialize.call(this,e,a)},onAdd:function(c){L.RotatableMarker.prototype.onAdd.call(this,c);this._bindListeners()},onRemove:function(c){this._unbindListeners();L.RotatableMarker.prototype.onRemove.call(this,c)},_animateZoom:function(c){var b=this._handled._map,e=b._newLayerPointToLatLng(this._textboxCoordsToLayerPoint(this._handleOffset,c),c.zoom,c.center);c=b._latLngToNewLayerPoint(e,c.zoom,c.center).round();this._setPos(c)},updateHandle:function(){var c=this._handled.getRotation(),b=this._textboxCoordsToLatLng(this._handleOffset);this.setRotation(c);this.setLatLng(b)},_onHandleDragStart:function(){this._handled.fire("editstart")},_onHandleDragEnd:function(){this._fireEdit()},_fireEdit:function(){this._handled.edited=!0;this._handled.fire("edit")},_bindListeners:function(){this.on({dragstart:this._onHandleDragStart,drag:this._onHandleDrag,dragend:this._onHandleDragEnd},this);this._handled._map.on("zoomend",this.updateHandle,this);this._handled.on("rotate",this.updateHandle,this);this._handled.on("resize",this.updateHandle,this);this._handled.on("move",this.updateHandle,this)},_unbindListeners:function(){this.off({dragstart:this._onHandleDragStart,drag:this._onHandleDrag,dragend:this._onHandleDragEnd},this);this._handled._map.off("zoomend",this.updateHandle,this);this._handled.off("update",this.updateHandle,this)},_calculateRotation:function(c,b){return(new L.Point(c.x*Math.cos(b)-c.y*Math.sin(b),c.y*Math.cos(b)+c.x*Math.sin(b))).round()},_layerPointToTextboxCoords:function(c,b){var e=this._handled._map,a=this._handled.getRotation(),d=this._handled.getLatLng(),e=b&&b.zoom&&b.center?e._latLngToNewLayerPoint(d,b.zoom,b.center):e.latLngToLayerPoint(d),e=c.subtract(e);return this._calculateRotation(e,-a)},_textboxCoordsToLayerPoint:function(c,b){var e=this._handled._map,a=this._handled.getRotation(),d=this._handled.getLatLng(),e=b&&b.zoom&&b.center?e._latLngToNewLayerPoint(d,b.zoom,b.center):e.latLngToLayerPoint(d);return this._calculateRotation(c,a).add(e)},_latLngToTextboxCoords:function(c,b){return this._layerPointToTextboxCoords(this._handled._map.latLngToLayerPoint(c),b)},_textboxCoordsToLatLng:function(c,b){return this._handled._map.layerPointToLatLng(this._textboxCoordsToLayerPoint(c,b))}});L.MoveHandle=L.EditHandle.extend({options:{TYPE:"move"},_onHandleDrag:function(c){this._handled.setLatLng(c.target.getLatLng())}});L.PointerHandle=L.EditHandle.extend({initialize:function(c,b){L.EditHandle.prototype.initialize.call(this,c,b);this._handled.editing&&(this._editing=this._handled.editing);this._id=b.id;this._type=b.type},_onHandleDrag:function(c){c=c.target;var b=this._editing;this._handleOffset=this._latLngToTextboxCoords(this.getLatLng());switch(c._type){case "vertex":b._updateVertex(c);break;case "midpoint":b._addVertex(c)}},_onHandleClick:function(c){c=c.target;var b=this._editing;this._handleOffset=this._latLngToTextboxCoords(c.getLatLng());switch(this._type){case "vertex":b._removeVertex(c);break;case "midpoint":b._addVertex(c)}},_bindListeners:function(){L.EditHandle.prototype._bindListeners.call(this);this.on("click",this._onHandleClick,this);this._handled.on({"edit:remove-vertex":this._onVertexRemove,"edit:add-vertex":this._onVertexAdd,"edit:update-vertex":this._onVertexUpdate},this)},_unbindListeners:function(){L.EditHandle.prototype._unbindListeners.call(this);this.off("click",this._onHandleClick,this);this._handled.off({"edit:remove-vertex":this._onVertexRemove,"edit:add-vertex":this._onVertexAdd,"edit:update-vertex":this._onVertexUpdate},this)},_onVertexAdd:function(c){c=c.addedId;this._id===c?(this._id+=1,this._type="vertex",this.setOpacity(1)):this._id>c&&(this._id+=2)},_onVertexRemove:function(c){this._id>c.removedId+1&&(this._id-=2)},_onVertexUpdate:function(c){var b=this._handled.editing,e=c.handle;c=e._id;var a=b._handleIdToCoordIndex(c,e._type),e=this._handled,d=e._map.latLngToLayerPoint(e.getLatLng());this._id===c-1&&0<a?(b=b._calculateMidpoint(a-1,a).add(d),b=e._map.layerPointToLatLng(b),this.setLatLng(b)):this._id===c+1&&a+1<e.getPoints().length&&(b=b._calculateMidpoint(a,a+1).add(d),b=e._map.layerPointToLatLng(b),this.setLatLng(b))}});L.ResizeHandle=L.EditHandle.extend({options:{TYPE:"resize"},initialize:function(c,b){L.EditHandle.prototype.initialize.call(this,c,b);this._corner=b.corner},_onHandleDrag:function(c){c=this._getOffset(c.target.getLatLng());this._handled.setSize(c.abs().multiplyBy(2).round())},_getOffset:function(c){c=this._latLngToTextboxCoords(c);var b=this._handled._minSize.divideBy(2);return new L.Point(Math.abs(c.x)<b.x?b.x:c.x,Math.abs(c.y)<b.y?b.y:c.y)},updateHandle:function(){var c=this._handled.getSize(),b=Math.round(c.y/2),c=Math.round(c.x/2);switch(this._corner){case "upper-left":this._handleOffset=new L.Point(-c,b);break;case "upper-right":this._handleOffset=new L.Point(c,b);break;case "lower-left":this._handleOffset=new L.Point(-c,-b);break;case "lower-right":this._handleOffset=new L.Point(c,-b)}L.EditHandle.prototype.updateHandle.call(this)}});L.RotateHandle=L.EditHandle.extend({options:{TYPE:"rotate"},initialize:function(c,b){L.EditHandle.prototype.initialize.call(this,c,b);this._createPointer()},onAdd:function(c){L.EditHandle.prototype.onAdd.call(this,c);this._map.addLayer(this._pointer)},onRemove:function(c){this._map.removeLayer(this._pointer);L.EditHandle.prototype.onRemove.call(this,c)},_onHandleDrag:function(c){c=c.target.getLatLng();var b=this._handled.getLatLng();c=this._map.latLngToLayerPoint(c).subtract(this._map.latLngToLayerPoint(b));this._handled.setRotation(0<c.y?Math.PI-Math.atan(c.x/c.y):-Math.atan(c.x/c.y))},updateHandle:function(){this._handleOffset=new L.Point(0,-this._handled.getSize().y);this._updatePointer();L.EditHandle.prototype.updateHandle.call(this)},_createPointer:function(){var c=this._handled.getTextarea(),b=L.DomUtil.getStyle(c,"border-width"),c={color:L.DomUtil.getStyle(c,"border-color"),weight:Math.round(b)};this._pointer=new L.Pointer(this._handled.getLatLng(),[],c);this._updatePointer();this._handled.on({update:this._updatePointer},this)},_updatePointer:function(){var c=this._handled._map,b=this._handled.getLatLng(),c=c.latLngToLayerPoint(b);this._pointerStart=this._handleOffset.multiplyBy(.5);this._pointer.setLatLng(b);this._pointer.setPoints([this._textboxCoordsToLayerPoint(this._pointerStart).subtract(c),this._textboxCoordsToLayerPoint(this._handleOffset).subtract(c)])}});L.Edit=L.Edit||{};L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var c=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(c,this.options.moveIcon)},_createResizeMarker:function(){var c=this._getCorners();this._resizeMarkers=[];for(var b=0,e=c.length;b<e;b++)this._resizeMarkers.push(this._createMarker(c[b],this.options.resizeIcon)),this._resizeMarkers[b]._cornerIndex=b},_onMarkerDragStart:function(c){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,c);var b=this._getCorners();c=c.target._cornerIndex;this._oppositeCorner=b[(c+2)%4];this._toggleCornerMarkers(0,c)},_onMarkerDragEnd:function(c){var b=c.target,e;b===this._moveMarker&&(e=this._shape.getBounds(),e=e.getCenter(),b.setLatLng(e));this._toggleCornerMarkers(1);this._repositionCornerMarkers();L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,c)},_move:function(c){for(var b=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),e=this._shape.getBounds().getCenter(),a,d=[],g=0,f=b.length;g<f;g++)a=[b[g].lat-e.lat,b[g].lng-e.lng],d.push([c.lat+a[0],c.lng+a[1]]);this._shape.setLatLngs(d);this._repositionCornerMarkers();this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(c){this._shape.setBounds(L.latLngBounds(c,this._oppositeCorner));c=this._shape.getBounds();this._moveMarker.setLatLng(c.getCenter());this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var c=this._shape.getBounds(),b=c.getNorthWest(),e=c.getNorthEast(),a=c.getSouthEast(),c=c.getSouthWest();return[b,e,a,c]},_toggleCornerMarkers:function(c){for(var b=0,e=this._resizeMarkers.length;b<e;b++)this._resizeMarkers[b].setOpacity(c)},_repositionCornerMarkers:function(){for(var c=this._getCorners(),b=0,e=this._resizeMarkers.length;b<e;b++)this._resizeMarkers[b].setLatLng(c[b])}});L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var c=this._shape.getLatLng();this._moveMarker=this._createMarker(c,this.options.moveIcon)},_createResizeMarker:function(){var c=this._shape.getLatLng(),c=this._getResizeMarkerPoint(c);this._resizeMarkers=[];this._resizeMarkers.push(this._createMarker(c,this.options.resizeIcon))},_getResizeMarkerPoint:function(c){var b=this._shape._radius*Math.cos(Math.PI/4);c=this._map.project(c);return this._map.unproject([c.x+b,c.y-b])},_move:function(c){var b=this._getResizeMarkerPoint(c);this._resizeMarkers[0].setLatLng(b);this._shape.setLatLng(c);this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(c){c=this._moveMarker.getLatLng().distanceTo(c);this._shape.setRadius(c);this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}});L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable());this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()});this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})});L.Map.mergeOptions({touchExtend:!0});L.Map.TouchExtend=L.Handler.extend({initialize:function(c){this._map=c;this._container=c._container;this._pane=c._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this);L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this);L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this);this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart);L.DomEvent.off(this._container,"touchend",this._onTouchEnd);L.DomEvent.off(this._container,"touchmove",this._onTouchMove);this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDowm",this._onTouchStart),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave))},_touchEvent:function(c,b){var e;if("undefined"!==typeof c.touches){if(!c.touches.length)return;e=c.touches[0]}else if("touch"===c.pointerType){if(e=c,!this._filterClick(c))return}else return;var a=this._map.mouseEventToContainerPoint(e),d=this._map.mouseEventToLayerPoint(e),g=this._map.layerPointToLatLng(d);this._map.fire(b,{latlng:g,layerPoint:d,containerPoint:a,pageX:e.pageX,pageY:e.pageY,originalEvent:c})},_filterClick:function(c){var b=c.timeStamp||c.originalEvent.timeStamp,e=L.DomEvent._lastClick&&b-L.DomEvent._lastClick;if(e&&100<e&&500>e||c.target._simulatedClick&&!c._simulated)return L.DomEvent.stop(c),!1;L.DomEvent._lastClick=b;return!0},_onTouchStart:function(c){this._map._loaded&&this._touchEvent(c,"touchstart")},_onTouchEnd:function(c){this._map._loaded&&this._touchEvent(c,"touchend")},_onTouchCancel:function(c){if(this._map._loaded){var b="touchcancel";this._detectIE()&&(b="pointercancel");this._touchEvent(c,b)}},_onTouchLeave:function(c){this._map._loaded&&this._touchEvent(c,"touchleave")},_onTouchMove:function(c){this._map._loaded&&this._touchEvent(c,"touchmove")},_detectIE:function(){var c=e.navigator.userAgent,b=c.indexOf("MSIE ");if(0<b)return parseInt(c.substring(b+5,c.indexOf(".",b)),10);if(0<c.indexOf("Trident/"))return b=c.indexOf("rv:"),parseInt(c.substring(b+3,c.indexOf(".",b)),10);b=c.indexOf("Edge/");return 0<b?parseInt(c.substring(b+5,c.indexOf(".",b)),10):!1}});L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend);L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var c=this._icon,b="dblclick mousedown mouseover mouseout contextmenu touchstart touchend touchmove".split(" ");this._detectIE?b.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):b.concat(["touchcancel"]);L.DomUtil.addClass(c,"leaflet-clickable");L.DomEvent.on(c,"click",this._onMouseClick,this);L.DomEvent.on(c,"keypress",this._onKeyPress,this);for(var e=0;e<b.length;e++)L.DomEvent.on(c,b[e],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var c=e.navigator.userAgent,b=c.indexOf("MSIE ");if(0<b)return parseInt(c.substring(b+5,c.indexOf(".",b)),10);if(0<c.indexOf("Trident/"))return b=c.indexOf("rv:"),parseInt(c.substring(b+3,c.indexOf(".",b)),10);b=c.indexOf("Edge/");return 0<b?parseInt(c.substring(b+5,c.indexOf(".",b)),10):!1}});L.LatLngUtil={cloneLatLngs:function(c){for(var b=[],e=0,a=c.length;e<a;e++)Array.isArray(c[e])?b.push(L.LatLngUtil.cloneLatLngs(c[e])):b.push(this.cloneLatLng(c[e]));return b},cloneLatLng:function(c){return L.latLng(c.lat,c.lng)}};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(c){var b=c.length,e=0,a=Math.PI/180,d,g;if(2<b){for(var f=0;f<b;f++)d=c[f],g=c[(f+1)%b],e+=(g.lng-d.lng)*a*(2+Math.sin(d.lat*a)+Math.sin(g.lat*a));e=40680631590769*e/2}return Math.abs(e)},readableArea:function(c,b){var e;b?e=1E4<=c?(1E-4*c).toFixed(2)+" ha":c.toFixed(2)+" m\x26sup2;":(c/=.836127,e=3097600<=c?(c/3097600).toFixed(2)+" mi\x26sup2;":4840<=c?(c/4840).toFixed(2)+" acres":Math.ceil(c)+" yd\x26sup2;");return e},readableDistance:function(c,b,e,a){switch("string"==typeof b?b:e?"feet":a?"nauticalMile":b?"metric":"yards"){case "metric":c=1E3<c?(c/1E3).toFixed(2)+" km":Math.ceil(c)+" m";break;case "feet":c=Math.ceil(3.28083*c)+" ft";break;case "nauticalMile":c=(.53996*c/1E3).toFixed(2)+" nm";break;default:c*=1.09361,c=1760<c?(c/1760).toFixed(2)+" miles":Math.ceil(c)+" yd"}return c}});L.Util.extend(L.LineUtil,{segmentsIntersect:function(c,b,e,a){return this._checkCounterclockwise(c,e,a)!==this._checkCounterclockwise(b,e,a)&&this._checkCounterclockwise(c,b,e)!==this._checkCounterclockwise(c,b,a)},_checkCounterclockwise:function(c,b,e){return(e.y-c.y)*(b.x-c.x)>(b.y-c.y)*(e.x-c.x)}});L.Polyline.include({intersects:function(){var c=this._getProjectedPoints(),b=c?c.length:0,e,a;if(this._tooFewPointsForIntersection())return!1;for(--b;3<=b;b--)if(e=c[b-1],a=c[b],this._lineSegmentsIntersectsRange(e,a,b-2))return!0;return!1},newLatLngIntersects:function(c,b){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(c),b):!1},newPointIntersects:function(c,b){var e=this._getProjectedPoints(),a=e?e.length:0,e=e?e[a-1]:null,a=a-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(e,c,a,b?1:0)},_tooFewPointsForIntersection:function(c){var b=this._getProjectedPoints(),e=b?b.length:0;return!b||3>=e+(c||0)},_lineSegmentsIntersectsRange:function(c,b,e,a){var d=this._getProjectedPoints(),g;a=a||0;for(var f=e;f>a;f--)if(e=d[f-1],g=d[f],L.LineUtil.segmentsIntersect(c,b,e,g))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var c=[],b=this._defaultShape(),e=0;e<b.length;e++)c.push(this._map.latLngToLayerPoint(b[e]));return c}});L.Polygon.include({intersects:function(){var c=this._getProjectedPoints(),b;if(this._tooFewPointsForIntersection())return!1;if(L.Polyline.prototype.intersects.call(this))return!0;b=c.length;return this._lineSegmentsIntersectsRange(c[b-1],c[0],b-2,1)}});L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(c){if("0.7">L.version)throw Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,c);this._toolbars={};L.DrawToolbar&&this.options.draw&&(c=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=c,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.EditToolbar&&this.options.edit&&(c=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=c,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.toolbar=this},onAdd:function(c){var b=L.DomUtil.create("div","leaflet-draw"),e=!1,a,d;for(d in this._toolbars)this._toolbars.hasOwnProperty(d)&&(a=this._toolbars[d].addToolbar(c))&&(e||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),e=!0),b.appendChild(a));return b},onRemove:function(){for(var c in this._toolbars)this._toolbars.hasOwnProperty(c)&&this._toolbars[c].removeToolbar()},setDrawingOptions:function(c){for(var b in this._toolbars)this._toolbars[b]instanceof L.DrawToolbar&&this._toolbars[b].setOptions(c)},_toolbarEnabled:function(c){c=c.target;for(var b in this._toolbars)this._toolbars[b]!==c&&this._toolbars[b].disable()}});L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1});L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))});L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(c){L.setOptions(this,c);this._modes={};this._actionButtons=[];this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(c){var b=L.DomUtil.create("div","leaflet-draw-section"),e=0,a=this._toolbarClass||"",d=this.getModeHandlers(c);this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar");this._map=c;for(c=0;c<d.length;c++)d[c].enabled&&this._initModeHandler(d[c].handler,this._toolbarContainer,e++,a,d[c].title);if(e)return this._lastButtonIndex=--e,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),b.appendChild(this._toolbarContainer),b.appendChild(this._actionsContainer),b},removeToolbar:function(){for(var c in this._modes)this._modes.hasOwnProperty(c)&&(this._disposeButton(this._modes[c].button,this._modes[c].handler.enable,this._modes[c].handler),this._modes[c].handler.disable(),this._modes[c].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};c=0;for(var b=this._actionButtons.length;c<b;c++)this._disposeButton(this._actionButtons[c].button,this._actionButtons[c].callback,this);this._actionButtons=[];this._actionsContainer=null},_initModeHandler:function(c,b,e,a,d){var g=c.type;this._modes[g]={};this._modes[g].handler=c;this._modes[g].button=this._createButton({type:g,title:d,className:a+"-"+g,container:b,callback:this._modes[g].handler.enable,context:this._modes[g].handler});this._modes[g].buttonIndex=e;this._modes[g].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(c){var b=L.DomUtil.create("a",c.className||"",c.container),e=L.DomUtil.create("span","sr-only",c.container);b.href="#";b.appendChild(e);c.title&&(b.title=c.title,e.innerHTML=c.title);c.text&&(b.innerHTML=c.text,e.innerHTML=c.text);L.DomEvent.on(b,"click",L.DomEvent.stopPropagation).on(b,"mousedown",L.DomEvent.stopPropagation).on(b,"dblclick",L.DomEvent.stopPropagation).on(b,"touchstart",L.DomEvent.stopPropagation).on(b,"click",L.DomEvent.preventDefault).on(b,"click",c.callback,c.context);return b},_disposeButton:function(c,b){L.DomEvent.off(c,"click",L.DomEvent.stopPropagation).off(c,"mousedown",L.DomEvent.stopPropagation).off(c,"dblclick",L.DomEvent.stopPropagation).off(c,"touchstart",L.DomEvent.stopPropagation).off(c,"click",L.DomEvent.preventDefault).off(c,"click",b)},_handlerActivated:function(c){this.disable();this._activeMode=this._modes[c.handler];L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._showActionsToolbar();this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar();L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._activeMode=null;this.fire("disable")},_createActions:function(c){var b=this._actionsContainer;c=this.getActions(c);var e=c.length,a,d;d=0;for(a=this._actionButtons.length;d<a;d++)this._disposeButton(this._actionButtons[d].button,this._actionButtons[d].callback);for(this._actionButtons=[];b.firstChild;)b.removeChild(b.firstChild);for(d=0;d<e;d++)"enabled"in c[d]&&!c[d].enabled||(a=L.DomUtil.create("li","",b),a=this._createButton({title:c[d].title,text:c[d].text,container:a,callback:c[d].callback,context:c[d].context}),this._actionButtons.push({button:a,callback:c[d].callback}))},_showActionsToolbar:function(){var c=this._activeMode.buttonIndex,b=this._lastButtonIndex,e=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler);this._actionsContainer.style.top=e+"px";0===c&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top"));c===b&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom"));this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none";L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop");L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}});L.Draw=L.Draw||{};L.Draw.Tooltip=L.Class.extend({initialize:function(c){this._map=c;this._popupPane=c._panes.popupPane;this._container=c.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null;this._singleLineLabel=!1;this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this);this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(c){if(!this._container)return this;c.subtext=c.subtext||"";0!==c.subtext.length||this._singleLineLabel?0<c.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0);this._container.innerHTML=(0<c.subtext.length?'\x3cspan class\x3d"leaflet-draw-tooltip-subtext"\x3e'+c.subtext+"\x3c/span\x3e\x3cbr /\x3e":"")+"\x3cspan\x3e"+c.text+"\x3c/span\x3e";return this},updatePosition:function(c){c=this._map.latLngToLayerPoint(c);var b=this._container;this._container&&(b.style.visibility="inherit",L.DomUtil.setPosition(b,c));return this},showAsError:function(){this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip");return this},removeError:function(){this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip");return this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}});L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{textbox:{},polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(c){for(var b in this.options)this.options.hasOwnProperty(b)&&c[b]&&(c[b]=L.extend({},this.options[b],c[b]));this._toolbarClass="leaflet-draw-draw";L.Toolbar.prototype.initialize.call(this,c)},getModeHandlers:function(c){return[{enabled:this.options.textbox,handler:new L.Draw.Textbox(c,this.options.textbox),title:"Add a textbox"},{enabled:this.options.polyline,handler:new L.Draw.Polyline(c,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(c,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(c,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(c,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(c,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(c){return[{enabled:c.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:c.completeShape,context:c},{enabled:c.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:c.deleteLastVertex,context:c},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(c){L.setOptions(this,c);for(var b in this._modes)this._modes.hasOwnProperty(b)&&c.hasOwnProperty(b)&&this._modes[b].handler.setOptions(c[b])}});L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(c){c.edit&&("undefined"===typeof c.edit.selectedPathOptions&&(c.edit.selectedPathOptions=this.options.edit.selectedPathOptions),c.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,c.edit.selectedPathOptions));c.remove&&(c.remove=L.extend({},this.options.remove,c.remove));c.poly&&(c.poly=L.extend({},this.options.poly,c.poly));this._toolbarClass="leaflet-draw-edit";L.Toolbar.prototype.initialize.call(this,c);this._selectedFeatureCount=0},getModeHandlers:function(c){var b=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(c,{featureGroup:b,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(c,{featureGroup:b}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(c){c=L.Toolbar.prototype.addToolbar.call(this,c);this._checkDisabled();this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this);return c},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this);L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save();this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var c=0!==this.options.featureGroup.getLayers().length,b;this.options.edit&&(b=this._modes[L.EditToolbar.Edit.TYPE].button,c?L.DomUtil.removeClass(b,"leaflet-disabled"):L.DomUtil.addClass(b,"leaflet-disabled"),b.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled));this.options.remove&&(b=this._modes[L.EditToolbar.Delete.TYPE].button,c?L.DomUtil.removeClass(b,"leaflet-disabled"):L.DomUtil.addClass(b,"leaflet-disabled"),b.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}});L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(c,b){L.Handler.prototype.initialize.call(this,c);L.setOptions(this,b);this._featureGroup=b.featureGroup;if(!(this._featureGroup instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={};this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(c.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),c._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(c){this._revertLayer(c)},this)},save:function(){var c=new L.LayerGroup;this._featureGroup.eachLayer(function(b){b.edited&&(c.addLayer(b),b.edited=!1)});this._map.fire(L.Draw.Event.EDITED,{layers:c})},_backupLayer:function(c){var b=L.Util.stamp(c);this._uneditedLayerProps[b]||(c instanceof L.Polyline||c instanceof L.Polygon||c instanceof L.Rectangle?this._uneditedLayerProps[b]={latlngs:L.LatLngUtil.cloneLatLngs(c.getLatLngs())}:c instanceof L.Circle?this._uneditedLayerProps[b]={latlng:L.LatLngUtil.cloneLatLng(c.getLatLng()),radius:c.getRadius()}:c instanceof L.Marker&&(this._uneditedLayerProps[b]={latlng:L.LatLngUtil.cloneLatLng(c.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(c){var b=L.Util.stamp(c);c.edited=!1;this._uneditedLayerProps.hasOwnProperty(b)&&(c instanceof L.Polyline||c instanceof L.Polygon||c instanceof L.Rectangle?c.setLatLngs(this._uneditedLayerProps[b].latlngs):c instanceof L.Circle?(c.setLatLng(this._uneditedLayerProps[b].latlng),c.setRadius(this._uneditedLayerProps[b].radius)):c instanceof L.Marker&&c.setLatLng(this._uneditedLayerProps[b].latlng),c.fire("revert-edited",{layer:c}))},_enableLayerEdit:function(c){c=c.layer||c.target||c;var b;this._backupLayer(c);this.options.poly&&(b=L.Util.extend({},this.options.poly),c.options.poly=b);this.options.selectedPathOptions&&(b=L.Util.extend({},this.options.selectedPathOptions),b.maintainColor&&(b.color=c.options.color,b.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=b);c instanceof L.Marker?(c.editing&&c.editing.enable(),c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(c){c=c.layer||c.target||c;c.edited=!1;c.editing&&c.editing.disable();delete c.options.editing;delete c.options.original;this._selectedPathOptions&&(c instanceof L.Marker?this._toggleMarkerHighlight(c):(c.setStyle(c.options.previousOptions),delete c.options.previousOptions));c instanceof L.Marker?(c.dragging.disable(),c.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.disable()},_onMouseMove:function(c){this._tooltip.updatePosition(c.latlng)},_onMarkerDragEnd:function(c){c=c.target;c.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:c})},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.changedTouches[0]),b=this._map.layerPointToLatLng(b);c.target.setLatLng(b)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}});L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(c,b){L.Handler.prototype.initialize.call(this,c);L.Util.setOptions(this,b);this._deletableLayers=this.options.featureGroup;if(!(this._deletableLayers instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(c.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(c){this._deletableLayers.addLayer(c);c.fire("revert-deleted",{layer:c})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},_enableLayerDelete:function(c){(c.layer||c.target||c).on("click",this._removeLayer,this)},_disableLayerDelete:function(c){c=c.layer||c.target||c;c.off("click",this._removeLayer,this);this._deletedLayers.removeLayer(c)},_removeLayer:function(c){c=c.layer||c.target||c;this._deletableLayers.removeLayer(c);this._deletedLayers.addLayer(c);c.fire("deleted")},_onMouseMove:function(c){this._tooltip.updatePosition(c.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})})(window,document);L.drawLocal={draw:{toolbar:{actions:{title:"\u53d6\u6d88\u7ed8\u5236",text:"\u53d6\u6d88"},finish:{title:"\u5b8c\u6210\u7ed8\u5236",text:"\u5b8c\u6210"},undo:{title:"\u5220\u9664\u6700\u540e\u4e00\u4e2a\u5df2\u7ed8\u5236\u7684\u70b9",text:"\u5220\u9664\u6700\u540e\u7ed8\u5236\u70b9"},buttons:{polyline:"\u7ed8\u5236\u591a\u6bb5\u7ebf",polygon:"\u7ed8\u5236\u591a\u8fb9\u5f62",rectangle:"\u7ed8\u5236\u957f\u65b9\u5f62",circle:"\u7ed8\u5236\u5706",marker:"\u7ed8\u5236\u6807\u8bb0"}},handlers:{circle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706"},radius:"\u534a\u5f84"},marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u653e\u7f6e"}},polygon:{tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u9762",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u9762"}},polyline:{error:"\x3cstrong\x3e\u9519\u8bef:\x3c/strong\x3e \u4e0d\u53ef\u81ea\u4ea4\u53c9!",tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u7ebf"}},rectangle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706\u77e9\u5f62"}},simpleshape:{tooltip:{end:"\u653e\u5f00\u9f20\u6807\u5b8c\u6210\u7ed8\u5236"}}}},edit:{toolbar:{actions:{save:{title:"\u4fdd\u5b58\u4fee\u6539",text:"\u4fdd\u5b58"},cancel:{title:"\u53d6\u6d88\u7f16\u8f91\uff0c\u653e\u5f03\u4fee\u6539",text:"\u53d6\u6d88"}},buttons:{edit:"\u7f16\u8f91\u56fe\u5c42",editDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u7f16\u8f91",remove:"\u5220\u9664\u56fe\u5c42",removeDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u5220\u9664"}},handlers:{edit:{tooltip:{text:"\u62d6\u52a8\u63a7\u5236\u70b9\u6216\u6807\u8bb0\u4ee5\u4fee\u6539\u8981\u7d20",subtext:"\u70b9\u51fb\u53d6\u6d88\u653e\u5f03\u4fee\u6539"}},remove:{tooltip:{text:"\u70b9\u51fb\u4e00\u4e2a\u8981\u7d20\u4ee5\u5220\u9664"}}}}};L.Control.GroupedLayers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,exclusiveGroups:[],groupCheckboxes:!1},initialize:function(e,k,l){var c,b;L.Util.setOptions(this,l);this._layers=[];this._lastZIndex=0;this._handlingClick=!1;this._groupList=[];this._domGroups=[];for(c in e)this._addLayer(e[c],c);for(c in k)for(b in k[c])this._addLayer(k[c][b],b,c,!0)},onAdd:function(e){this._initLayout();this._update();e.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this);return this._container},onRemove:function(e){e.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(e,k){this._addLayer(e,k);this._update();return this},addOverlay:function(e,k,l){this._addLayer(e,k,l,!0);this._update();return this},removeLayer:function(e){e=L.Util.stamp(e);(e=this._getLayer(e))&&delete this.layers[this.layers.indexOf(e)];this._update();return this},_getLayer:function(e){for(var k=0;k<this._layers.length;k++)if(this._layers[k]&&L.stamp(this._layers[k].layer)===e)return this._layers[k]},_initLayout:function(){var e=this._container=L.DomUtil.create("div","leaflet-control-layers");e.setAttribute("aria-haspopup",!0);if(L.Browser.touch)L.DomEvent.on(e,"click",L.DomEvent.stopPropagation);else L.DomEvent.disableClickPropagation(e),L.DomEvent.on(e,"wheel",L.DomEvent.stopPropagation);var k=this._form=L.DomUtil.create("form","leaflet-control-layers-list");if(this.options.collapsed){if(!L.Browser.android)L.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var l=this._layersLink=L.DomUtil.create("a","leaflet-control-layers-toggle",e);l.href="#";l.title="Layers";if(L.Browser.touch)L.DomEvent.on(l,"click",L.DomEvent.stop).on(l,"click",this._expand,this);else L.DomEvent.on(l,"focus",this._expand,this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div","leaflet-control-layers-base",k);this._separator=L.DomUtil.create("div","leaflet-control-layers-separator",k);this._overlaysList=L.DomUtil.create("div","leaflet-control-layers-overlays",k);e.appendChild(k)},_addLayer:function(e,k,l,c){L.Util.stamp(e);k={layer:e,name:k,overlay:c};this._layers.push(k);l=l||"";c=this._indexOf(this._groupList,l);-1===c&&(c=this._groupList.push(l)-1);var b=-1!==this._indexOf(this.options.exclusiveGroups,l);k.group={name:l,id:c,exclusive:b};this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="";this._overlaysList.innerHTML="";this._domGroups.length=0;var e=!1,k=!1,l,c;for(l=0;l<this._layers.length;l++)c=this._layers[l],this._addItem(c),k=k||c.overlay,e=e||!c.overlay;this._separator.style.display=k&&e?"":"none"}},_onLayerChange:function(e){var k=this._getLayer(L.Util.stamp(e.layer));k&&(this._handlingClick||this._update(),(e=k.overlay?"layeradd"===e.type?"overlayadd":"overlayremove":"layeradd"===e.type?"baselayerchange":null)&&this._map.fire(e,k))},_createRadioElement:function(e,k){var l='\x3cinput type\x3d"radio" class\x3d"leaflet-control-layers-selector" name\x3d"'+e+'"';k&&(l+=' checked\x3d"checked"');var l=l+"/\x3e",c=document.createElement("div");c.innerHTML=l;return c.firstChild},_addItem:function(e){var k=document.createElement("label"),l,c=this._map.hasLayer(e.layer);e.overlay?e.group.exclusive?(l="leaflet-exclusive-group-layer-"+e.group.id,l=this._createRadioElement(l,c)):(l=document.createElement("input"),l.type="checkbox",l.className="leaflet-control-layers-selector",l.defaultChecked=c):l=this._createRadioElement("leaflet-base-layers",c);l.layerId=L.Util.stamp(e.layer);l.groupID=e.group.id;L.DomEvent.on(l,"click",this._onInputClick,this);c=document.createElement("span");c.innerHTML=" "+e.name;k.appendChild(l);k.appendChild(c);if(e.overlay){l=this._overlaysList;c=this._domGroups[e.group.id];if(!c){c=document.createElement("div");c.className="leaflet-control-layers-group";c.id="leaflet-control-layers-group-"+e.group.id;var b=document.createElement("label");b.className="leaflet-control-layers-group-label";if(""!==e.group.name&&!e.group.exclusive&&this.options.groupCheckboxes){var h=document.createElement("input");h.type="checkbox";h.className="leaflet-control-layers-group-selector";h.groupID=e.group.id;h.legend=this;L.DomEvent.on(h,"click",this._onGroupInputClick,h);b.appendChild(h)}h=document.createElement("span");h.className="leaflet-control-layers-group-name";h.innerHTML=e.group.name;b.appendChild(h);c.appendChild(b);l.appendChild(c);this._domGroups[e.group.id]=c}l=c}else l=this._baseLayersList;l.appendChild(k);return k},_onGroupInputClick:function(){var e,k,l,c=this.legend;c._handlingClick=!0;var b=c._form.getElementsByTagName("input"),h=b.length;for(e=0;e<h;e++)k=b[e],k.groupID===this.groupID&&"leaflet-control-layers-selector"===k.className&&(k.checked=this.checked,l=c._getLayer(k.layerId),k.checked&&!c._map.hasLayer(l.layer)?c._map.addLayer(l.layer):!k.checked&&c._map.hasLayer(l.layer)&&c._map.removeLayer(l.layer));c._handlingClick=!1},_onInputClick:function(){var e,k,l,c=this._form.getElementsByTagName("input"),b=c.length;this._handlingClick=!0;for(e=0;e<b;e++)k=c[e],"leaflet-control-layers-selector"===k.className&&(l=this._getLayer(k.layerId),k.checked&&!this._map.hasLayer(l.layer)?this._map.addLayer(l.layer):!k.checked&&this._map.hasLayer(l.layer)&&this._map.removeLayer(l.layer));this._handlingClick=!1},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded");var e=this._map._size.y-4*this._container.offsetTop;e<this._form.clientHeight&&(L.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=e+"px")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")},_indexOf:function(e,k){for(var l=0,c=e.length;l<c;l++)if(e[l]===k)return l;return-1}});L.control.groupedLayers=function(e,k,l){return new L.Control.GroupedLayers(e,k,l)};(function(e,k,l){L.Control.Custom=L.Control.extend({version:"1.0.1",options:{position:"topright",id:"",title:"",classes:"",content:"",style:{},datas:{},events:{}},container:null,onAdd:function(c){this.container=L.DomUtil.create("div");this.container.id=this.options.id;this.container.title=this.options.title;this.container.className=this.options.classes;this.container.innerHTML=this.options.content;for(var b in this.options.style)this.container.style[b]=this.options.style[b];for(var e in this.options.datas)this.container.dataset[e]=this.options.datas[e];L.DomEvent.disableClickPropagation(this.container);L.DomEvent.on(this.container,"contextmenu",function(a){L.DomEvent.stopPropagation(a)});L.DomEvent.disableScrollPropagation(this.container);for(var a in this.options.events)L.DomEvent.on(this.container,a,this.options.events[a],this.container);return this.container},onRemove:function(c){for(var b in this.options.events)L.DomEvent.off(this.container,b,this.options.events[b],this.container)}});L.control.custom=function(c){return new L.Control.Custom(c)}})(window,document);L.GeoWMTSLayer=L.TileLayer.extend({defaultWmtsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layer:"",style:"default",tileMatrixSet:"c",format:"tiles"},layerType:"WMTSLayer",initialize:function(e,k){this._url=e instanceof Array?e:[e];var l=L.extend({},this.defaultWmtsParams),c=k.tileSize||this.options.tileSize;l.width=k.detectRetina&&L.Browser.retina?l.height=2*c:l.height=c;for(var b in k)this.options.hasOwnProperty(b)||"matrixIds"==b||(l[b]=k[b]);this.wmtsParams=l;L.setOptions(this,k)},onAdd:function(e){L.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e){var k=this._url[(e.x+e.y)%this._url.length];k||(k=this._url[0]);return k+L.Util.getParamString(this.wmtsParams,k)+"\x26tilematrix\x3d"+e.z+"\x26tilerow\x3d"+e.y+"\x26tilecol\x3d"+e.x},setParams:function(e,k){L.extend(this.wmtsParams,e);k||this.redraw();return this}});L.geowmtslayer=function(e,k){return new L.GeoWMTSLayer(e,k)};L.GeoTDTLayer=L.GeoWMTSLayer.extend({urlArray:[],tdtOptions:{},initialize:function(e,k){this._url=this.urlArray;k=this.tdtOptions;var l=L.extend({},this.defaultWmtsParams),c=k.tileSize||this.options.tileSize;l.width=k.detectRetina&&L.Browser.retina?l.height=2*c:l.height=c;for(var b in k)this.options.hasOwnProperty(b)||"matrixIds"==b||(l[b]=k[b]);this.wmtsParams=l;L.setOptions(this,k)}});L.GeoTDTLayer.Vector=L.GeoTDTLayer.extend({urlArray:["http://t0.tianditu.com/vec_c/wmts","http://t1.tianditu.com/vec_c/wmts","http://t2.tianditu.com/vec_c/wmts","http://t3.tianditu.com/vec_c/wmts"],tdtOptions:{layer:"vec",style:"default",format:"tiles",tilematrixSet:"c",attribution:"\u5929\u5730\u56fe"}});L.GeoTDTLayer.VectorAnno=L.GeoTDTLayer.extend({urlArray:["http://t0.tianditu.com/cva_c/wmts","http://t1.tianditu.com/cva_c/wmts","http://t2.tianditu.com/cva_c/wmts","http://t3.tianditu.com/cva_c/wmts"],tdtOptions:{layer:"cva",style:"default",format:"tiles",tilematrixSet:"c",attribution:"\u5929\u5730\u56fe"}});L.GeoTDTLayer.Raster=L.GeoTDTLayer.extend({urlArray:["http://t0.tianditu.com/img_c/wmts","http://t1.tianditu.com/img_c/wmts","http://t2.tianditu.com/img_c/wmts","http://t3.tianditu.com/img_c/wmts"],tdtOptions:{layer:"img",style:"default",format:"tiles",tilematrixSet:"c",attribution:"\u5929\u5730\u56fe"}});L.GeoTDTLayer.RasterAnno=L.GeoTDTLayer.extend({urlArray:["http://t0.tianditu.com/cia_c/wmts","http://t1.tianditu.com/cia_c/wmts","http://t2.tianditu.com/cia_c/wmts","http://t3.tianditu.com/cia_c/wmts"],tdtOptions:{layer:"cia",style:"default",format:"tiles",tilematrixSet:"c",attribution:"\u5929\u5730\u56fe"}});L.GeoTDTCRS=L.extend({},L.CRS,{projection:L.Projection.SphericalMercator,transformation:function(){var e=.5/(Math.PI*L.Projection.SphericalMercator.R);return new L.Transformation(e,.5,-e,.5)}(),code:"EPSG:0",levelDefine:[{level:0,resolution:1.40782880508533,scale:5.916587109E8},{level:1,resolution:.7031250000001188,scale:2.954975930588E8},{level:2,resolution:.3515625000000594,scale:1.477487965294E8},{level:3,resolution:.1757812500000297,scale:7.38743982647E7},{level:4,resolution:.08789062500001485,scale:3.693719913235E7},{level:5,resolution:.043945312500007425,scale:1.8468599566175E7},{level:6,resolution:.021972656250003712,scale:9234299.7830875},{level:7,resolution:.010986328125001856,scale:4617149.89154375},{level:8,resolution:.005493164062500928,scale:2308574.945771875},{level:9,resolution:.002746582031250464,scale:1154287.4728859374},{level:10,resolution:.001373291015625232,scale:577143.7364429687},{level:11,resolution:6.86645507812616E-4,scale:288571.86822148436},{level:12,resolution:3.43322753906308E-4,scale:144285.93411074218},{level:13,resolution:1.71661376953154E-4,scale:72142.96705537109},{level:14,resolution:8.5830688476577E-5,scale:36071.483527685545},{level:15,resolution:4.29153442382885E-5,scale:18035.741763842772},{level:16,resolution:2.145767211914425E-5,scale:9017.870881921386},{level:17,resolution:1.0728836059572125E-5,scale:4508.935440960693},{level:18,resolution:5.3644180297860626E-6,scale:2254.4677204803465},{level:19,resolution:2.6822090148930313E-6,scale:1127.2338602401733},{level:20,resolution:1.3411045074465156E-6,scale:563.6169301200866}],origin:new L.LatLng(90,-180),latLngToPoint:function(e,k){for(var l=this.levelDefine,c=this.origin,b=0;b<l.length;b++)if(l[b].level==k)return new L.Point(Math.floor((e.lng-c.lng)/l[b].resolution),Math.floor((c.lat-e.lat)/l[b].resolution))},pointToLatLng:function(e,k){for(var l=this.levelDefine,c=this.origin,b=0;b<l.length;b++)if(l[b].level==k)return new L.LatLng(c.lat-e.y*l[b].resolution,e.x*l[b].resolution+c.lng)},project:function(e){return new L.Point(e.lng,e.lat)},scale:function(e){for(var k=this.levelDefine,l=this.origin,c,l=Math.max(Math.abs(l.lat),Math.abs(l.lng)),b=0;b<k.length;b++)if(k[b].level==e){c=2*l/k[b].resolution;break}return c},_scaleByOrigin:function(e,k){for(var l,c=this.levelDefine,b=0;b<c.length;b++)c[b].level==e&&(l=2*Math.abs(k)/c[b].resolution);return l},getSize:function(e){var k=this.origin,l=this._scaleByOrigin(e,k.lat);e=this._scaleByOrigin(e,k.lng);return L.point(e,l)}});!function(){function e(k){return this instanceof e?(this._canvas=k="string"==typeof k?document.getElementById(k):k,this._ctx=k.getContext("2d"),this._width=k.width,this._height=k.height,this._max=1,void this.clear()):new e(k)}e.prototype={defaultRadius:25,defaultGradient:{"0.4":"blue","0.6":"cyan","0.7":"lime","0.8":"yellow",1:"red"},data:function(e,l){return this._data=e,this},max:function(e){return this._max=e,this},add:function(e){return this._data.push(e),this},clear:function(){return this._data=[],this},radius:function(e,l){l=l||15;var c=this._circle=document.createElement("canvas"),b=c.getContext("2d"),h=this._r=e+l;return c.width=c.height=2*h,b.shadowOffsetX=b.shadowOffsetY=200,b.shadowBlur=l,b.shadowColor="black",b.beginPath(),b.arc(h-200,h-200,e,0,2*Math.PI,!0),b.closePath(),b.fill(),this},gradient:function(e){var k=document.createElement("canvas"),c=k.getContext("2d"),b=c.createLinearGradient(0,0,0,256);k.width=1;k.height=256;for(var h in e)b.addColorStop(h,e[h]);return c.fillStyle=b,c.fillRect(0,0,1,256),this._grad=c.getImageData(0,0,1,256).data,this},draw:function(e){this._circle||this.radius(this.defaultRadius);this._grad||this.gradient(this.defaultGradient);var k=this._ctx;k.clearRect(0,0,this._width,this._height);for(var c,b=0,h=this._data.length;h>b;b++)c=this._data[b],k.globalAlpha=Math.max(c[2]/this._max,e||.05),k.drawImage(this._circle,c[0]-this._r,c[1]-this._r);e=k.getImageData(0,0,this._width,this._height);return this._colorize(e.data,this._grad),k.putImageData(e,0,0),this},_colorize:function(e,l){for(var c,b=3,h=e.length;h>b;b+=4)(c=4*e[b])&&(e[b-3]=l[c],e[b-2]=l[c+1],e[b-1]=l[c+2])}};window.simpleheat=e}();L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(e,k){this._latlngs=e;L.setOptions(this,k)},setLatLngs:function(e){return this._latlngs=e,this.redraw()},addLatLng:function(e){return this._latlngs.push(e),this.redraw()},setOptions:function(e){return L.setOptions(this,e),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return!this._heat||this._frame||this._map._animating||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(e){this._map=e;this._canvas||this._initCanvas();e._panes.overlayPane.appendChild(this._canvas);e.on("moveend",this._reset,this);e.options.zoomAnimation&&L.Browser.any3d&&e.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(e){e.getPanes().overlayPane.removeChild(this._canvas);e.off("moveend",this._reset,this);e.options.zoomAnimation&&e.off("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},_initCanvas:function(){var e=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),k=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);e.style[k]="50% 50%";k=this._map.getSize();e.width=k.x;e.height=k.y;L.DomUtil.addClass(e,"leaflet-zoom-"+(this._map.options.zoomAnimation&&L.Browser.any3d?"animated":"hide"));this._heat=simpleheat(e);this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur);this.options.gradient&&this._heat.gradient(this.options.gradient);this.options.max&&this._heat.max(this.options.max)},_reset:function(){var e=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,e);e=this._map.getSize();this._heat._width!==e.x&&(this._canvas.width=this._heat._width=e.x);this._heat._height!==e.y&&(this._canvas.height=this._heat._height=e.y);this._redraw()},_redraw:function(){var e,k,l,c,b,h,a,d,g=[],f=this._heat._r,m=this._map.getSize();a=new L.Bounds(L.point([-f,-f]),m.add([f,f]));m=void 0===this.options.max?1:this.options.max;e=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom;var x=1/Math.pow(2,Math.max(0,Math.min(e-this._map.getZoom(),12))),C=f/2,f=[];e=this._map._getMapPanePos();var v=e.x%C,q=e.y%C;e=0;for(k=this._latlngs.length;k>e;e++)if(l=this._map.latLngToContainerPoint(this._latlngs[e]),a.contains(l))b=Math.floor((l.x-v)/C)+2,h=Math.floor((l.y-q)/C)+2,d=(void 0!==this._latlngs[e].alt?this._latlngs[e].alt:void 0!==this._latlngs[e][2]?+this._latlngs[e][2]:1)*x,f[h]=f[h]||[],(c=f[h][b])?(c[0]=(c[0]*c[2]+l.x*d)/(c[2]+d),c[1]=(c[1]*c[2]+l.y*d)/(c[2]+d),c[2]+=d):f[h][b]=[l.x,l.y,d];e=0;for(k=f.length;k>e;e++)if(f[e])for(l=0,a=f[e].length;a>l;l++)(c=f[e][l])&&g.push([Math.round(c[0]),Math.round(c[1]),Math.min(c[2],m)]);this._heat.data(g).draw(this.options.minOpacity);this._frame=null},_animateZoom:function(e){var k=this._map.getZoomScale(e.zoom);e=this._map._getCenterOffset(e.center)._multiplyBy(-k).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,e,k):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(e)+" scale("+k+")"}});L.heatLayer=function(e,k){return new L.HeatLayer(e,k)};(function(e){var k={calculateColor:function(a,b){if(0===a.indexOf("#")){var c=a.slice(1),d=parseInt(c.slice(0,2),16),e=parseInt(c.slice(2,4),16),c=parseInt(c.slice(4),16);return"rgba("+d+","+e+","+c+","+b+")"}return/^rgb\(/.test(a)?a.replace(/rgb/,"rgba").replace(")",",")+b+")":a.split(",").splice(0,3).join(",")+b+")"}},l={forEach:function(a,b,c){if("function"===typeof Array.prototype.forEach)a.forEach(b,c);else for(var d=0,e=a.length;d<e;d++)b.apply(c,[a[d],d,a])},map:function(a,b,c){if("function"===typeof Array.prototype.map)return a.map(b,c);for(var d=[],e=0,f=a.length;e<f;e++)d[e]=b.apply(c,[a[e],e,a]);return d}},c=function(){var a=function(a){this.x=a.x;this.y=a.y;this.rotation=a.rotation;this.style=a.style;this.color=a.color;this.size=a.size;this.borderWidth=a.borderWidth;this.borderColor=a.borderColor};a.prototype.draw=function(a){a.save();a.translate(this.x,this.y);a.rotate(this.rotation);a.lineWidth=this.borderWidth||0;a.strokeStyle=this.borderColor||"#000";a.fillStyle=this.color||"#000";a.beginPath();"circle"===this.style?a.arc(0,0,this.size,0,2*Math.PI,!1):"arrow"===this.style&&(a.moveTo(-this.size,-this.size),a.lineTo(this.size,0),a.lineTo(-this.size,this.size),a.lineTo(-this.size/4,0),a.lineTo(-this.size,-this.size));a.closePath();a.stroke();a.fill();a.restore()};return a}(),b=function(){var a=function(a){var b=a.startX,c=a.startY,d=a.endX,e=a.endY,f=Math.sqrt(Math.pow(b-d,2)+Math.pow(c-e,2)),g=1.5*(c-e)+(b+d)/2,h=1.5*(d-b)+(c+e)/2,f=Math.sqrt(Math.pow(f/2,2)+Math.pow(1.5*f,2)),k=Math.atan2(c-h,b-g),l=Math.atan2(e-h,d-g);this.startX=b;this.startY=c;this.endX=d;this.endY=e;this.centerX=g;this.centerY=h;this.startAngle=k;this.endAngle=l;this.startLabel=a&&a.labels&&a.labels[0];this.endLabel=a&&a.labels&&a.labels[1];this.radius=f;this.lineWidth=a.width||1;this.strokeStyle=a.color||"#000";this.label=a.label;this.font=a.font;this.shadowBlur=a.shadowBlur};a.prototype.draw=function(a){a.save();a.lineWidth=this.lineWidth;a.strokeStyle=this.strokeStyle;a.shadowColor=this.strokeStyle;a.shadowBlur=this.shadowBlur||2;a.beginPath();a.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,!1);a.stroke();a.restore();a.save();a.fillStyle=this.strokeStyle;if(this.label){a.font=this.label;if(this.startLabel){var b=this.startX-15,c=this.startY+5;a.fillText(this.startLabel,b,c)}this.endLabel&&(b=this.endX-15,c=this.endY-5,a.fillText(this.endLabel,b,c))}a.restore()};return a}(),h=function(){function a(a){this.x=a.x;this.y=a.y;this.maxRadius=a.radius;this.color=a.color;this.shadowBlur=5;this.lineWidth=a.borderWidth;this.r=0;this.factor=2/a.radius}a.prototype.draw=function(a){this.r+=.5;a.save();a.translate(this.x,this.y);var b=this.color,b=k.calculateColor(b,1-this.r/this.maxRadius);a.strokeStyle=b;a.shadowBlur=this.shadowBlur;a.shadowColor=b;a.lineWidth=this.lineWidth;a.beginPath();a.arc(0,0,this.r,0,2*Math.PI,!1);a.stroke();a.restore();.8>Math.abs(this.maxRadius-this.r)&&(this.r=0)};return a}(),a=function(){var a=function(a){var b=a.startX,d=a.startY,e=a.endX,f=a.endY,g=Math.sqrt(Math.pow(b-e,2)+Math.pow(d-f,2)),h=1.5*(d-f)+(b+e)/2,k=1.5*(e-b)+(d+f)/2,g=Math.sqrt(Math.pow(g/2,2)+Math.pow(1.5*g,2)),b=Math.atan2(d-k,b-h),e=Math.atan2(f-k,e-h);0>b*e&&(0>b&&(b+=2*Math.PI),e+=2*Math.PI);this.tailPointsCount=50;this.centerX=h;this.centerY=k;this.startAngle=b;this.endAngle=e;this.radius=g;this.lineWidth=a.width||1;this.strokeStyle=a.color||"#fff";this.factor=2/this.radius;this.deltaAngle=80/Math.min(this.radius,400)/this.tailPointsCount;this.arcAngle=this.trailAngle=this.startAngle;this.animateBlur=!0;this.marker=new c({x:50,y:80,rotation:50*Math.PI/180,style:"arrow",color:"rgb(255, 255, 255)",size:3,borderWidth:0,borderColor:this.strokeStyle})};a.prototype.drawArc=function(a,b,c,d,e){a.save();a.lineWidth=c;a.strokeStyle=b;a.shadowColor=this.strokeStyle;a.lineCap="round";a.beginPath();a.arc(this.centerX,this.centerY,this.radius,d,e,!1);a.stroke();a.restore()};a.prototype.draw=function(a){var b=this.endAngle,c=this.trailAngle+this.factor,d=this.strokeStyle;this.animateBlur&&(this.arcAngle=c);this.trailAngle=c;d=k.calculateColor(d,.1);this.drawArc(a,d,this.lineWidth,this.startAngle,this.arcAngle);c=this.tailPointsCount;for(d=0;d<c;d++){var e=k.calculateColor(this.strokeStyle,.3-.3/c*d);this.trailAngle-this.deltaAngle*d>this.startAngle&&this.drawArc(a,e,5-5/c*d,this.trailAngle-this.deltaAngle*d,this.trailAngle)}a.save();a.translate(this.centerX,this.centerY);this.marker.x=Math.cos(this.trailAngle)*this.radius;this.marker.y=Math.sin(this.trailAngle)*this.radius;this.marker.rotation=this.trailAngle+Math.PI/2;this.marker.draw(a);a.restore();.5>180*(b-this.trailAngle)/Math.PI&&(this.trailAngle=this.startAngle,this.animateBlur=!1)};return a}(),d=function(){var d=function(a){this.data=a.data;this.store={arcs:[],markers:[],pulses:[],sparks:[]};this.playAnimation=!0;this.started=!1;this.context=a.context;this.style=a.style;this.init()};d.prototype.init=function(){this.updateData(this.data)};d.prototype.add=function(a){};d.prototype.remove=function(){};d.prototype.clear=function(){this.store={arcs:[],markers:[],pulses:[],sparks:[]};this.playAnimation=!0;this.started=!1;e.cancelAnimationFrame(this.requestAnimationId)};d.prototype.updateData=function(d){d&&0!==d.length&&(this.clear(),(this.data=d)&&0<this.data.length&&l.forEach(this.data,function(d){var e=new b({startX:d.from[0],startY:d.from[1],endX:d.to[0],endY:d.to[1],labels:d.labels,label:this.style.arc.label,font:this.style.arc.font,width:this.style.arc.width,color:d.color}),f=new c({x:d.to[0],y:d.to[1],rotation:e.endAngle+Math.PI/2,style:"arrow",color:d.color,size:4,borderWidth:0,borderColor:d.color}),g=new h({x:d.to[0],y:d.to[1],radius:this.style.pulse.radius,color:d.color,borderWidth:this.style.pulse.borderWidth});d=new a({startX:d.from[0],startY:d.from[1],endX:d.to[0],endY:d.to[1],width:15,color:d.color});this.store.arcs.push(e);this.store.markers.push(f);this.store.pulses.push(g);this.store.sparks.push(d)},this))};d.prototype.start=function(a){var b=this;this.started||(function v(){b.requestAnimationId=e.requestAnimationFrame(v,a);if(b.playAnimation){a.width+=1;--a.width;for(var c in b.store)for(var d=b.store[c],f=0,g=d.length;f<g;f++)d[f].draw(b.context)}}(),this.started=!0)};d.prototype.play=function(){this.playAnimation=!0};d.prototype.pause=function(){this.playAnimation=!1};return d}();L.MigrationLayer=L.Class.extend({options:{map:{},data:{},pulseRadius:25,pulseBorderWidth:3,arcWidth:1,arcLabel:!0,arcLabelFont:"15px sans-serif",Marker:{},Spark:{}},_setOptions:function(a,b){a.hasOwnProperty("options")||(a.options=a.options?L.Util.create(a.options):{});for(var c in b)a.options[c]=b[c];return a.options},initialize:function(a){this._setOptions(this,a);this._map=this.options.map||{};this._data=this.options.data||{};this._style={pulse:{radius:this.options.pulseRadius,borderWidth:this.options.pulseBorderWidth},arc:{width:this.options.arcWidth,label:this.options.arcLabel,font:this.options.arcLabelFont}};this._show=!0;this._init()},_init:function(){var a=L.DomUtil.create("div","leaflet-ODLayer-container");a.style.position="absolute";a.style.width=this._map.getSize().x+"px";a.style.height=this._map.getSize().y+"px";this.container=a;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");a.appendChild(this.canvas);this._map.getPanes().overlayPane.appendChild(a);this.migration||(a=this._convertData(),this.migration=new d({data:a,context:this.context,style:this._style}))},_resize:function(){var a=this._map.getBounds().getNorthWest(),a=this._map.latLngToContainerPoint(a);this.container.style.top=0<a.y?-a.y+"px":"0px";a=e.getComputedStyle(this._map.getContainer());this.canvas.setAttribute("width",parseInt(a.width,10));this.canvas.setAttribute("height",parseInt(a.height,10))},_convertData:function(){var a=this._map.getBounds();if(this._data&&a)return l.map(this._data,function(a){var b=this._map.latLngToContainerPoint(new L.LatLng(a.from[1],a.from[0])),c=this._map.latLngToContainerPoint(new L.LatLng(a.to[1],a.to[0]));return{from:[b.x,b.y],to:[c.x,c.y],labels:a.labels,value:a.value,color:a.color}},this)},_bindMapEvents:function(){var a=this;this._map.on("moveend",function(){a.migration.play();a._draw()});this._map.on("zoomstart ",function(){a.container.style.display="none"});this._map.on("zoomend",function(){a._show&&(a.container.style.display="",a._draw())})},_draw:function(){if(this._map.getBounds()&&this.migration.playAnimation){this._resize();this._transform();var a=this._convertData();this.migration.updateData(a);this.migration.start(this.canvas)}},_transform:function(){var a=this._map.getBounds(),a=this._map.latLngToLayerPoint(a.getNorthWest());L.DomUtil.setPosition(this.container,a)},addTo:function(){this._bindMapEvents();if(this._map.getBounds()&&this.migration.playAnimation){this._resize();this._transform();var a=this._convertData();this.migration.updateData(a);this.migration.start(this.canvas)}},setData:function(a){this._data=a;this._draw()},hide:function(){this.container.style.display="none";this._show=!1},show:function(){this.container.style.display="";this._show=!0},play:function(){this.migration.play()},pause:function(){this.migration.pause()},destroy:function(){this.migration.clear();this.container.parentNode.removeChild(this.container);this._map.clearAllEventListeners();this.mapHandles=[]}});L.migrationLayer=function(a){return new L.MigrationLayer(a)};var g=function(){var a=function(a){this.data=a.data;this.store={pulses:[]};this.playAnimation=!0;this.started=!1;this.context=a.context;this.style=a.style;this.init()};a.prototype.init=function(){this.updateData(this.data)};a.prototype.add=function(a){};a.prototype.remove=function(){};a.prototype.clear=function(){this.store={pulses:[]};this.playAnimation=!0;this.started=!1;e.cancelAnimationFrame(this.requestAnimationId)};a.prototype.updateData=function(a){a&&0!==a.length&&(this.clear(),(this.data=a)&&0<this.data.length&&l.forEach(this.data,function(a){a=new h({x:a.x,y:a.y,radius:this.style.pulse.radius,color:a.color,borderWidth:this.style.pulse.borderWidth});this.store.pulses.push(a)},this))};a.prototype.start=function(a){var b=this;this.started||(function v(){b.requestAnimationId=e.requestAnimationFrame(v,a);if(b.playAnimation){a.width+=1;--a.width;for(var c in b.store)for(var d=b.store[c],f=0,g=d.length;f<g;f++)d[f].draw(b.context)}}(),this.started=!0)};a.prototype.play=function(){this.playAnimation=!0};a.prototype.pause=function(){this.playAnimation=!1};return a}();L.PulseMarkLayer=L.Class.extend({options:{map:{},data:{},pulseRadius:25,pulseBorderWidth:3,Marker:{},Spark:{}},_setOptions:function(a,b){a.hasOwnProperty("options")||(a.options=a.options?L.Util.create(a.options):{});for(var c in b)a.options[c]=b[c];return a.options},initialize:function(a){this._setOptions(this,a);this._map=this.options.map||{};this._data=this.options.data||{};this._style={pulse:{radius:this.options.pulseRadius,borderWidth:this.options.pulseBorderWidth}};this._show=!0;this._init()},_init:function(){var a=L.DomUtil.create("div","leaflet-MMLayer-container");a.style.position="absolute";a.style.width=this._map.getSize().x+"px";a.style.height=this._map.getSize().y+"px";this.container=a;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");a.appendChild(this.canvas);this._map.getPanes().overlayPane.appendChild(a);this.pulsemark||(a=this._convertData(),this.pulsemark=new g({data:a,context:this.context,style:this._style}))},_resize:function(){var a=this._map.getBounds().getNorthWest(),a=this._map.latLngToContainerPoint(a);this.container.style.top=0<a.y?-a.y+"px":"0px";a=e.getComputedStyle(this._map.getContainer());this.canvas.setAttribute("width",parseInt(a.width,10));this.canvas.setAttribute("height",parseInt(a.height,10))},_convertData:function(){var a=this._map.getBounds();if(this._data&&a)return l.map(this._data,function(a){var b=this._map.latLngToContainerPoint(a.latlng),c={};L.extend(c,a);c.x=b.x;c.y=b.y;return c},this)},_bindMapEvents:function(){var a=this;this._map.on("moveend",function(){a.pulsemark.play();a._draw()});this._map.on("zoomstart ",function(){a.container.style.display="none"});this._map.on("zoomend",function(){a._show&&(a.container.style.display="",a._draw())})},_draw:function(){if(this._map.getBounds()&&this.pulsemark.playAnimation){this._resize();this._transform();var a=this._convertData();this.pulsemark.updateData(a);this.pulsemark.start(this.canvas)}},_transform:function(){var a=this._map.getBounds(),a=this._map.latLngToLayerPoint(a.getNorthWest());L.DomUtil.setPosition(this.container,a)},addTo:function(){this._bindMapEvents();if(this._map.getBounds()&&this.pulsemark.playAnimation){this._resize();this._transform();var a=this._convertData();this.pulsemark.updateData(a);this.pulsemark.start(this.canvas)}},setData:function(a){this._data=a;this._draw()},hide:function(){this.container.style.display="none";this._show=!1},show:function(){this.container.style.display="";this._show=!0},play:function(){this.pulsemark.play()},pause:function(){this.pulsemark.pause()},destroy:function(){this.pulsemark.clear();this.container.parentNode.removeChild(this.container);this._map.clearAllEventListeners();this.mapHandles=[]}});L.pulseMarkLayer=function(a){return new L.PulseMarkLayer(a)}})(window);L.Ajax=L.Class.extend({_timeout:6E4,_defs:[],initialize:function(){jQuery.support.cors=!0;this._timeout=6E4;this._defs=[]},getDefs:function(){return this._defs},_removeDef:function(e){for(var k=0;k<this._defs.length;k++)this._defs[k]===e&&this._defs.splice(k,1)},abort:function(){for(var e=0;e<this._defs.length;e++)this._defs[e].abort();this._defs=[]},_isSamePort:function(e){var k=window.location.port;e=e.split("/")[2].split(":");var l="80";""==k&&(k="80");1!=e.length&&(l=e[1]);return l==k?!0:!1},_isCrossDomain:function(e){if(-1==e.indexOf("http"))return!1;if(0==this._isSamePort(e))return!0;var k=document.domain;e=e.split("/")[2].split(":")[0];return k==e?!1:!0},get:function(e,k,l,c,b,h){1==this._isCrossDomain(e)&&(e=PROXY+e+"?");return this._request({url:e,data:k,async:l,dataType:"json",type:"GET",context:c,success:b,error:h})},post:function(e,k,l,c,b,h){1==this._isCrossDomain(e)&&(e=PROXY+e);return this._request({url:e,data:k,async:l,dataType:"json",type:"POST",context:c,success:b,error:h})},request:function(e,k,l,c,b){return this._request({url:e,data:k,dataType:"jsonp",type:"GET",context:l,success:c,error:b})},requestXML:function(e,k,l,c,b){1==this._isCrossDomain(e)&&(e=PROXY+e);return this._request({url:e,data:k,async:async,dataType:"xml",type:"GET",context:l,success:c,error:b})},requestHtml:function(e,k,l,c,b,h){1==this._isCrossDomain(e)&&(e=PROXY+e+"?");return this._request({url:e,data:k,async:l,dataType:"html",type:"GET",context:c,success:b,error:h,timeout:1E4})},_request:function(e){var k;try{var l=this;null==e.error&&(e.error=l.error);k=$.ajax({dataType:e.dataType,type:e.type,contentType:e.contentType||"application/x-www-form-urlencoded; charset\x3dGB2312",async:e.async,url:e.url,cache:!1,context:e.context,data:e.data,timeout:e.timeout||l._timeout});k.then(function(c){l._removeDef(k);"html"==e.dataType&&e.success.call(e.context,c);"string"===typeof c&&(c=$.parseJSON(c));e.success.call(e.context,c)},function(c){l._removeDef(k);e.error.call(e.context,c)});this._defs.push(k)}catch(c){console.log(c.message)}return k},error:function(e){console.log(e.message)},getParamString:function(e){var k="",l;for(l in e)"context"!=l&&"success"!=l&&"error"!=l&&(k+=l+"\x3d"+e[l]+"\x26");""!=k&&(k=k.substring(0,k.length-1));return k}});L.WFSQuery=L.Class.extend({includes:L.Mixin.Events,options:{crs:L.CRS.EPSG3857,showExisting:!0,geometryField:"Shape",url:"",version:"1.1.0",typeNS:"",typeName:"",typeNSName:"",maxFeatures:null,filter:null,style:{color:"black",weight:1},namespaceUri:""},initialize:function(e,k){L.setOptions(this,e);this.readFormat=k||new L.Format.GML({crs:this.options.crs,geometryField:this.options.geometryField});this.options.typeNSName=this.namespaceName(this.options.typeName);this.options.srsName=this.options.crs.code},Query:function(e){e=e||this.options.filter;var k=this;this.describeFeatureType(function(){k.options.showExisting&&k.loadFeatures(e)},function(e){k.fire("error",{error:Error(e)})})},pointQuery:function(e,k,l){},namespaceName:function(e){return this.options.typeNS+":"+e},describeFeatureType:function(e,k){var l=L.XmlUtil.createElementNS("wfs:DescribeFeatureType",{service:"WFS",version:this.options.version});l.appendChild(L.XmlUtil.createElementNS("TypeName",{},{value:this.options.typeNSName}));var c=this;L.Util.request({url:this.options.url,data:L.XmlUtil.serializeXmlDocumentString(l),success:function(b){var h=L.XmlUtil.parseOwsExceptionReport(b);h?"function"===typeof k&&k(h.message):(b=L.XmlUtil.parseXml(b).documentElement,c.readFormat.setFeatureDescription(b),c.options.namespaceUri=b.attributes.targetNamespace.value,"function"===typeof e&&e())},error:function(b){"function"===typeof k&&k(b)}})},getFeature:function(e){var k=L.XmlUtil.createElementNS("wfs:GetFeature",{service:"WFS",version:this.options.version,maxFeatures:this.options.maxFeatures,outputFormat:this.readFormat.outputFormat}),l=k.appendChild(L.XmlUtil.createElementNS("wfs:Query",{typeName:this.options.typeNSName,srsName:this.options.srsName}));e&&e.toGml&&l.appendChild(e.toGml());return k},loadFeatures:function(e){var k=this;L.Util.request({url:this.options.url,data:L.XmlUtil.serializeXmlDocumentString(k.getFeature(e)),success:function(e){var c=L.XmlUtil.parseOwsExceptionReport(e);if(c)return k.fire("error",{error:Error(c.message)}),k;k.fire("load",{layers:k.readFormat.responseToLayers(e)});return k},error:function(e){k.fire("error",{error:Error(e)});return k}})},CLASS_NAME:"L.WFSQuery"});L.drawLocal={draw:{toolbar:{actions:{title:"\u53d6\u6d88\u7ed8\u5236",text:"\u53d6\u6d88"},finish:{title:"\u5b8c\u6210\u7ed8\u5236",text:"\u5b8c\u6210"},undo:{title:"\u5220\u9664\u6700\u540e\u4e00\u4e2a\u5df2\u7ed8\u5236\u7684\u70b9",text:"\u5220\u9664\u6700\u540e\u7ed8\u5236\u70b9"},buttons:{polyline:"\u7ed8\u5236\u591a\u6bb5\u7ebf",polygon:"\u7ed8\u5236\u591a\u8fb9\u5f62",rectangle:"\u7ed8\u5236\u957f\u65b9\u5f62",circle:"\u7ed8\u5236\u5706",marker:"\u7ed8\u5236\u6807\u8bb0"}},handlers:{circle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706"},radius:"\u534a\u5f84"},marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u653e\u7f6e"}},polygon:{tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u9762",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u9762"}},polyline:{error:"\x3cstrong\x3e\u9519\u8bef:\x3c/strong\x3e \u4e0d\u53ef\u81ea\u4ea4\u53c9!",tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u7ebf"}},rectangle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706\u77e9\u5f62"}},simpleshape:{tooltip:{end:"\u653e\u5f00\u9f20\u6807\u5b8c\u6210\u7ed8\u5236"}}}},edit:{toolbar:{actions:{save:{title:"\u4fdd\u5b58\u4fee\u6539",text:"\u4fdd\u5b58"},cancel:{title:"\u53d6\u6d88\u7f16\u8f91\uff0c\u653e\u5f03\u4fee\u6539",text:"\u53d6\u6d88"}},buttons:{edit:"\u7f16\u8f91\u56fe\u5c42",editDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u7f16\u8f91",remove:"\u5220\u9664\u56fe\u5c42",removeDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u5220\u9664"}},handlers:{edit:{tooltip:{text:"\u62d6\u52a8\u63a7\u5236\u70b9\u6216\u6807\u8bb0\u4ee5\u4fee\u6539\u8981\u7d20",subtext:"\u70b9\u51fb\u53d6\u6d88\u653e\u5f03\u4fee\u6539"}},remove:{tooltip:{text:"\u70b9\u51fb\u4e00\u4e2a\u8981\u7d20\u4ee5\u5220\u9664"}}}}};"use strict";L.GeoMap=L.Map.extend({options:{basetileLayer:null,featureLayer:{},legendControl:{},GeoCoder:!1},initialize:function(e,k){for(var l=[],c=0;19>c;c++)l[c]=1.40625/Math.pow(2,c);l=new L.Proj.CRS("EPSG:4326","+proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +no_defs",{origin:[-180,90],resolutions:l});c=k;k=L.setOptions(this,k);L.Map.prototype.initialize.call(this,e,L.extend({},L.Map.prototype.options,k));c&&c.crs||(k.crs=l);if(k.basetileLayer instanceof Array&&0<k.basetileLayer.length)for(c=0;c<k.basetileLayer.length;c++)this.addLayer(k.basetileLayer[c]);else k.basetileLayer instanceof Array&&0==k.basetileLayer.length||(this.addLayer(new L.GeoTDTLayer.Vector),this.addLayer(new L.GeoTDTLayer.VectorAnno));k.center||(k.center=[32,118.7]);k.zoom||(k.zoom=13);this.setView(L.latLng(k.center),k.zoom,{reset:!0})}});L.geomap=function(e,k){return new L.GeoMap(e,k)};